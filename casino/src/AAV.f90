module slaarnaav
use dsp
use slaarnaat
use slaarnabp
use store
use slaarnaai,  only : wfdet_s_bf
use slaarnabg,  only : which_ion_displaced,ion_displacement
use slaarnabi,      only : use_gpcc,cusp_wfdet_real
use slaarnabt, only : multi_ddot_s
use slaarnaca,     only : is_ae
implicit none
private
public gauss_mol_bf_orb_eval
integer xyzzyaaaa1,xyzzyaaab1,xyzzyaaac1
real(dp) xyzzyaaad1(2),xyzzyaaae1(2),xyzzyaaaf1(6,2)
logical xyzzyaaag1
contains
subroutine gauss_mol_bf_orb_eval(rvec,jspin,norb,orbmask,val,orbval,or&
&bgrad,orbsderivs)
implicit none
integer,intent(in) :: jspin,norb
real(dp),intent(in) :: rvec(3)
real(dp),intent(inout) :: orbval(norb,real1_complex2),orbgrad(3,norb,r&
&eal1_complex2),orbsderivs(6,norb,real1_complex2)
logical,intent(in) :: val,orbmask(norb)
xyzzyaaab1=which_ssingle(jspin,spin_dep_in)
xyzzyaaac1=which_ssingle(jspin,spin_dep_full)
if(.not.val)then
call xyzzyaaah1(rvec,jspin,norb,orbmask,orbgrad,orbsderivs)
else
call xyzzyaaai1(rvec,jspin,norb,orbmask,orbval,orbgrad,orbsderivs)
endif
if(complex_wf)then
if(val)orbval(:,2)=0.d0
orbgrad(:,:,2)=0.d0
orbsderivs(:,:,2)=0.d0
endif
end subroutine gauss_mol_bf_orb_eval
subroutine xyzzyaaah1(rvec,jspin,norb,orbmask,orbgrad,orbsderivs)
implicit none
integer,intent(in) :: jspin,norb
real(dp),intent(in) :: rvec(3)
real(dp),intent(inout) :: orbgrad(3,norb,real1_complex2),orbsderivs(6,&
&norb,real1_complex2)
logical,intent(in) :: orbmask(norb)
integer xyzzyaaaa3,xyzzyaaab3,xyzzyaaac3,xyzzyaaad3,xyzzyaaae3,xyzzyaa&
&af3,xyzzyaaag3,xyzzyaaah3,xyzzyaaai3,xyzzyaaaj3,xyzzyaaak3,xyzzyaaal3&
&,xyzzyaaam3,xyzzyaaan3,xyzzyaaao3,xyzzyaaap3,xyzzyaaaq3,xyzzyaaar3,xy&
&zzyaaas3(num_ao),xyzzyaaat3,xyzzyaaau3,xyzzyaaav3
real(dp) xyzzyaaaw3,xyzzyaaax3,xyzzyaaay3,xyzzyaaaz3,xyzzyaaba3,xyzzya&
&abb3,xyzzyaabc3,xyzzyaabd3,xyzzyaabe3,xyzzyaabf3,xyzzyaabg3,xyzzyaabh&
&3,xyzzyaabi3,xyzzyaabj3,xyzzyaabk3,xyzzyaabl3,xyzzyaabm3,xyzzyaabn3,x&
&yzzyaabo3,xyzzyaabp3,xyzzyaabq3,xyzzyaabr3,xyzzyaabs3,xyzzyaabt3,xyzz&
&yaabu3,xyzzyaabv3,xyzzyaabw3,xyzzyaabx3,xyzzyaaby3,xyzzyaabz3,xyzzyaa&
&ca3,xyzzyaacb3,xyzzyaacc3,xyzzyaacd3,xyzzyaace3,xyzzyaacf3,xyzzyaacg3&
&,xyzzyaach3,xyzzyaaci3,xyzzyaacj3,xyzzyaack3,xyzzyaacl3,xyzzyaacm3,xy&
&zzyaacn3,xyzzyaaco3,xyzzyaacp3,xyzzyaacq3,xyzzyaacr3,xyzzyaacs3,xyzzy&
&aact3,xyzzyaacu3,xyzzyaacv3,xyzzyaacw3,xyzzyaacx3,xyzzyaacy3,xyzzyaac&
&z3,xyzzyaada3,xyzzyaadb3,xyzzyaadc3,xyzzyaadd3,xyzzyaade3,xyzzyaadf3,&
&xyzzyaadg3,xyzzyaadh3,xyzzyaadi3,xyzzyaadj3,xyzzyaadk3,xyzzyaadl3,xyz&
&zyaadm3,xyzzyaadn3,xyzzyaado3,xyzzyaadp3,xyzzyaadq3(9),xyzzyaadr3(27)&
&,xyzzyaads3(42),xyzzyaadt3,xyzzyaadu3,xyzzyaadv3,xyzzyaadw3,xyzzyaadx&
&3,xyzzyaady3,xyzzyaadz3,xyzzyaaea3,xyzzyaaeb3,xyzzyaaec3,xyzzyaaed3,x&
&yzzyaaee3,xyzzyaaef3,xyzzyaaeg3,xyzzyaaeh3,xyzzyaaei3
real(dp) xyzzyaaej3,xyzzyaaek3,xyzzyaael3,xyzzyaaem3,xyzzyaaen3,xyzzya&
&aeo3,xyzzyaaep3,xyzzyaaeq3,xyzzyaaer3,xyzzyaaes3,xyzzyaaet3,xyzzyaaeu&
&3,xyzzyaaev3,xyzzyaaew3,xyzzyaaex3,xyzzyaaey3,xyzzyaaez3,xyzzyaafa3,x&
&yzzyaafb3,xyzzyaafc3,xyzzyaafd3,xyzzyaafe3,xyzzyaaff3,xyzzyaafg3,xyzz&
&yaafh3,xyzzyaafi3,xyzzyaafj3,xyzzyaafk3,xyzzyaafl3,xyzzyaafm3,xyzzyaa&
&fn3,xyzzyaafo3,xyzzyaafp3,xyzzyaafq3,xyzzyaafr3,xyzzyaafs3,xyzzyaaft3&
&,xyzzyaafu3,xyzzyaafv3,xyzzyaafw3,xyzzyaafx3,xyzzyaafy3,xyzzyaafz3,xy&
&zzyaaga3,xyzzyaagb3,xyzzyaagc3,xyzzyaagd3,xyzzyaage3,xyzzyaagf3,xyzzy&
&aagg3,xyzzyaagh3,xyzzyaagi3,xyzzyaagj3,xyzzyaagk3,xyzzyaagl3,xyzzyaag&
&m3,xyzzyaagn3,xyzzyaago3,xyzzyaagp3,xyzzyaagq3,xyzzyaagr3,xyzzyaags3,&
&xyzzyaagt3,xyzzyaagu3,xyzzyaagv3,xyzzyaagw3,xyzzyaagx3,xyzzyaagy3,xyz&
&zyaagz3,xyzzyaaha3,xyzzyaahb3,xyzzyaahc3,xyzzyaahd3,xyzzyaahe3,xyzzya&
&ahf3,xyzzyaahg3,xyzzyaahh3,xyzzyaahi3,xyzzyaahj3,xyzzyaahk3,xyzzyaahl&
&3,xyzzyaahm3,xyzzyaahn3,xyzzyaaho3,xyzzyaahp3,xyzzyaahq3,xyzzyaahr3,x&
&yzzyaahs3,xyzzyaaht3,xyzzyaahu3,xyzzyaahv3,xyzzyaahw3,xyzzyaahx3,xyzz&
&yaahy3,xyzzyaahz3,xyzzyaaia3,xyzzyaaib3,xyzzyaaic3,xyzzyaaid3,xyzzyaa&
&ie3,xyzzyaaif3,xyzzyaaig3,xyzzyaaih3,xyzzyaaii3,xyzzyaaij3,xyzzyaaik3&
&,xyzzyaail3,xyzzyaaim3,xyzzyaain3,xyzzyaaio3,xyzzyaaip3,xyzzyaaiq3,xy&
&zzyaair3,xyzzyaais3,xyzzyaait3,xyzzyaaiu3,xyzzyaaiv3,xyzzyaaiw3,xyzzy&
&aaix3,xyzzyaaiy3,xyzzyaaiz3,xyzzyaaja3,xyzzyaajb3,xyzzyaajc3
real(dp) xyzzyaajd3,xyzzyaaje3,xyzzyaajf3,xyzzyaajg3,xyzzyaajh3,xyzzya&
&aji3,xyzzyaajj3,xyzzyaajk3,xyzzyaajl3,xyzzyaajm3,xyzzyaajn3,xyzzyaajo&
&3,xyzzyaajp3,xyzzyaajq3,xyzzyaajr3,xyzzyaajs3,xyzzyaajt3,xyzzyaaju3,x&
&yzzyaajv3,xyzzyaajw3,xyzzyaajx3,xyzzyaajy3,xyzzyaajz3,xyzzyaaka3,xyzz&
&yaakb3,xyzzyaakc3,xyzzyaakd3,xyzzyaake3,xyzzyaakf3,xyzzyaakg3,xyzzyaa&
&kh3,xyzzyaaki3,xyzzyaakj3,xyzzyaakk3,xyzzyaakl3,xyzzyaakm3,xyzzyaakn3&
&,xyzzyaako3,xyzzyaakp3,xyzzyaakq3,xyzzyaakr3,xyzzyaaks3,xyzzyaakt3,xy&
&zzyaaku3,xyzzyaakv3,xyzzyaakw3,xyzzyaakx3,xyzzyaaky3
logical xyzzyaakz3
xyzzyaaaa3=0
agra1_m=0.d0
agra2_m=0.d0
agra3_m=0.d0
asderiv1_m=0.d0
asderiv2_m=0.d0
asderiv3_m=0.d0
asderiv4_m=0.d0
asderiv5_m=0.d0
asderiv6_m=0.d0
xyzzyaaar3=0
do xyzzyaaab3=1,num_centres
if(which_ion_displaced==xyzzyaaab3)then
xyzzyaaax3=xpos_in_cell(xyzzyaaab3,1)+ion_displacement(1)
xyzzyaaay3=ypos_in_cell(xyzzyaaab3,1)+ion_displacement(2)
xyzzyaaaz3=zpos_in_cell(xyzzyaaab3,1)+ion_displacement(3)
else
xyzzyaaax3=xpos_in_cell(xyzzyaaab3,1)
xyzzyaaay3=ypos_in_cell(xyzzyaaab3,1)
xyzzyaaaz3=zpos_in_cell(xyzzyaaab3,1)
endif
xyzzyaaax3=rvec(1)-xyzzyaaax3
xyzzyaaay3=rvec(2)-xyzzyaaay3
xyzzyaaaz3=rvec(3)-xyzzyaaaz3
xyzzyaaba3=xyzzyaaax3*xyzzyaaax3
xyzzyaabb3=xyzzyaaay3*xyzzyaaay3
xyzzyaabc3=xyzzyaaaz3*xyzzyaaaz3
xyzzyaabd3=xyzzyaaax3*xyzzyaaay3
xyzzyaabf3=xyzzyaaax3*xyzzyaaaz3
xyzzyaabe3=xyzzyaaay3*xyzzyaaaz3
xyzzyaaaw3=xyzzyaaba3+xyzzyaabb3+xyzzyaabc3
xyzzyaaac3=num_shells_on_centre(xyzzyaaab3,1)
do xyzzyaaad3=1,xyzzyaaac3
xyzzyaaaa3=xyzzyaaaa3+1
xyzzyaaae3=shell_sequence_number(xyzzyaaaa3)
xyzzyaadl3=min_exponent(xyzzyaaae3)
xyzzyaacu3=xyzzyaadl3*xyzzyaaaw3
if(xyzzyaacu3>screening_tolerance)cycle
xyzzyaaaf3=shell_am(xyzzyaaae3)
xyzzyaaag3=first_ao(xyzzyaaae3)-1
xyzzyaaah3=numao_in_shell(xyzzyaaae3)
xyzzyaaai3=xyzzyaaah3*3
xyzzyaaaj3=xyzzyaaah3*6
xyzzyaaak3=primitive(xyzzyaaae3)
xyzzyaaal3=primitive(xyzzyaaae3+1)-1
xyzzyaakz3=.false.
do xyzzyaaam3=xyzzyaaak3,xyzzyaaal3
xyzzyaadl3=exponent(xyzzyaaam3)
xyzzyaacu3=xyzzyaadl3*xyzzyaaaw3
if(xyzzyaacu3>30.d0)cycle
xyzzyaakz3=.true.
xyzzyaadm3=exp(-xyzzyaacu3)
xyzzyaace3=-xyzzyaadl3-xyzzyaadl3
select case (xyzzyaaaf3)
case(1)
xyzzyaadn3=c_prim(xyzzyaaam3)*xyzzyaadm3*xyzzyaace3
xyzzyaadr3(1)=xyzzyaaax3*xyzzyaadn3
xyzzyaadr3(2)=xyzzyaaay3*xyzzyaadn3
xyzzyaadr3(3)=xyzzyaaaz3*xyzzyaadn3
xyzzyaads3(1)=(1.d0+xyzzyaace3*xyzzyaaba3)*xyzzyaadn3
xyzzyaads3(2)=(1.d0+xyzzyaace3*xyzzyaabb3)*xyzzyaadn3
xyzzyaads3(3)=(1.d0+xyzzyaace3*xyzzyaabc3)*xyzzyaadn3
xyzzyaads3(4)=xyzzyaace3*xyzzyaaay3*xyzzyaadr3(1)
xyzzyaads3(5)=xyzzyaace3*xyzzyaaaz3*xyzzyaadr3(1)
xyzzyaads3(6)=xyzzyaace3*xyzzyaaaz3*xyzzyaadr3(2)
case(2)
xyzzyaadr3(1)=xyzzyaace3*xyzzyaaax3
xyzzyaadr3(2)=xyzzyaace3*xyzzyaaay3
xyzzyaadr3(3)=xyzzyaace3*xyzzyaaaz3
xyzzyaadr3(4)=1.d0+xyzzyaadr3(1)*xyzzyaaax3
xyzzyaadr3(5)=xyzzyaadr3(1)*xyzzyaaay3
xyzzyaadr3(6)=xyzzyaadr3(1)*xyzzyaaaz3
xyzzyaadr3(8)=1.d0+xyzzyaadr3(2)*xyzzyaaay3
xyzzyaadr3(9)=xyzzyaadr3(2)*xyzzyaaaz3
xyzzyaadr3(7)=xyzzyaadr3(5)
xyzzyaadr3(10)=xyzzyaadr3(6)
xyzzyaadr3(11)=xyzzyaadr3(9)
xyzzyaadr3(12)=1.d0+xyzzyaadr3(3)*xyzzyaaaz3
xyzzyaads3(1)=xyzzyaace3*xyzzyaadr3(4)
xyzzyaads3(2)=xyzzyaace3*xyzzyaadr3(8)
xyzzyaads3(3)=xyzzyaace3*xyzzyaadr3(12)
xyzzyaads3(4)=xyzzyaadr3(1)*xyzzyaadr3(2)
xyzzyaads3(5)=xyzzyaadr3(1)*xyzzyaadr3(3)
xyzzyaads3(6)=xyzzyaadr3(2)*xyzzyaadr3(3)
xyzzyaads3(7)=xyzzyaadr3(1)*(xyzzyaadr3(4)+2.d0)
xyzzyaads3(10)=xyzzyaadr3(2)*xyzzyaadr3(4)
xyzzyaads3(13)=xyzzyaads3(10)
xyzzyaads3(11)=xyzzyaadr3(3)*xyzzyaadr3(4)
xyzzyaads3(19)=xyzzyaads3(11)
xyzzyaads3(8)=xyzzyaadr3(1)*xyzzyaadr3(8)
xyzzyaads3(16)=xyzzyaads3(8)
xyzzyaads3(14)=xyzzyaadr3(2)*(xyzzyaadr3(8)+2.d0)
xyzzyaads3(18)=xyzzyaadr3(3)*xyzzyaadr3(8)
xyzzyaads3(20)=xyzzyaads3(18)
xyzzyaads3(9)=xyzzyaadr3(1)*xyzzyaadr3(12)
xyzzyaads3(23)=xyzzyaads3(9)
xyzzyaads3(15)=xyzzyaadr3(2)*xyzzyaadr3(12)
xyzzyaads3(24)=xyzzyaads3(15)
xyzzyaads3(21)=xyzzyaadr3(3)*(xyzzyaadr3(12)+2.d0)
xyzzyaads3(12)=xyzzyaadr3(1)*xyzzyaadr3(9)
xyzzyaads3(17)=xyzzyaads3(12)
xyzzyaads3(22)=xyzzyaads3(12)
xyzzyaadn3=c_prim(xyzzyaaam3)*xyzzyaadm3
xyzzyaado3=c_prim2(xyzzyaaam3)*xyzzyaadm3
xyzzyaadr3(1:3)=xyzzyaadr3(1:3)*xyzzyaadn3
xyzzyaadr3(4:12)=xyzzyaadr3(4:12)*xyzzyaado3
xyzzyaads3(1:6)=xyzzyaads3(1:6)*xyzzyaadn3
xyzzyaads3(7:24)=xyzzyaads3(7:24)*xyzzyaado3
case(3)
xyzzyaacf3=xyzzyaace3*xyzzyaaax3
xyzzyaacg3=xyzzyaace3*xyzzyaaay3
xyzzyaach3=xyzzyaace3*xyzzyaaaz3
xyzzyaadr3(1)=1.d0+xyzzyaacf3*xyzzyaaax3
xyzzyaadr3(2)=xyzzyaacf3*xyzzyaaay3
xyzzyaadr3(3)=xyzzyaacf3*xyzzyaaaz3
xyzzyaadr3(5)=1.d0+xyzzyaacg3*xyzzyaaay3
xyzzyaadr3(6)=xyzzyaacg3*xyzzyaaaz3
xyzzyaadr3(9)=1.d0+xyzzyaach3*xyzzyaaaz3
xyzzyaadr3(4)=xyzzyaadr3(2)
xyzzyaadr3(7)=xyzzyaadr3(3)
xyzzyaadr3(8)=xyzzyaadr3(6)
xyzzyaads3(1)=xyzzyaacf3*(xyzzyaadr3(1)+2.d0)
xyzzyaads3(4)=xyzzyaacg3*xyzzyaadr3(1)
xyzzyaads3(7)=xyzzyaads3(4)
xyzzyaads3(5)=xyzzyaach3*xyzzyaadr3(1)
xyzzyaads3(13)=xyzzyaads3(5)
xyzzyaads3(2)=xyzzyaacf3*xyzzyaadr3(5)
xyzzyaads3(10)=xyzzyaads3(2)
xyzzyaads3(8)=xyzzyaacg3*(xyzzyaadr3(5)+2.d0)
xyzzyaads3(12)=xyzzyaach3*xyzzyaadr3(5)
xyzzyaads3(14)=xyzzyaads3(12)
xyzzyaads3(3)=xyzzyaacf3*xyzzyaadr3(9)
xyzzyaads3(17)=xyzzyaads3(3)
xyzzyaads3(9)=xyzzyaacg3*xyzzyaadr3(9)
xyzzyaads3(18)=xyzzyaads3(9)
xyzzyaads3(15)=xyzzyaach3*(xyzzyaadr3(9)+2.d0)
xyzzyaads3(6)=xyzzyaacf3*xyzzyaadr3(6)
xyzzyaads3(11)=xyzzyaads3(6)
xyzzyaads3(16)=xyzzyaads3(6)
xyzzyaado3=c_prim(xyzzyaaam3)*xyzzyaadm3
xyzzyaadr3(1:9)=xyzzyaadr3(1:9)*xyzzyaado3
xyzzyaads3(1:18)=xyzzyaads3(1:18)*xyzzyaado3
case(4)
xyzzyaaca3=xyzzyaaba3-xyzzyaabb3
xyzzyaabg3=3.d0*xyzzyaabc3-xyzzyaaaw3
xyzzyaacf3=xyzzyaace3*xyzzyaaax3
xyzzyaaci3=xyzzyaacf3*xyzzyaaaz3
xyzzyaacg3=xyzzyaace3*xyzzyaaay3
xyzzyaacj3=xyzzyaacg3*xyzzyaaaz3
xyzzyaach3=xyzzyaace3*xyzzyaaaz3
xyzzyaack3=xyzzyaacf3*xyzzyaaay3
xyzzyaacu3=1.d0+xyzzyaacf3*xyzzyaaax3
xyzzyaadb3=xyzzyaacu3+2.d0
xyzzyaacv3=1.d0+xyzzyaacg3*xyzzyaaay3
xyzzyaadc3=xyzzyaacv3+2.d0
xyzzyaacw3=1.d0+xyzzyaach3*xyzzyaaaz3
xyzzyaadd3=xyzzyaacw3+2.d0
xyzzyaacx3=xyzzyaace3*xyzzyaabg3-2.d0
xyzzyaacy3=xyzzyaace3*xyzzyaaca3
xyzzyaadr3(1)=xyzzyaacx3*xyzzyaaax3
xyzzyaadr3(2)=xyzzyaacx3*xyzzyaaay3
xyzzyaadr3(3)=(xyzzyaacx3+6.d0)*xyzzyaaaz3
xyzzyaadr3(4)=xyzzyaacu3*xyzzyaaaz3
xyzzyaadr3(5)=xyzzyaacf3*xyzzyaabe3
xyzzyaadr3(6)=xyzzyaacw3*xyzzyaaax3
xyzzyaadr3(7)=xyzzyaadr3(5)
xyzzyaadr3(8)=xyzzyaacv3*xyzzyaaaz3
xyzzyaadr3(9)=xyzzyaacw3*xyzzyaaay3
xyzzyaadr3(10)=(2.d0+xyzzyaace3*xyzzyaaca3)*xyzzyaaax3
xyzzyaadr3(11)=(xyzzyaacy3-2.d0)*xyzzyaaay3
xyzzyaadr3(12)=xyzzyaacy3*xyzzyaaaz3
xyzzyaadr3(13)=xyzzyaacu3*xyzzyaaay3
xyzzyaadr3(14)=xyzzyaacv3*xyzzyaaax3
xyzzyaadr3(15)=xyzzyaadr3(5)
xyzzyaadp3=c_prim(xyzzyaaam3)*xyzzyaadm3
xyzzyaadr3(1:15)=xyzzyaadr3(1:15)*xyzzyaadp3
xyzzyaacz3=7.d0+xyzzyaace3*xyzzyaaaw3
xyzzyaacz3=xyzzyaace3*xyzzyaacz3*xyzzyaadp3
xyzzyaada3=xyzzyaaba3+xyzzyaabb3-2.d0*xyzzyaabc3
xyzzyaads3(1)=-xyzzyaacf3*xyzzyaacf3*xyzzyaada3-xyzzyaace3*(xyzzyaada3&
&+4.d0*xyzzyaaba3)-2.d0
xyzzyaads3(2)=-xyzzyaacg3*xyzzyaacg3*xyzzyaada3-xyzzyaace3*(xyzzyaada3&
&+4.d0*xyzzyaabb3)-2.d0
xyzzyaads3(3)=-xyzzyaach3*xyzzyaach3*xyzzyaada3-xyzzyaace3*(xyzzyaada3&
&-8.d0*xyzzyaabc3)+4.d0
xyzzyaade3=2.d0*(1.d0+xyzzyaadl3*xyzzyaada3)
xyzzyaads3(4)=xyzzyaack3*(xyzzyaade3-6.d0)
xyzzyaads3(5)=xyzzyaaci3*xyzzyaade3
xyzzyaads3(6)=xyzzyaacj3*xyzzyaade3
xyzzyaads3(7)=xyzzyaaci3*xyzzyaadb3
xyzzyaads3(8)=xyzzyaaci3*xyzzyaacv3
xyzzyaads3(9)=xyzzyaaci3*xyzzyaadd3
xyzzyaads3(10)=xyzzyaacj3*xyzzyaacu3
xyzzyaads3(11)=(-xyzzyaacu3)*(-xyzzyaacw3)
xyzzyaads3(12)=xyzzyaack3*xyzzyaacw3
xyzzyaads3(13)=xyzzyaads3(10)
xyzzyaads3(14)=xyzzyaacj3*xyzzyaadc3
xyzzyaads3(15)=xyzzyaacj3*xyzzyaadd3
xyzzyaads3(16)=xyzzyaads3(8)
xyzzyaads3(17)=xyzzyaack3*xyzzyaacw3
xyzzyaads3(18)=(-xyzzyaacv3)*(-xyzzyaacw3)
xyzzyaads3(19)=2.d0+xyzzyaace3*(xyzzyaacu3*xyzzyaaca3+4.d0*xyzzyaaba3)
xyzzyaads3(20)=xyzzyaace3*(xyzzyaacv3*xyzzyaaca3-4.d0*xyzzyaabb3)-2.d0
xyzzyaads3(21)=xyzzyaace3*xyzzyaaca3*xyzzyaacw3
xyzzyaads3(22)=xyzzyaace3*xyzzyaace3*xyzzyaabd3*xyzzyaaca3
xyzzyaads3(23)=-2.d0*xyzzyaaci3*(xyzzyaadl3*xyzzyaaca3-1.d0)
xyzzyaads3(24)=-2.d0*xyzzyaacj3*(xyzzyaadl3*xyzzyaaca3+1.d0)
xyzzyaads3(25)=xyzzyaack3*xyzzyaadb3
xyzzyaads3(26)=xyzzyaack3*xyzzyaadc3
xyzzyaads3(27)=xyzzyaads3(12)
xyzzyaads3(28)=(-xyzzyaacu3)*(-xyzzyaacv3)
xyzzyaads3(29)=xyzzyaads3(10)
xyzzyaads3(30)=xyzzyaads3(8)
xyzzyaads3(1:30)=xyzzyaads3(1:30)*xyzzyaadp3
case(5)
xyzzyaadp3=c_prim(xyzzyaaam3)*xyzzyaadm3
xyzzyaabk3=xyzzyaaba3*xyzzyaaax3
xyzzyaabl3=xyzzyaabb3*xyzzyaaay3
xyzzyaabh3=xyzzyaaba3*xyzzyaaba3
xyzzyaabi3=xyzzyaabb3*xyzzyaabb3
xyzzyaabj3=xyzzyaabc3*xyzzyaabc3
xyzzyaabw3=xyzzyaabd3*xyzzyaaaz3
xyzzyaakf3=xyzzyaaba3*xyzzyaabb3
xyzzyaakg3=xyzzyaaba3*xyzzyaabc3
xyzzyaakh3=xyzzyaabb3*xyzzyaabc3
xyzzyaacm3=xyzzyaadl3*xyzzyaaba3
xyzzyaacn3=xyzzyaadl3*xyzzyaabb3
xyzzyaaco3=xyzzyaadl3*xyzzyaabc3
xyzzyaaki3=xyzzyaadl3*xyzzyaadl3
xyzzyaakj3=xyzzyaadl3*xyzzyaadp3
xyzzyaakk3=xyzzyaaax3*xyzzyaadp3
xyzzyaakl3=xyzzyaaay3*xyzzyaadp3
xyzzyaakm3=xyzzyaaaz3*xyzzyaadp3
xyzzyaakn3=3.d0*xyzzyaaba3
xyzzyaako3=3.d0*xyzzyaabb3
xyzzyaakp3=-2.d0*xyzzyaabc3
xyzzyaacu3=xyzzyaakn3+xyzzyaako3+xyzzyaakp3
xyzzyaacv3=xyzzyaadl3*xyzzyaacu3
xyzzyaacw3=-3.d0+xyzzyaacv3
xyzzyaacx3=3.d0*xyzzyaaco3
xyzzyaacy3=-1.5d0+xyzzyaacx3
xyzzyaacz3=-12.d0*xyzzyaabc3
xyzzyaada3=xyzzyaacz3+xyzzyaakn3+xyzzyaako3
xyzzyaadb3=xyzzyaadl3*xyzzyaada3
xyzzyaadc3=-3.d0+xyzzyaadb3
xyzzyaaej3=xyzzyaabd3*xyzzyaadc3*xyzzyaadp3
xyzzyaaek3=3.d0*xyzzyaacn3
xyzzyaakq3=6.d0*xyzzyaabc3
xyzzyaael3=-12.d0*xyzzyaaco3
xyzzyaaem3=12.d0+xyzzyaadb3
xyzzyaaen3=-30.d0*xyzzyaacm3
xyzzyaaeo3=30.d0*xyzzyaacn3
xyzzyaaep3=90.d0*xyzzyaacn3
xyzzyaaeq3=-45.d0*xyzzyaabb3
xyzzyaakr3=-6.d0*xyzzyaaba3
xyzzyaaks3=-6.d0*xyzzyaabb3
xyzzyaaer3=xyzzyaakr3+xyzzyaaks3+4.d0*xyzzyaabc3
xyzzyaaes3=-6.d0*xyzzyaaco3
xyzzyaaet3=3.d0+xyzzyaaes3
xyzzyaakt3=4.d0*xyzzyaabj3
xyzzyaaku3=15.d0*xyzzyaaba3
xyzzyaaeu3=xyzzyaaku3+xyzzyaako3+xyzzyaakp3
xyzzyaaev3=xyzzyaadl3*xyzzyaaeu3
xyzzyaaew3=xyzzyaaki3*xyzzyaaer3*xyzzyaaba3
xyzzyaaex3=-3.d0+xyzzyaaev3+xyzzyaaew3
xyzzyaaey3=xyzzyaaex3*xyzzyaakm3
xyzzyaakv3=15.d0*xyzzyaabb3
xyzzyaaez3=xyzzyaakv3+xyzzyaakn3+xyzzyaakp3
xyzzyaafa3=xyzzyaadl3*xyzzyaaez3
xyzzyaafb3=xyzzyaaki3*xyzzyaaer3*xyzzyaabb3
xyzzyaafc3=-3.d0+xyzzyaafa3+xyzzyaafb3
xyzzyaafd3=xyzzyaafc3*xyzzyaakm3
xyzzyaakw3=9.d0*xyzzyaaba3
xyzzyaajd3=9.d0*xyzzyaabb3
xyzzyaaje3=-14.d0*xyzzyaabc3
xyzzyaafe3=xyzzyaakw3+xyzzyaajd3+xyzzyaaje3
xyzzyaaff3=xyzzyaadl3*xyzzyaafe3
xyzzyaafg3=xyzzyaaki3*xyzzyaaer3*xyzzyaabc3
xyzzyaafh3=6.d0+xyzzyaaff3+xyzzyaafg3
xyzzyaafi3=xyzzyaafh3*xyzzyaakm3
xyzzyaajf3=24.d0*xyzzyaabc3
xyzzyaafj3=xyzzyaakr3+xyzzyaaks3+xyzzyaajf3
xyzzyaafk3=xyzzyaaki3*xyzzyaafj3*xyzzyaaba3
xyzzyaajg3=21.d0*xyzzyaaba3
xyzzyaajh3=-36.d0*xyzzyaabc3
xyzzyaafl3=xyzzyaajd3+xyzzyaajg3+xyzzyaajh3
xyzzyaafm3=xyzzyaadl3*xyzzyaafl3
xyzzyaafn3=-9.d0+xyzzyaafm3+xyzzyaafk3
xyzzyaafo3=xyzzyaafn3*xyzzyaakk3
xyzzyaafp3=xyzzyaacz3+xyzzyaakv3+xyzzyaakn3
xyzzyaafq3=xyzzyaadl3*xyzzyaafp3
xyzzyaafr3=xyzzyaaki3*xyzzyaafj3*xyzzyaabb3
xyzzyaafs3=-3.d0+xyzzyaafq3+xyzzyaafr3
xyzzyaaft3=xyzzyaafs3*xyzzyaakk3
xyzzyaaji3=-60.d0*xyzzyaabc3
xyzzyaafu3=xyzzyaaji3+xyzzyaakn3+xyzzyaako3
xyzzyaafv3=xyzzyaadl3*xyzzyaafu3
xyzzyaafw3=xyzzyaaki3*xyzzyaafj3*xyzzyaabc3
xyzzyaafx3=12.d0+xyzzyaafv3+xyzzyaafw3
xyzzyaafy3=xyzzyaafx3*xyzzyaakk3
xyzzyaafz3=xyzzyaacz3+xyzzyaaku3+xyzzyaako3
xyzzyaaga3=xyzzyaadl3*xyzzyaafz3
xyzzyaagb3=-3.d0+xyzzyaafk3+xyzzyaaga3
xyzzyaagc3=xyzzyaagb3*xyzzyaakl3
xyzzyaagd3=xyzzyaadl3*xyzzyaafj3
xyzzyaage3=-18.d0+xyzzyaagd3
xyzzyaagf3=xyzzyaabw3*xyzzyaage3*xyzzyaakj3
xyzzyaajj3=21.d0*xyzzyaabb3
xyzzyaagg3=xyzzyaakw3+xyzzyaajh3+xyzzyaajj3
xyzzyaagh3=xyzzyaadl3*xyzzyaagg3
xyzzyaagi3=-9.d0+xyzzyaafr3+xyzzyaagh3
xyzzyaagj3=xyzzyaagi3*xyzzyaakl3
xyzzyaagk3=xyzzyaafx3*xyzzyaakl3
xyzzyaajk3=30.d0*xyzzyaabb3
xyzzyaajl3=-30.d0*xyzzyaaba3
xyzzyaagl3=-60.d0*xyzzyaaco3
xyzzyaakx3=60.d0*xyzzyaaba3
xyzzyaaky3=-60.d0*xyzzyaabb3
xyzzyaagm3=xyzzyaakx3+xyzzyaaky3
xyzzyaagn3=xyzzyaaki3*xyzzyaagm3*xyzzyaabc3
xyzzyaajm3=-150.d0*xyzzyaaba3
xyzzyaago3=xyzzyaajk3+xyzzyaajm3
xyzzyaagp3=xyzzyaadl3*xyzzyaago3
xyzzyaajn3=60.d0*xyzzyaabh3
xyzzyaagq3=-60.d0*xyzzyaakf3
xyzzyaagr3=xyzzyaajn3+xyzzyaagq3
xyzzyaags3=xyzzyaaki3*xyzzyaagr3
xyzzyaagt3=30.d0+xyzzyaagp3+xyzzyaags3
xyzzyaagu3=xyzzyaagt3*xyzzyaakm3
xyzzyaajo3=150.d0*xyzzyaabb3
xyzzyaagv3=xyzzyaajl3+xyzzyaajo3
xyzzyaagw3=xyzzyaadl3*xyzzyaagv3
xyzzyaagx3=60.d0*xyzzyaakf3
xyzzyaajp3=-60.d0*xyzzyaabi3
xyzzyaagy3=xyzzyaagx3+xyzzyaajp3
xyzzyaagz3=xyzzyaaki3*xyzzyaagy3
xyzzyaaha3=-30.d0+xyzzyaagw3+xyzzyaagz3
xyzzyaahb3=xyzzyaaha3*xyzzyaakm3
xyzzyaahc3=90.d0+xyzzyaagl3
xyzzyaahd3=xyzzyaahc3*xyzzyaabb3
xyzzyaahe3=-90.d0-xyzzyaagl3
xyzzyaahf3=xyzzyaahe3*xyzzyaaba3
xyzzyaahg3=xyzzyaahd3+xyzzyaahf3
xyzzyaahh3=xyzzyaaaz3*xyzzyaahg3*xyzzyaakj3
xyzzyaajq3=-60.d0*xyzzyaacm3
xyzzyaajr3=-60.d0*xyzzyaacn3
xyzzyaajs3=120.d0*xyzzyaacm3
xyzzyaahi3=-180.d0+xyzzyaajs3
xyzzyaahj3=xyzzyaabw3*xyzzyaahi3*xyzzyaakj3
xyzzyaajt3=120.d0*xyzzyaacn3
xyzzyaahk3=-180.d0+xyzzyaajt3
xyzzyaahl3=xyzzyaabw3*xyzzyaahk3*xyzzyaakj3
xyzzyaaju3=120.d0*xyzzyaaco3
xyzzyaahm3=-180.d0+xyzzyaaju3
xyzzyaahn3=xyzzyaabw3*xyzzyaahm3*xyzzyaakj3
xyzzyaajv3=90.d0*xyzzyaabb3
xyzzyaaho3=-180.d0*xyzzyaakf3
xyzzyaahp3=xyzzyaajn3+xyzzyaaho3
xyzzyaahq3=xyzzyaaki3*xyzzyaahp3
xyzzyaahr3=-180.d0*xyzzyaacn3
xyzzyaajw3=-210.d0*xyzzyaaba3
xyzzyaajx3=270.d0*xyzzyaabb3
xyzzyaahs3=xyzzyaajw3+xyzzyaajx3
xyzzyaaht3=xyzzyaadl3*xyzzyaahs3
xyzzyaahu3=90.d0+xyzzyaaht3+xyzzyaahq3
xyzzyaahv3=xyzzyaahu3*xyzzyaakk3
xyzzyaajy3=450.d0*xyzzyaabb3
xyzzyaahw3=xyzzyaajl3+xyzzyaajy3
xyzzyaahx3=xyzzyaadl3*xyzzyaahw3
xyzzyaajz3=-180.d0*xyzzyaabi3
xyzzyaahy3=xyzzyaagx3+xyzzyaajz3
xyzzyaahz3=xyzzyaaki3*xyzzyaahy3
xyzzyaaia3=-90.d0+xyzzyaahx3+xyzzyaahz3
xyzzyaaib3=xyzzyaaia3*xyzzyaakk3
xyzzyaaic3=-180.d0*xyzzyaaco3
xyzzyaaid3=90.d0+xyzzyaaic3
xyzzyaaie3=xyzzyaaid3*xyzzyaabb3
xyzzyaaif3=-30.d0-xyzzyaagl3
xyzzyaaig3=xyzzyaaif3*xyzzyaaba3
xyzzyaaih3=xyzzyaaie3+xyzzyaaig3
xyzzyaaii3=xyzzyaaax3*xyzzyaaih3*xyzzyaakj3
xyzzyaaij3=30.d0+xyzzyaagl3
xyzzyaaka3=-90.d0*xyzzyaaba3
xyzzyaaik3=180.d0*xyzzyaakf3
xyzzyaail3=xyzzyaajp3+xyzzyaaik3
xyzzyaaim3=xyzzyaaki3*xyzzyaail3
xyzzyaakb3=-450.d0*xyzzyaaba3
xyzzyaain3=xyzzyaajk3+xyzzyaakb3
xyzzyaaio3=xyzzyaadl3*xyzzyaain3
xyzzyaakc3=180.d0*xyzzyaabh3
xyzzyaaip3=xyzzyaagq3+xyzzyaakc3
xyzzyaaiq3=xyzzyaaki3*xyzzyaaip3
xyzzyaair3=90.d0+xyzzyaaio3+xyzzyaaiq3
xyzzyaais3=xyzzyaair3*xyzzyaakl3
xyzzyaakd3=-270.d0*xyzzyaaba3
xyzzyaake3=210.d0*xyzzyaabb3
xyzzyaait3=xyzzyaakd3+xyzzyaake3
xyzzyaaiu3=xyzzyaadl3*xyzzyaait3
xyzzyaaiv3=-9.d1+xyzzyaaiu3+xyzzyaaim3
xyzzyaaiw3=xyzzyaaiv3*xyzzyaakl3
xyzzyaaix3=xyzzyaaij3*xyzzyaabb3
xyzzyaaiy3=180.d0*xyzzyaaco3
xyzzyaaiz3=-90.d0+xyzzyaaiy3
xyzzyaaja3=xyzzyaaiz3*xyzzyaaba3
xyzzyaajb3=xyzzyaaix3+xyzzyaaja3
xyzzyaajc3=xyzzyaaay3*xyzzyaajb3*xyzzyaakj3
xyzzyaadr3(1)=xyzzyaabf3*xyzzyaadp3*xyzzyaacw3
xyzzyaadr3(2)=xyzzyaabe3*xyzzyaadp3*xyzzyaacw3
xyzzyaadr3(3)=xyzzyaadp3*(3.d0*xyzzyaabc3-2.d0*xyzzyaadl3*xyzzyaabj3+x&
&yzzyaacy3*(xyzzyaaba3+xyzzyaabb3))
xyzzyaadr3(4)=xyzzyaadp3*((-4.5d0+xyzzyaaek3+xyzzyaael3)*xyzzyaaba3-1.&
&5d0*xyzzyaabb3+3.d0*xyzzyaadl3*xyzzyaabh3+xyzzyaakq3)
xyzzyaadr3(5)=xyzzyaaej3
xyzzyaadr3(6)=xyzzyaabf3*xyzzyaaem3*xyzzyaadp3
xyzzyaadr3(7)=xyzzyaaej3
xyzzyaadr3(8)=xyzzyaadp3*(3.d0*xyzzyaadl3*xyzzyaabi3+(-1.5d0+xyzzyaaek&
&3)*xyzzyaaba3+(-4.5d0+xyzzyaael3)*xyzzyaabb3+xyzzyaakq3)
xyzzyaadr3(9)=xyzzyaabe3*xyzzyaaem3*xyzzyaadp3
xyzzyaadr3(10)=xyzzyaabf3*(30.d0+xyzzyaaen3+xyzzyaaeo3)*xyzzyaadp3
xyzzyaadr3(11)=xyzzyaabe3*(-30.d0+xyzzyaaen3+xyzzyaaeo3)*xyzzyaadp3
xyzzyaadr3(12)=(xyzzyaaba3*(15.d0-30.d0*xyzzyaaco3)+xyzzyaabb3*(-15.d0&
&+30.d0*xyzzyaaco3))*xyzzyaadp3
xyzzyaadr3(13)=xyzzyaabe3*(30.d0+xyzzyaajq3)*xyzzyaadp3
xyzzyaadr3(14)=xyzzyaabf3*(30.d0+xyzzyaajr3)*xyzzyaadp3
xyzzyaadr3(15)=xyzzyaabd3*xyzzyaaij3*xyzzyaadp3
xyzzyaadr3(16)=xyzzyaadp3*(xyzzyaaeq3+(45.d0+xyzzyaaep3)*xyzzyaaba3-30&
&.d0*xyzzyaadl3*xyzzyaabh3)
xyzzyaadr3(17)=xyzzyaabd3*(-90.d0+xyzzyaaen3+xyzzyaaep3)*xyzzyaadp3
xyzzyaadr3(18)=xyzzyaadl3*xyzzyaabf3*(xyzzyaajl3+xyzzyaajv3)*xyzzyaadp&
&3
xyzzyaadr3(19)=xyzzyaabd3*(90.d0+xyzzyaaeo3-90.d0*xyzzyaacm3)*xyzzyaad&
&p3
xyzzyaadr3(20)=(30.d0*xyzzyaadl3*xyzzyaabi3+xyzzyaaeq3+xyzzyaaba3*(45.&
&d0-90.d0*xyzzyaacn3))*xyzzyaadp3
xyzzyaadr3(21)=xyzzyaabe3*(xyzzyaaka3+xyzzyaajk3)*xyzzyaakj3
xyzzyaads3(1)=xyzzyaaey3
xyzzyaads3(2)=xyzzyaafd3
xyzzyaads3(3)=xyzzyaafi3
xyzzyaads3(4)=(12.d0+xyzzyaadl3*xyzzyaaer3)*xyzzyaabw3*xyzzyaakj3
xyzzyaads3(5)=xyzzyaadp3*(xyzzyaadl3*xyzzyaaet3*xyzzyaabk3+xyzzyaaax3*&
&(-3.d0+xyzzyaaki3*(xyzzyaakt3-6.d0*xyzzyaakh3)+xyzzyaadl3*xyzzyaako3)&
&)
xyzzyaads3(6)=xyzzyaadp3*(xyzzyaadl3*xyzzyaaet3*xyzzyaabl3+xyzzyaaay3*&
&(-3.d0+xyzzyaaki3*(xyzzyaakt3-6.d0*xyzzyaakg3)+xyzzyaadl3*xyzzyaakn3)&
&)
xyzzyaads3(7)=xyzzyaafo3
xyzzyaads3(8)=xyzzyaaft3
xyzzyaads3(9)=xyzzyaafy3
xyzzyaads3(10)=xyzzyaagc3
xyzzyaads3(11)=xyzzyaakm3*(12.d0+xyzzyaafk3+xyzzyaadl3*(xyzzyaacz3-15.&
&d0*xyzzyaaba3+xyzzyaako3))
xyzzyaads3(12)=xyzzyaagf3
xyzzyaads3(13)=xyzzyaagc3
xyzzyaads3(14)=xyzzyaagj3
xyzzyaads3(15)=xyzzyaagk3
xyzzyaads3(16)=xyzzyaaft3
xyzzyaads3(17)=xyzzyaagf3
xyzzyaads3(18)=xyzzyaakm3*(12.d0+xyzzyaafr3+xyzzyaadl3*(xyzzyaacz3-15.&
&d0*xyzzyaabb3+xyzzyaakn3))
xyzzyaads3(19)=xyzzyaagu3
xyzzyaads3(20)=xyzzyaahb3
xyzzyaads3(21)=xyzzyaahh3
xyzzyaads3(22)=60.d0*xyzzyaabw3*xyzzyaaki3*(xyzzyaaba3-xyzzyaabb3)*xyz&
&zyaadp3
xyzzyaads3(23)=(30.d0+xyzzyaadl3*(xyzzyaajl3+xyzzyaajk3+xyzzyaaji3)+xy&
&zzyaagn3)*xyzzyaakk3
xyzzyaads3(24)=(-30.d0+xyzzyaagn3+xyzzyaadl3*(xyzzyaajl3+xyzzyaajk3+60&
&.d0*xyzzyaabc3))*xyzzyaakl3
xyzzyaads3(25)=xyzzyaahj3
xyzzyaads3(26)=xyzzyaahl3
xyzzyaads3(27)=xyzzyaahn3
xyzzyaads3(28)=(30.d0+xyzzyaajq3+xyzzyaajr3+120.d0*xyzzyaaki3*xyzzyaak&
&f3)*xyzzyaakm3
xyzzyaads3(29)=(30.d0+xyzzyaajq3+xyzzyaagl3+120.d0*xyzzyaaki3*xyzzyaak&
&g3)*xyzzyaakl3
xyzzyaads3(30)=(30.d0+xyzzyaajr3+xyzzyaagl3+120.d0*xyzzyaaki3*xyzzyaak&
&h3)*xyzzyaakk3
xyzzyaads3(31)=xyzzyaahv3
xyzzyaads3(32)=xyzzyaaib3
xyzzyaads3(33)=xyzzyaaii3
xyzzyaads3(34)=(-90.d0+xyzzyaahq3+xyzzyaadl3*(xyzzyaajv3+90.d0*xyzzyaa&
&ba3))*xyzzyaakl3
xyzzyaads3(35)=(xyzzyaajv3+(-90.d0+xyzzyaahr3)*xyzzyaaba3+60.d0*xyzzya&
&adl3*xyzzyaabh3)*xyzzyaaaz3*xyzzyaakj3
xyzzyaads3(36)=(180.d0+xyzzyaahr3+60.d0*xyzzyaacm3)*xyzzyaabw3*xyzzyaa&
&kj3
xyzzyaads3(37)=xyzzyaais3
xyzzyaads3(38)=xyzzyaaiw3
xyzzyaads3(39)=xyzzyaajc3
xyzzyaads3(40)=(90.d0+xyzzyaaim3+xyzzyaadl3*(xyzzyaaka3-90.d0*xyzzyaab&
&b3))*xyzzyaakk3
xyzzyaads3(41)=(xyzzyaajr3+180.d0*(xyzzyaacm3-1.d0))*xyzzyaabw3*xyzzya&
&akj3
xyzzyaads3(42)=(-60.d0*xyzzyaadl3*xyzzyaabi3+xyzzyaajv3+xyzzyaaba3*(-9&
&0.d0+180.d0*xyzzyaacn3))*xyzzyaaaz3*xyzzyaakj3
case(6)
xyzzyaabw3=xyzzyaabd3*xyzzyaaaz3
xyzzyaabh3=xyzzyaaba3*xyzzyaaba3
xyzzyaabi3=xyzzyaabb3*xyzzyaabb3
xyzzyaabj3=xyzzyaabc3*xyzzyaabc3
xyzzyaabm3=xyzzyaaba3*xyzzyaabb3
xyzzyaabn3=xyzzyaaba3*xyzzyaabc3
xyzzyaabo3=xyzzyaabb3*xyzzyaabc3
xyzzyaabp3=xyzzyaaba3*xyzzyaabf3
xyzzyaabq3=xyzzyaabd3*xyzzyaabe3
xyzzyaabr3=xyzzyaabf3*xyzzyaabc3
xyzzyaabs3=xyzzyaabd3*xyzzyaabf3
xyzzyaabx3=xyzzyaabb3*xyzzyaabe3
xyzzyaabt3=xyzzyaabe3*xyzzyaabc3
xyzzyaabu3=xyzzyaaba3*xyzzyaabd3
xyzzyaaby3=xyzzyaabd3*xyzzyaabb3
xyzzyaabv3=xyzzyaabd3*xyzzyaabc3
xyzzyaacl3=xyzzyaabh3+xyzzyaabi3
xyzzyaaca3=xyzzyaaba3-xyzzyaabb3
xyzzyaabz3=xyzzyaaba3+xyzzyaabb3
xyzzyaacb3=2.d0*xyzzyaadl3
xyzzyaacc3=3.d0*xyzzyaadl3
xyzzyaacm3=xyzzyaadl3*xyzzyaaba3
xyzzyaacn3=xyzzyaadl3*xyzzyaabb3
xyzzyaaco3=xyzzyaadl3*xyzzyaabc3
xyzzyaacd3=2.d0*xyzzyaacn3
xyzzyaacr3=4.d0*xyzzyaaco3
xyzzyaacs3=8.d0*xyzzyaaco3
xyzzyaact3=6.d0*xyzzyaacn3
xyzzyaacp3=xyzzyaadl3*xyzzyaabh3
xyzzyaacq3=xyzzyaadl3*xyzzyaabi3
xyzzyaacu3=xyzzyaabj3-3.d0*(xyzzyaabn3+xyzzyaabo3)
xyzzyaacv3=0.375d0*xyzzyaacl3
xyzzyaacw3=0.75d0*xyzzyaabm3
xyzzyaadq3(1)=(xyzzyaacu3+xyzzyaacv3+xyzzyaacw3)
xyzzyaacx3=7.5d0*(xyzzyaabp3+xyzzyaabq3)
xyzzyaadq3(2)=10.d0*xyzzyaabr3-xyzzyaacx3
xyzzyaacy3=7.5d0*(xyzzyaabs3+xyzzyaabx3)
xyzzyaadq3(3)=10.d0*xyzzyaabt3-xyzzyaacy3
xyzzyaacz3=45.d0*(xyzzyaabn3-xyzzyaabo3)
xyzzyaada3=7.5d0*(xyzzyaabi3-xyzzyaabh3)
xyzzyaadq3(4)=xyzzyaacz3+xyzzyaada3
xyzzyaadb3=15.d0*(xyzzyaabu3+xyzzyaaby3)
xyzzyaadq3(5)=90.d0*xyzzyaabv3-xyzzyaadb3
xyzzyaadc3=315.d0*xyzzyaabq3
xyzzyaadq3(6)=105.d0*xyzzyaabp3-xyzzyaadc3
xyzzyaadd3=315.d0*xyzzyaabs3
xyzzyaadq3(7)=xyzzyaadd3-105.d0*xyzzyaabx3
xyzzyaadq3(8)=105.d0*xyzzyaacl3-630.d0*xyzzyaabm3
xyzzyaadq3(9)=420.d0*(xyzzyaabu3-xyzzyaaby3)
xyzzyaadp3=c_prim(xyzzyaaam3)*xyzzyaadm3
do xyzzyaaan3=1,9
xyzzyaadq3(xyzzyaaan3)=xyzzyaadq3(xyzzyaaan3)*xyzzyaadp3
enddo
xyzzyaade3=xyzzyaacc3*xyzzyaacl3
xyzzyaadf3=xyzzyaabc3*(24.d0+xyzzyaacs3)
xyzzyaadg3=6.d0*xyzzyaabb3*(1.d0+xyzzyaacr3)
xyzzyaadh3=6.d0*xyzzyaaba3*(xyzzyaacn3+xyzzyaacr3-1.d0)
xyzzyaadi3=-0.25d0*(xyzzyaade3+xyzzyaadf3-xyzzyaadg3+xyzzyaadh3)
xyzzyaadr3(1)=xyzzyaaax3*xyzzyaadi3
xyzzyaadr3(2)=xyzzyaaay3*xyzzyaadi3
xyzzyaadf3=8.d0*xyzzyaabc3*(xyzzyaaco3-2.d0)
xyzzyaadg3=24.d0*xyzzyaabb3*(xyzzyaaco3-1.d0)
xyzzyaadh3=xyzzyaadh3+30.d0*xyzzyaaba3
xyzzyaadi3=xyzzyaade3+xyzzyaadf3-xyzzyaadg3+xyzzyaadh3
xyzzyaadr3(3)=-0.25d0*xyzzyaaaz3*xyzzyaadi3
xyzzyaadf3=6.d0*xyzzyaacp3-3.d0*xyzzyaabb3+4.d0*xyzzyaabc3
xyzzyaadg3=9.d0-xyzzyaact3+xyzzyaacs3
xyzzyaadr3(4)=2.5d0*xyzzyaaaz3*(xyzzyaadf3-xyzzyaaba3*xyzzyaadg3)
xyzzyaadg3=3.d0*xyzzyaabz3-4.d0*xyzzyaabc3
xyzzyaadr3(5)=5.d0*xyzzyaabw3*(xyzzyaadl3*xyzzyaadg3-3.d0)
xyzzyaadh3=xyzzyaabc3*(12.d0-xyzzyaacs3)
xyzzyaadi3=xyzzyaabz3*(6.d0*xyzzyaaco3-3.d0)
xyzzyaadi3=2.5d0*(xyzzyaadi3+xyzzyaadh3)
xyzzyaadr3(6)=xyzzyaaax3*xyzzyaadi3
xyzzyaadr3(7)=xyzzyaadr3(5)
xyzzyaadr3(9)=xyzzyaaay3*xyzzyaadi3
xyzzyaadf3=6.d0*xyzzyaacq3-xyzzyaaba3*(3.d0-xyzzyaact3)
xyzzyaadg3=4.d0*xyzzyaabc3-xyzzyaabb3*(9.d0+xyzzyaacs3)
xyzzyaadr3(8)=2.5d0*xyzzyaaaz3*(xyzzyaadf3+xyzzyaadg3)
xyzzyaadh3=xyzzyaacp3-xyzzyaacq3
xyzzyaadi3=6.d0*(xyzzyaabc3+xyzzyaadl3*xyzzyaabo3)
xyzzyaadj3=2.d0*xyzzyaaba3*(1.d0+3.d0*xyzzyaaco3)
xyzzyaadr3(10)=15.d0*xyzzyaaax3*(xyzzyaadh3+xyzzyaadi3-xyzzyaadj3)
xyzzyaade3=6.d0*xyzzyaabc3
xyzzyaadf3=xyzzyaadl3*(xyzzyaabz3-xyzzyaade3)
xyzzyaadg3=2.d0*xyzzyaabb3-xyzzyaade3
xyzzyaadr3(11)=15.d0*xyzzyaaay3*(xyzzyaadf3*xyzzyaaca3+xyzzyaadg3)
xyzzyaadf3=xyzzyaadf3+6.d0
xyzzyaadr3(12)=15.d0*xyzzyaaaz3*xyzzyaaca3*xyzzyaadf3
xyzzyaadr3(15)=30.d0*xyzzyaabw3*xyzzyaadf3
xyzzyaadg3=2.d0*xyzzyaacp3-xyzzyaabb3+xyzzyaade3
xyzzyaadh3=xyzzyaacb3*(xyzzyaabb3-xyzzyaade3)-3.d0
xyzzyaadr3(13)=15.d0*xyzzyaaay3*(xyzzyaadg3+xyzzyaaba3*xyzzyaadh3)
xyzzyaadi3=2.d0*xyzzyaacq3+xyzzyaaba3*(2.d0*xyzzyaacn3-1.d0)
xyzzyaadj3=xyzzyaade3-3.d0*xyzzyaabb3*(1.d0+4.d0*xyzzyaaco3)
xyzzyaadr3(14)=15.d0*xyzzyaaax3*(xyzzyaadi3+xyzzyaadj3)
xyzzyaade3=105.d0*xyzzyaaaz3
xyzzyaadf3=3.d0*xyzzyaaba3*(1.d0+xyzzyaacd3)
xyzzyaadf3=xyzzyaadf3-2.d0*xyzzyaacp3-3.d0*xyzzyaabb3
xyzzyaadr3(16)=xyzzyaade3*xyzzyaadf3
xyzzyaadg3=xyzzyaaba3-3.d0*xyzzyaabb3
xyzzyaadh3=1.d0-2.d0*xyzzyaaco3
xyzzyaadi3=210.d0*xyzzyaabw3
xyzzyaadr3(17)=(-xyzzyaadi3)*(3.d0+xyzzyaadl3*xyzzyaadg3)
xyzzyaadr3(18)=105.d0*xyzzyaaax3*xyzzyaadg3*xyzzyaadh3
xyzzyaadr3(19)=xyzzyaadi3*(3.d0-3.d0*xyzzyaacm3+xyzzyaacn3)
xyzzyaadj3=xyzzyaaba3*(xyzzyaact3-3.d0)
xyzzyaadr3(20)=xyzzyaade3*(2.d0*xyzzyaacq3-3.d0*xyzzyaabb3-xyzzyaadj3)
xyzzyaadg3=xyzzyaabb3-3.d0*xyzzyaaba3
xyzzyaadh3=2.d0*xyzzyaaco3-1.d0
xyzzyaadr3(21)=105.d0*xyzzyaaay3*xyzzyaadg3*xyzzyaadh3
xyzzyaade3=2.d0*xyzzyaaba3*(1+3.d0*xyzzyaacn3)
xyzzyaadf3=xyzzyaacp3+xyzzyaabb3*(6.d0+xyzzyaacn3)
xyzzyaadr3(22)=210.d0*xyzzyaaax3*(xyzzyaade3-xyzzyaadf3)
xyzzyaadg3=xyzzyaabb3*(xyzzyaacn3-2.d0)
xyzzyaadh3=xyzzyaacp3+6.d0*xyzzyaaba3*(1.d0-xyzzyaacn3)
xyzzyaadr3(23)=-210.d0*xyzzyaaay3*(xyzzyaadg3+xyzzyaadh3)
xyzzyaadi3=6.d0*xyzzyaabm3-xyzzyaacl3
xyzzyaadr3(24)=210.d0*xyzzyaadl3*xyzzyaaaz3*xyzzyaadi3
xyzzyaadj3=xyzzyaaba3*(3.d0+xyzzyaacd3)
xyzzyaadk3=2.d0*xyzzyaacp3+xyzzyaabb3
xyzzyaadr3(25)=420.d0*xyzzyaaay3*(xyzzyaadj3-xyzzyaadk3)
xyzzyaadh3=2.d0*xyzzyaacq3-3.d0*xyzzyaabb3
xyzzyaadi3=xyzzyaaba3*(xyzzyaacd3-1.d0)
xyzzyaadr3(26)=420.d0*xyzzyaaax3*(xyzzyaadh3-xyzzyaadi3)
xyzzyaadr3(27)=840.d0*xyzzyaadl3*xyzzyaabw3*(xyzzyaaba3-xyzzyaabb3)
do xyzzyaaan3=1,27
xyzzyaadr3(xyzzyaaan3)=xyzzyaadr3(xyzzyaaan3)*xyzzyaadp3
enddo
end select
xyzzyaaap3=xyzzyaaag3+1
xyzzyaaaq3=xyzzyaaag3+xyzzyaaah3
agra1_m(xyzzyaaap3:xyzzyaaaq3)=agra1_m(xyzzyaaap3:xyzzyaaaq3)+xyzzyaad&
&r3(1:xyzzyaaai3:3)
agra2_m(xyzzyaaap3:xyzzyaaaq3)=agra2_m(xyzzyaaap3:xyzzyaaaq3)+xyzzyaad&
&r3(2:xyzzyaaai3:3)
agra3_m(xyzzyaaap3:xyzzyaaaq3)=agra3_m(xyzzyaaap3:xyzzyaaaq3)+xyzzyaad&
&r3(3:xyzzyaaai3:3)
asderiv1_m(xyzzyaaap3:xyzzyaaaq3)=asderiv1_m(xyzzyaaap3:xyzzyaaaq3)+xy&
&zzyaads3(1:xyzzyaaaj3:6)
asderiv2_m(xyzzyaaap3:xyzzyaaaq3)=asderiv2_m(xyzzyaaap3:xyzzyaaaq3)+xy&
&zzyaads3(2:xyzzyaaaj3:6)
asderiv3_m(xyzzyaaap3:xyzzyaaaq3)=asderiv3_m(xyzzyaaap3:xyzzyaaaq3)+xy&
&zzyaads3(3:xyzzyaaaj3:6)
asderiv4_m(xyzzyaaap3:xyzzyaaaq3)=asderiv4_m(xyzzyaaap3:xyzzyaaaq3)+xy&
&zzyaads3(4:xyzzyaaaj3:6)
asderiv5_m(xyzzyaaap3:xyzzyaaaq3)=asderiv5_m(xyzzyaaap3:xyzzyaaaq3)+xy&
&zzyaads3(5:xyzzyaaaj3:6)
asderiv6_m(xyzzyaaap3:xyzzyaaaq3)=asderiv6_m(xyzzyaaap3:xyzzyaaaq3)+xy&
&zzyaads3(6:xyzzyaaaj3:6)
enddo
if(xyzzyaakz3)then
do xyzzyaaan3=1,xyzzyaaah3
xyzzyaaas3(xyzzyaaar3+xyzzyaaan3)=xyzzyaaag3+xyzzyaaan3
enddo
xyzzyaaar3=xyzzyaaar3+xyzzyaaah3
endif
enddo
enddo
if(use_gpcc)call cusp_wfdet_real(rvec,jspin,.false.,.true.,cusp_val_r,&
&cusp_grad_r,cusp_lap_r,cusp_sderivs_r)
xyzzyaaat3=gauss_offset(jspin)
xyzzyaaav3=nuc_nele(jspin)
xyzzyaaau3=xyzzyaaat3-1+xyzzyaaav3
orbgrad(1,xyzzyaaat3:xyzzyaaau3,1)=multi_ddot_s(xyzzyaaav3,xyzzyaaar3,&
&xyzzyaaas3,orbmask(xyzzyaaat3),rck(:,:,:,xyzzyaaab1),size_rck,maxb,ag&
&ra1_m,rnorm)
orbgrad(2,xyzzyaaat3:xyzzyaaau3,1)=multi_ddot_s(xyzzyaaav3,xyzzyaaar3,&
&xyzzyaaas3,orbmask(xyzzyaaat3),rck(:,:,:,xyzzyaaab1),size_rck,maxb,ag&
&ra2_m,rnorm)
orbgrad(3,xyzzyaaat3:xyzzyaaau3,1)=multi_ddot_s(xyzzyaaav3,xyzzyaaar3,&
&xyzzyaaas3,orbmask(xyzzyaaat3),rck(:,:,:,xyzzyaaab1),size_rck,maxb,ag&
&ra3_m,rnorm)
orbsderivs(1,xyzzyaaat3:xyzzyaaau3,1)=multi_ddot_s(xyzzyaaav3,xyzzyaaa&
&r3,xyzzyaaas3,orbmask(xyzzyaaat3),rck(:,:,:,xyzzyaaab1),size_rck,maxb&
&,asderiv1_m,rnorm)
orbsderivs(2,xyzzyaaat3:xyzzyaaau3,1)=multi_ddot_s(xyzzyaaav3,xyzzyaaa&
&r3,xyzzyaaas3,orbmask(xyzzyaaat3),rck(:,:,:,xyzzyaaab1),size_rck,maxb&
&,asderiv2_m,rnorm)
orbsderivs(3,xyzzyaaat3:xyzzyaaau3,1)=multi_ddot_s(xyzzyaaav3,xyzzyaaa&
&r3,xyzzyaaas3,orbmask(xyzzyaaat3),rck(:,:,:,xyzzyaaab1),size_rck,maxb&
&,asderiv3_m,rnorm)
orbsderivs(4,xyzzyaaat3:xyzzyaaau3,1)=multi_ddot_s(xyzzyaaav3,xyzzyaaa&
&r3,xyzzyaaas3,orbmask(xyzzyaaat3),rck(:,:,:,xyzzyaaab1),size_rck,maxb&
&,asderiv4_m,rnorm)
orbsderivs(5,xyzzyaaat3:xyzzyaaau3,1)=multi_ddot_s(xyzzyaaav3,xyzzyaaa&
&r3,xyzzyaaas3,orbmask(xyzzyaaat3),rck(:,:,:,xyzzyaaab1),size_rck,maxb&
&,asderiv5_m,rnorm)
orbsderivs(6,xyzzyaaat3:xyzzyaaau3,1)=multi_ddot_s(xyzzyaaav3,xyzzyaaa&
&r3,xyzzyaaas3,orbmask(xyzzyaaat3),rck(:,:,:,xyzzyaaab1),size_rck,maxb&
&,asderiv6_m,rnorm)
if(use_gpcc)then
do xyzzyaaan3=1,gauss_gs_norb
if(.not.orbmask(xyzzyaaan3))cycle
orbgrad(:,xyzzyaaan3,1)=orbgrad(:,xyzzyaaan3,1)+cusp_grad_r(:,xyzzyaaa&
&n3)
orbsderivs(:,xyzzyaaan3,1)=orbsderivs(:,xyzzyaaan3,1)+cusp_sderivs_r(:&
&,xyzzyaaan3)
enddo
endif
if(excite)then
do xyzzyaaan3=1,gauss_ex_norb
xyzzyaaao3=gauss_gs_norb+xyzzyaaan3
if(.not.orbmask(xyzzyaaao3))cycle
xyzzyaaac3=full2vrt(xyzzyaaan3,jspin)
fgra1(xyzzyaaan3)=sum(agra1_m(:)*rck_ex(:,xyzzyaaac3,jspin))*rnorm
fgra2(xyzzyaaan3)=sum(agra2_m(:)*rck_ex(:,xyzzyaaac3,jspin))*rnorm
fgra3(xyzzyaaan3)=sum(agra3_m(:)*rck_ex(:,xyzzyaaac3,jspin))*rnorm
fsderiv1(xyzzyaaan3)=sum(asderiv1_m(:)*rck_ex(:,xyzzyaaac3,jspin))*rno&
&rm
fsderiv2(xyzzyaaan3)=sum(asderiv2_m(:)*rck_ex(:,xyzzyaaac3,jspin))*rno&
&rm
fsderiv3(xyzzyaaan3)=sum(asderiv3_m(:)*rck_ex(:,xyzzyaaac3,jspin))*rno&
&rm
fsderiv4(xyzzyaaan3)=sum(asderiv4_m(:)*rck_ex(:,xyzzyaaac3,jspin))*rno&
&rm
fsderiv5(xyzzyaaan3)=sum(asderiv5_m(:)*rck_ex(:,xyzzyaaac3,jspin))*rno&
&rm
fsderiv6(xyzzyaaan3)=sum(asderiv6_m(:)*rck_ex(:,xyzzyaaac3,jspin))*rno&
&rm
if(use_gpcc)then
fgra1(xyzzyaaan3)=fgra1(xyzzyaaan3)+cusp_grad_r(1,xyzzyaaao3)
fgra2(xyzzyaaan3)=fgra2(xyzzyaaan3)+cusp_grad_r(2,xyzzyaaao3)
fgra3(xyzzyaaan3)=fgra3(xyzzyaaan3)+cusp_grad_r(3,xyzzyaaao3)
fsderiv1(xyzzyaaan3)=fsderiv1(xyzzyaaan3)+cusp_sderivs_r(1,xyzzyaaao3)
fsderiv2(xyzzyaaan3)=fsderiv2(xyzzyaaan3)+cusp_sderivs_r(2,xyzzyaaao3)
fsderiv3(xyzzyaaan3)=fsderiv3(xyzzyaaan3)+cusp_sderivs_r(3,xyzzyaaao3)
fsderiv4(xyzzyaaan3)=fsderiv4(xyzzyaaan3)+cusp_sderivs_r(4,xyzzyaaao3)
fsderiv5(xyzzyaaan3)=fsderiv5(xyzzyaaan3)+cusp_sderivs_r(5,xyzzyaaao3)
fsderiv6(xyzzyaaan3)=fsderiv6(xyzzyaaan3)+cusp_sderivs_r(6,xyzzyaaao3)
endif
enddo
if(cusp_correction)then
do xyzzyaaab3=1,num_centres
if(is_ae(xyzzyaaab3))then
xyzzyaaax3=xpos_in_cell(xyzzyaaab3,1)
xyzzyaaay3=ypos_in_cell(xyzzyaaab3,1)
xyzzyaaaz3=zpos_in_cell(xyzzyaaab3,1)
xyzzyaaax3=rvec(1)-xyzzyaaax3
xyzzyaaay3=rvec(2)-xyzzyaaay3
xyzzyaaaz3=rvec(3)-xyzzyaaaz3
xyzzyaaba3=xyzzyaaax3*xyzzyaaax3
xyzzyaabb3=xyzzyaaay3*xyzzyaaay3
xyzzyaabc3=xyzzyaaaz3*xyzzyaaaz3
xyzzyaabd3=xyzzyaaax3*xyzzyaaay3
xyzzyaabf3=xyzzyaaax3*xyzzyaaaz3
xyzzyaabe3=xyzzyaaay3*xyzzyaaaz3
xyzzyaaaw3=xyzzyaaba3+xyzzyaabb3+xyzzyaabc3
do xyzzyaaan3=1,num_unique_orbitals(jspin)
xyzzyaadt3=rcusp_sq(xyzzyaaan3,xyzzyaaab3,xyzzyaaac1)
if(xyzzyaaaw3<xyzzyaadt3)then
if(xyzzyaaaw3/=0.d0)then
xyzzyaadu3=sqrt(xyzzyaaaw3)
xyzzyaady3=1.d0/xyzzyaadu3
xyzzyaadz3=2.d0*xyzzyaady3
xyzzyaaea3=xyzzyaaax3*xyzzyaady3
xyzzyaaeb3=xyzzyaaay3*xyzzyaady3
xyzzyaaec3=xyzzyaaaz3*xyzzyaady3
else
xyzzyaadu3=0.d0
xyzzyaady3=1.d0
xyzzyaadz3=2.d0
xyzzyaaea3=1.d0
xyzzyaaeb3=1.d0
xyzzyaaec3=1.d0
endif
xyzzyaaag1=xyzzyaaan3>nuc_nele(jspin)
if(xyzzyaaag1)then
xyzzyaaaa1=xyzzyaaan3-nuc_nele(jspin)
call wfdet_s_bf(xyzzyaadu3,xyzzyaaaw3,xyzzyaaba3,xyzzyaabb3,xyzzyaabc3&
&,xyzzyaabd3,xyzzyaabf3,xyzzyaabe3,3.d0,xyzzyaaaa1,xyzzyaaab3,jspin,1,&
&1,1,.true.,xyzzyaaab1,xyzzyaaad1,xyzzyaaae1,xyzzyaaaf1)
else
call wfdet_s_bf(xyzzyaadu3,xyzzyaaaw3,xyzzyaaba3,xyzzyaabb3,xyzzyaabc3&
&,xyzzyaabd3,xyzzyaabf3,xyzzyaabe3,3.d0,xyzzyaaan3,xyzzyaaab3,jspin,1,&
&1,1,.false.,xyzzyaaab1,xyzzyaaad1,xyzzyaaae1,xyzzyaaaf1)
endif
xyzzyaaee3=acusp(1,xyzzyaaan3,xyzzyaaab3,xyzzyaaac1)
xyzzyaaef3=acusp(2,xyzzyaaan3,xyzzyaaab3,xyzzyaaac1)
xyzzyaaeg3=acusp(3,xyzzyaaan3,xyzzyaaab3,xyzzyaaac1)
xyzzyaaeh3=acusp(4,xyzzyaaan3,xyzzyaaab3,xyzzyaaac1)
xyzzyaaei3=acusp(5,xyzzyaaan3,xyzzyaaab3,xyzzyaaac1)
xyzzyaadv3=xyzzyaaee3+xyzzyaaef3*xyzzyaadu3
xyzzyaadw3=xyzzyaaef3+2.d0*xyzzyaaeg3*xyzzyaadu3
xyzzyaadx3=2.d0*xyzzyaaeg3+6.d0*xyzzyaaeh3*xyzzyaadu3
xyzzyaaed3=xyzzyaadu3*xyzzyaadu3
xyzzyaadv3=xyzzyaadv3+xyzzyaaeg3*xyzzyaaed3
xyzzyaadw3=xyzzyaadw3+3.d0*xyzzyaaeh3*xyzzyaaed3
xyzzyaadx3=xyzzyaadx3+12.d0*xyzzyaaei3*xyzzyaaed3
xyzzyaaed3=xyzzyaaed3*xyzzyaadu3
xyzzyaadv3=xyzzyaadv3+xyzzyaaeh3*xyzzyaaed3
xyzzyaadw3=xyzzyaadw3+4.d0*xyzzyaaei3*xyzzyaaed3
xyzzyaaed3=xyzzyaaed3*xyzzyaadu3
xyzzyaadv3=xyzzyaadv3+xyzzyaaei3*xyzzyaaed3
xyzzyaacu3=disign(xyzzyaaan3,xyzzyaaab3,xyzzyaaac1)*exp(xyzzyaadv3)+ps&
&hift(xyzzyaaan3,xyzzyaaab3,xyzzyaaac1)
xyzzyaacv3=xyzzyaacu3*xyzzyaadw3
xyzzyaacw3=(xyzzyaadz3+xyzzyaadw3)*xyzzyaadw3+xyzzyaadx3
xyzzyaacx3=xyzzyaadw3*(xyzzyaadw3-xyzzyaady3)+xyzzyaadx3
xyzzyaacx3=xyzzyaacx3*xyzzyaady3**2
xyzzyaacy3=xyzzyaadw3*xyzzyaady3
xyzzyaacz3=xyzzyaacx3*xyzzyaacu3
if(xyzzyaaag1)then
xyzzyaaac3=vrt2full(xyzzyaaaa1,jspin)
fgra1(xyzzyaaac3)=fgra1(xyzzyaaac3)+(xyzzyaacv3-xyzzyaaae1(1))*xyzzyaa&
&ea3
fgra2(xyzzyaaac3)=fgra1(xyzzyaaac3)+(xyzzyaacv3-xyzzyaaae1(1))*xyzzyaa&
&eb3
fgra3(xyzzyaaac3)=fgra1(xyzzyaaac3)+(xyzzyaacv3-xyzzyaaae1(1))*xyzzyaa&
&ec3
fsderiv1(xyzzyaaac3)=fsderiv1(xyzzyaaac3)-xyzzyaaaf1(1,1)+(xyzzyaacy3+&
&xyzzyaacx3*xyzzyaaba3)*xyzzyaacu3
fsderiv2(xyzzyaaac3)=fsderiv2(xyzzyaaac3)-xyzzyaaaf1(2,1)+(xyzzyaacy3+&
&xyzzyaacx3*xyzzyaabb3)*xyzzyaacu3
fsderiv3(xyzzyaaac3)=fsderiv3(xyzzyaaac3)-xyzzyaaaf1(3,1)+(xyzzyaacy3+&
&xyzzyaacx3*xyzzyaabc3)*xyzzyaacu3
fsderiv4(xyzzyaaac3)=fsderiv4(xyzzyaaac3)-xyzzyaaaf1(4,1)+xyzzyaacz3*x&
&yzzyaabd3
fsderiv5(xyzzyaaac3)=fsderiv5(xyzzyaaac3)-xyzzyaaaf1(5,1)+xyzzyaacz3*x&
&yzzyaabf3
fsderiv6(xyzzyaaac3)=fsderiv6(xyzzyaaac3)-xyzzyaaaf1(6,1)+xyzzyaacz3*x&
&yzzyaabe3
else
xyzzyaaac3=xyzzyaaan3+gauss_offset(jspin)-1
orbgrad(1,xyzzyaaac3,1)=orbgrad(1,xyzzyaaac3,1)+(xyzzyaacv3-xyzzyaaae1&
&(1))*xyzzyaaea3
orbgrad(2,xyzzyaaac3,1)=orbgrad(2,xyzzyaaac3,1)+(xyzzyaacv3-xyzzyaaae1&
&(1))*xyzzyaaeb3
orbgrad(3,xyzzyaaac3,1)=orbgrad(3,xyzzyaaac3,1)+(xyzzyaacv3-xyzzyaaae1&
&(1))*xyzzyaaec3
orbsderivs(1,xyzzyaaac3,1)=orbsderivs(1,xyzzyaaac3,1)-xyzzyaaaf1(1,1)+&
&(xyzzyaacy3+xyzzyaacx3*xyzzyaaba3)*xyzzyaacu3
orbsderivs(2,xyzzyaaac3,1)=orbsderivs(2,xyzzyaaac3,1)-xyzzyaaaf1(2,1)+&
&(xyzzyaacy3+xyzzyaacx3*xyzzyaabb3)*xyzzyaacu3
orbsderivs(3,xyzzyaaac3,1)=orbsderivs(3,xyzzyaaac3,1)-xyzzyaaaf1(3,1)+&
&(xyzzyaacy3+xyzzyaacx3*xyzzyaabc3)*xyzzyaacu3
orbsderivs(4,xyzzyaaac3,1)=orbsderivs(4,xyzzyaaac3,1)-xyzzyaaaf1(4,1)+&
&xyzzyaacz3*xyzzyaabd3
orbsderivs(5,xyzzyaaac3,1)=orbsderivs(5,xyzzyaaac3,1)-xyzzyaaaf1(5,1)+&
&xyzzyaacz3*xyzzyaabf3
orbsderivs(6,xyzzyaaac3,1)=orbsderivs(6,xyzzyaaac3,1)-xyzzyaaaf1(6,1)+&
&xyzzyaacz3*xyzzyaabe3
endif
endif
enddo
endif
enddo
endif
do xyzzyaaan3=1,gauss_ex_norb
if(.not.orbmask(gauss_gs_norb+xyzzyaaan3))cycle
orbgrad(1,gauss_gs_norb+xyzzyaaan3,1)=fgra1(xyzzyaaan3)
orbgrad(2,gauss_gs_norb+xyzzyaaan3,1)=fgra2(xyzzyaaan3)
orbgrad(3,gauss_gs_norb+xyzzyaaan3,1)=fgra3(xyzzyaaan3)
orbsderivs(1,gauss_gs_norb+xyzzyaaan3,1)=fsderiv1(xyzzyaaan3)
orbsderivs(2,gauss_gs_norb+xyzzyaaan3,1)=fsderiv2(xyzzyaaan3)
orbsderivs(3,gauss_gs_norb+xyzzyaaan3,1)=fsderiv3(xyzzyaaan3)
orbsderivs(4,gauss_gs_norb+xyzzyaaan3,1)=fsderiv4(xyzzyaaan3)
orbsderivs(5,gauss_gs_norb+xyzzyaaan3,1)=fsderiv5(xyzzyaaan3)
orbsderivs(6,gauss_gs_norb+xyzzyaaan3,1)=fsderiv6(xyzzyaaan3)
enddo
else
if(cusp_correction)then
do xyzzyaaab3=1,num_centres
if(is_ae(xyzzyaaab3))then
xyzzyaaax3=xpos_in_cell(xyzzyaaab3,1)
xyzzyaaay3=ypos_in_cell(xyzzyaaab3,1)
xyzzyaaaz3=zpos_in_cell(xyzzyaaab3,1)
xyzzyaaax3=rvec(1)-xyzzyaaax3
xyzzyaaay3=rvec(2)-xyzzyaaay3
xyzzyaaaz3=rvec(3)-xyzzyaaaz3
xyzzyaaba3=xyzzyaaax3*xyzzyaaax3
xyzzyaabb3=xyzzyaaay3*xyzzyaaay3
xyzzyaabc3=xyzzyaaaz3*xyzzyaaaz3
xyzzyaabd3=xyzzyaaax3*xyzzyaaay3
xyzzyaabf3=xyzzyaaax3*xyzzyaaaz3
xyzzyaabe3=xyzzyaaay3*xyzzyaaaz3
xyzzyaaaw3=xyzzyaaba3+xyzzyaabb3+xyzzyaabc3
do xyzzyaaan3=1,num_unique_orbitals(jspin)
xyzzyaadt3=rcusp_sq(xyzzyaaan3,xyzzyaaab3,xyzzyaaac1)
if(xyzzyaaaw3<xyzzyaadt3)then
if(xyzzyaaaw3/=0.d0)then
xyzzyaadu3=sqrt(xyzzyaaaw3)
xyzzyaady3=1.d0/xyzzyaadu3
xyzzyaadz3=2.d0*xyzzyaady3
xyzzyaaea3=xyzzyaaax3*xyzzyaady3
xyzzyaaeb3=xyzzyaaay3*xyzzyaady3
xyzzyaaec3=xyzzyaaaz3*xyzzyaady3
else
xyzzyaadu3=0.d0
xyzzyaady3=1.d0
xyzzyaadz3=2.d0
xyzzyaaea3=1.d0
xyzzyaaeb3=1.d0
xyzzyaaec3=1.d0
endif
call wfdet_s_bf(xyzzyaadu3,xyzzyaaaw3,xyzzyaaba3,xyzzyaabb3,xyzzyaabc3&
&,xyzzyaabd3,xyzzyaabf3,xyzzyaabe3,3.d0,xyzzyaaan3,xyzzyaaab3,jspin,1,&
&1,1,.false.,xyzzyaaab1,xyzzyaaad1,xyzzyaaae1,xyzzyaaaf1)
xyzzyaaee3=acusp(1,xyzzyaaan3,xyzzyaaab3,xyzzyaaac1)
xyzzyaaef3=acusp(2,xyzzyaaan3,xyzzyaaab3,xyzzyaaac1)
xyzzyaaeg3=acusp(3,xyzzyaaan3,xyzzyaaab3,xyzzyaaac1)
xyzzyaaeh3=acusp(4,xyzzyaaan3,xyzzyaaab3,xyzzyaaac1)
xyzzyaaei3=acusp(5,xyzzyaaan3,xyzzyaaab3,xyzzyaaac1)
xyzzyaadv3=xyzzyaaee3+xyzzyaaef3*xyzzyaadu3
xyzzyaadw3=xyzzyaaef3+2.d0*xyzzyaaeg3*xyzzyaadu3
xyzzyaadx3=2.d0*xyzzyaaeg3+6.d0*xyzzyaaeh3*xyzzyaadu3
xyzzyaaed3=xyzzyaadu3*xyzzyaadu3
xyzzyaadv3=xyzzyaadv3+xyzzyaaeg3*xyzzyaaed3
xyzzyaadw3=xyzzyaadw3+3.d0*xyzzyaaeh3*xyzzyaaed3
xyzzyaadx3=xyzzyaadx3+12.d0*xyzzyaaei3*xyzzyaaed3
xyzzyaaed3=xyzzyaaed3*xyzzyaadu3
xyzzyaadv3=xyzzyaadv3+xyzzyaaeh3*xyzzyaaed3
xyzzyaadw3=xyzzyaadw3+4.d0*xyzzyaaei3*xyzzyaaed3
xyzzyaaed3=xyzzyaaed3*xyzzyaadu3
xyzzyaadv3=xyzzyaadv3+xyzzyaaei3*xyzzyaaed3
xyzzyaacu3=disign(xyzzyaaan3,xyzzyaaab3,xyzzyaaac1)*exp(xyzzyaadv3)+ps&
&hift(xyzzyaaan3,xyzzyaaab3,xyzzyaaac1)
xyzzyaacv3=xyzzyaacu3*xyzzyaadw3
xyzzyaacw3=(xyzzyaadz3+xyzzyaadw3)*xyzzyaadw3+xyzzyaadx3
xyzzyaacx3=xyzzyaadw3*(xyzzyaadw3-xyzzyaady3)+xyzzyaadx3
xyzzyaacx3=xyzzyaacx3*xyzzyaady3**2
xyzzyaacy3=xyzzyaadw3*xyzzyaady3
xyzzyaacz3=xyzzyaacx3*xyzzyaacu3
xyzzyaaac3=xyzzyaaan3+gauss_offset(jspin)-1
orbgrad(1,xyzzyaaac3,1)=orbgrad(1,xyzzyaaac3,1)+(xyzzyaacv3-xyzzyaaae1&
&(1))*xyzzyaaea3
orbgrad(2,xyzzyaaac3,1)=orbgrad(2,xyzzyaaac3,1)+(xyzzyaacv3-xyzzyaaae1&
&(1))*xyzzyaaeb3
orbgrad(3,xyzzyaaac3,1)=orbgrad(3,xyzzyaaac3,1)+(xyzzyaacv3-xyzzyaaae1&
&(1))*xyzzyaaec3
orbsderivs(1,xyzzyaaac3,1)=orbsderivs(1,xyzzyaaac3,1)-xyzzyaaaf1(1,1)+&
&(xyzzyaacy3+xyzzyaacx3*xyzzyaaba3)*xyzzyaacu3
orbsderivs(2,xyzzyaaac3,1)=orbsderivs(2,xyzzyaaac3,1)-xyzzyaaaf1(2,1)+&
&(xyzzyaacy3+xyzzyaacx3*xyzzyaabb3)*xyzzyaacu3
orbsderivs(3,xyzzyaaac3,1)=orbsderivs(3,xyzzyaaac3,1)-xyzzyaaaf1(3,1)+&
&(xyzzyaacy3+xyzzyaacx3*xyzzyaabc3)*xyzzyaacu3
orbsderivs(4,xyzzyaaac3,1)=orbsderivs(4,xyzzyaaac3,1)-xyzzyaaaf1(4,1)+&
&xyzzyaacz3*xyzzyaabd3
orbsderivs(5,xyzzyaaac3,1)=orbsderivs(5,xyzzyaaac3,1)-xyzzyaaaf1(5,1)+&
&xyzzyaacz3*xyzzyaabf3
orbsderivs(6,xyzzyaaac3,1)=orbsderivs(6,xyzzyaaac3,1)-xyzzyaaaf1(6,1)+&
&xyzzyaacz3*xyzzyaabe3
endif
enddo
endif
enddo
endif
endif
end subroutine xyzzyaaah1
subroutine xyzzyaaai1(rvec,jspin,norb,orbmask,orbval,orbgrad,orbsderiv&
&s)
implicit none
integer,intent(in) :: jspin,norb
real(dp),intent(in) :: rvec(3)
real(dp),intent(inout) :: orbval(norb,real1_complex2),orbgrad(3,norb,r&
&eal1_complex2),orbsderivs(6,norb,real1_complex2)
logical,intent(in) :: orbmask(norb)
integer xyzzyaaaa4,xyzzyaaab4,xyzzyaaac4,xyzzyaaad4,xyzzyaaae4,xyzzyaa&
&af4,xyzzyaaag4,xyzzyaaah4,xyzzyaaai4,xyzzyaaaj4,xyzzyaaak4,xyzzyaaal4&
&,xyzzyaaam4,xyzzyaaan4,xyzzyaaao4,xyzzyaaap4,xyzzyaaaq4,xyzzyaaar4,xy&
&zzyaaas4(num_ao),xyzzyaaat4,xyzzyaaau4,xyzzyaaav4
real(dp) xyzzyaaaw4,xyzzyaaax4,xyzzyaaay4,xyzzyaaaz4,xyzzyaaba4,xyzzya&
&abb4,xyzzyaabc4,xyzzyaabd4,xyzzyaabe4,xyzzyaabf4,xyzzyaabg4,xyzzyaabh&
&4,xyzzyaabi4,xyzzyaabj4,xyzzyaabk4,xyzzyaabl4,xyzzyaabm4,xyzzyaabn4,x&
&yzzyaabo4,xyzzyaabp4,xyzzyaabq4,xyzzyaabr4,xyzzyaabs4,xyzzyaabt4,xyzz&
&yaabu4,xyzzyaabv4,xyzzyaabw4,xyzzyaabx4,xyzzyaaby4,xyzzyaabz4,xyzzyaa&
&ca4,xyzzyaacb4,xyzzyaacc4,xyzzyaacd4,xyzzyaace4,xyzzyaacf4,xyzzyaacg4&
&,xyzzyaach4,xyzzyaaci4,xyzzyaacj4,xyzzyaack4,xyzzyaacl4,xyzzyaacm4,xy&
&zzyaacn4,xyzzyaaco4,xyzzyaacp4,xyzzyaacq4,xyzzyaacr4,xyzzyaacs4,xyzzy&
&aact4,xyzzyaacu4,xyzzyaacv4,xyzzyaacw4,xyzzyaacx4,xyzzyaacy4,xyzzyaac&
&z4,xyzzyaada4,xyzzyaadb4,xyzzyaadc4,xyzzyaadd4,xyzzyaade4,xyzzyaadf4,&
&xyzzyaadg4,xyzzyaadh4,xyzzyaadi4,xyzzyaadj4,xyzzyaadk4,xyzzyaadl4,xyz&
&zyaadm4,xyzzyaadn4,xyzzyaado4,xyzzyaadp4,xyzzyaadq4,xyzzyaadr4,xyzzya&
&ads4,xyzzyaadt4,xyzzyaadu4,xyzzyaadv4(9),xyzzyaadw4(27),xyzzyaadx4(42&
&),xyzzyaady4,xyzzyaadz4,xyzzyaaea4,xyzzyaaeb4,xyzzyaaec4,xyzzyaaed4,x&
&yzzyaaee4,xyzzyaaef4,xyzzyaaeg4,xyzzyaaeh4,xyzzyaaei4,xyzzyaaej4,xyzz&
&yaaek4,xyzzyaael4,xyzzyaaem4,xyzzyaaen4
real(dp) xyzzyaaeo4,xyzzyaaep4,xyzzyaaeq4,xyzzyaaer4,xyzzyaaes4,xyzzya&
&aet4,xyzzyaaeu4,xyzzyaaev4,xyzzyaaew4,xyzzyaaex4,xyzzyaaey4,xyzzyaaez&
&4,xyzzyaafa4,xyzzyaafb4,xyzzyaafc4,xyzzyaafd4,xyzzyaafe4,xyzzyaaff4,x&
&yzzyaafg4,xyzzyaafh4,xyzzyaafi4,xyzzyaafj4,xyzzyaafk4,xyzzyaafl4,xyzz&
&yaafm4,xyzzyaafn4,xyzzyaafo4,xyzzyaafp4,xyzzyaafq4,xyzzyaafr4,xyzzyaa&
&fs4,xyzzyaaft4,xyzzyaafu4,xyzzyaafv4,xyzzyaafw4,xyzzyaafx4,xyzzyaafy4&
&,xyzzyaafz4,xyzzyaaga4,xyzzyaagb4,xyzzyaagc4,xyzzyaagd4,xyzzyaage4,xy&
&zzyaagf4,xyzzyaagg4,xyzzyaagh4,xyzzyaagi4,xyzzyaagj4,xyzzyaagk4,xyzzy&
&aagl4,xyzzyaagm4,xyzzyaagn4,xyzzyaago4,xyzzyaagp4,xyzzyaagq4,xyzzyaag&
&r4,xyzzyaags4,xyzzyaagt4,xyzzyaagu4,xyzzyaagv4,xyzzyaagw4,xyzzyaagx4,&
&xyzzyaagy4,xyzzyaagz4,xyzzyaaha4,xyzzyaahb4,xyzzyaahc4,xyzzyaahd4,xyz&
&zyaahe4,xyzzyaahf4,xyzzyaahg4,xyzzyaahh4,xyzzyaahi4,xyzzyaahj4,xyzzya&
&ahk4,xyzzyaahl4,xyzzyaahm4,xyzzyaahn4,xyzzyaaho4,xyzzyaahp4,xyzzyaahq&
&4,xyzzyaahr4,xyzzyaahs4,xyzzyaaht4,xyzzyaahu4,xyzzyaahv4,xyzzyaahw4,x&
&yzzyaahx4,xyzzyaahy4,xyzzyaahz4,xyzzyaaia4,xyzzyaaib4,xyzzyaaic4,xyzz&
&yaaid4,xyzzyaaie4,xyzzyaaif4,xyzzyaaig4,xyzzyaaih4,xyzzyaaii4,xyzzyaa&
&ij4,xyzzyaaik4,xyzzyaail4,xyzzyaaim4,xyzzyaain4,xyzzyaaio4,xyzzyaaip4&
&,xyzzyaaiq4,xyzzyaair4,xyzzyaais4,xyzzyaait4,xyzzyaaiu4,xyzzyaaiv4,xy&
&zzyaaiw4,xyzzyaaix4,xyzzyaaiy4,xyzzyaaiz4,xyzzyaaja4,xyzzyaajb4,xyzzy&
&aajc4,xyzzyaajd4,xyzzyaaje4,xyzzyaajf4,xyzzyaajg4,xyzzyaajh4
real(dp) xyzzyaaji4,xyzzyaajj4,xyzzyaajk4,xyzzyaajl4,xyzzyaajm4,xyzzya&
&ajn4,xyzzyaajo4,xyzzyaajp4,xyzzyaajq4,xyzzyaajr4,xyzzyaajs4,xyzzyaajt&
&4,xyzzyaaju4,xyzzyaajv4,xyzzyaajw4,xyzzyaajx4,xyzzyaajy4,xyzzyaajz4,x&
&yzzyaaka4,xyzzyaakb4,xyzzyaakc4,xyzzyaakd4,xyzzyaake4,xyzzyaakf4,xyzz&
&yaakg4,xyzzyaakh4,xyzzyaaki4,xyzzyaakj4,xyzzyaakk4,xyzzyaakl4,xyzzyaa&
&km4,xyzzyaakn4,xyzzyaako4,xyzzyaakp4,xyzzyaakq4,xyzzyaakr4,xyzzyaaks4&
&,xyzzyaakt4,xyzzyaaku4,xyzzyaakv4,xyzzyaakw4,xyzzyaakx4,xyzzyaaky4,xy&
&zzyaakz4,xyzzyaala4,xyzzyaalb4,xyzzyaalc4,xyzzyaald4
logical xyzzyaale4
xyzzyaaaa4=0
ao_m=0.d0
agra1_m=0.d0
agra2_m=0.d0
agra3_m=0.d0
asderiv1_m=0.d0
asderiv2_m=0.d0
asderiv3_m=0.d0
asderiv4_m=0.d0
asderiv5_m=0.d0
asderiv6_m=0.d0
xyzzyaaar4=0
do xyzzyaaab4=1,num_centres
if(which_ion_displaced==xyzzyaaab4)then
xyzzyaaax4=xpos_in_cell(xyzzyaaab4,1)+ion_displacement(1)
xyzzyaaay4=ypos_in_cell(xyzzyaaab4,1)+ion_displacement(2)
xyzzyaaaz4=zpos_in_cell(xyzzyaaab4,1)+ion_displacement(3)
else
xyzzyaaax4=xpos_in_cell(xyzzyaaab4,1)
xyzzyaaay4=ypos_in_cell(xyzzyaaab4,1)
xyzzyaaaz4=zpos_in_cell(xyzzyaaab4,1)
endif
xyzzyaaax4=rvec(1)-xyzzyaaax4
xyzzyaaay4=rvec(2)-xyzzyaaay4
xyzzyaaaz4=rvec(3)-xyzzyaaaz4
xyzzyaaba4=xyzzyaaax4*xyzzyaaax4
xyzzyaabb4=xyzzyaaay4*xyzzyaaay4
xyzzyaabc4=xyzzyaaaz4*xyzzyaaaz4
xyzzyaabd4=xyzzyaaax4*xyzzyaaay4
xyzzyaabf4=xyzzyaaax4*xyzzyaaaz4
xyzzyaabe4=xyzzyaaay4*xyzzyaaaz4
xyzzyaaaw4=xyzzyaaba4+xyzzyaabb4+xyzzyaabc4
xyzzyaaac4=num_shells_on_centre(xyzzyaaab4,1)
do xyzzyaaad4=1,xyzzyaaac4
xyzzyaaaa4=xyzzyaaaa4+1
xyzzyaaae4=shell_sequence_number(xyzzyaaaa4)
xyzzyaadq4=min_exponent(xyzzyaaae4)
xyzzyaacy4=xyzzyaadq4*xyzzyaaaw4
if(xyzzyaacy4>screening_tolerance)cycle
xyzzyaaaf4=shell_am(xyzzyaaae4)
xyzzyaaag4=first_ao(xyzzyaaae4)-1
xyzzyaaah4=numao_in_shell(xyzzyaaae4)
xyzzyaaai4=xyzzyaaah4*3
xyzzyaaaj4=xyzzyaaah4*6
xyzzyaaak4=primitive(xyzzyaaae4)
xyzzyaaal4=primitive(xyzzyaaae4+1)-1
xyzzyaale4=.false.
do xyzzyaaam4=xyzzyaaak4,xyzzyaaal4
xyzzyaadq4=exponent(xyzzyaaam4)
xyzzyaacy4=xyzzyaadq4*xyzzyaaaw4
if(xyzzyaacy4>30.d0)cycle
xyzzyaale4=.true.
xyzzyaadr4=exp(-xyzzyaacy4)
xyzzyaaci4=-xyzzyaadq4-xyzzyaadq4
select case (xyzzyaaaf4)
case(1)
xyzzyaadv4(1)=c_prim(xyzzyaaam4)*xyzzyaadr4
xyzzyaads4=xyzzyaadv4(1)*xyzzyaaci4
xyzzyaadw4(1)=xyzzyaaax4*xyzzyaads4
xyzzyaadw4(2)=xyzzyaaay4*xyzzyaads4
xyzzyaadw4(3)=xyzzyaaaz4*xyzzyaads4
xyzzyaadx4(1)=(1.d0+xyzzyaaci4*xyzzyaaba4)*xyzzyaads4
xyzzyaadx4(2)=(1.d0+xyzzyaaci4*xyzzyaabb4)*xyzzyaads4
xyzzyaadx4(3)=(1.d0+xyzzyaaci4*xyzzyaabc4)*xyzzyaads4
xyzzyaadx4(4)=xyzzyaaci4*xyzzyaaay4*xyzzyaadw4(1)
xyzzyaadx4(5)=xyzzyaaci4*xyzzyaaaz4*xyzzyaadw4(1)
xyzzyaadx4(6)=xyzzyaaci4*xyzzyaaaz4*xyzzyaadw4(2)
case(2)
xyzzyaads4=c_prim(xyzzyaaam4)*xyzzyaadr4
xyzzyaadt4=c_prim2(xyzzyaaam4)*xyzzyaadr4
xyzzyaadv4(1)=xyzzyaads4
xyzzyaadv4(2)=xyzzyaadt4*xyzzyaaax4
xyzzyaadv4(3)=xyzzyaadt4*xyzzyaaay4
xyzzyaadv4(4)=xyzzyaadt4*xyzzyaaaz4
xyzzyaadw4(1)=xyzzyaaci4*xyzzyaaax4
xyzzyaadw4(2)=xyzzyaaci4*xyzzyaaay4
xyzzyaadw4(3)=xyzzyaaci4*xyzzyaaaz4
xyzzyaadw4(4)=1.d0+xyzzyaadw4(1)*xyzzyaaax4
xyzzyaadw4(5)=xyzzyaadw4(1)*xyzzyaaay4
xyzzyaadw4(6)=xyzzyaadw4(1)*xyzzyaaaz4
xyzzyaadw4(8)=1.d0+xyzzyaadw4(2)*xyzzyaaay4
xyzzyaadw4(9)=xyzzyaadw4(2)*xyzzyaaaz4
xyzzyaadw4(7)=xyzzyaadw4(5)
xyzzyaadw4(10)=xyzzyaadw4(6)
xyzzyaadw4(11)=xyzzyaadw4(9)
xyzzyaadw4(12)=1.d0+xyzzyaadw4(3)*xyzzyaaaz4
xyzzyaadx4(1)=xyzzyaaci4*xyzzyaadw4(4)
xyzzyaadx4(2)=xyzzyaaci4*xyzzyaadw4(8)
xyzzyaadx4(3)=xyzzyaaci4*xyzzyaadw4(12)
xyzzyaadx4(4)=xyzzyaadw4(1)*xyzzyaadw4(2)
xyzzyaadx4(5)=xyzzyaadw4(1)*xyzzyaadw4(3)
xyzzyaadx4(6)=xyzzyaadw4(2)*xyzzyaadw4(3)
xyzzyaadx4(7)=xyzzyaadw4(1)*(xyzzyaadw4(4)+2.d0)
xyzzyaadx4(10)=xyzzyaadw4(2)*xyzzyaadw4(4)
xyzzyaadx4(13)=xyzzyaadx4(10)
xyzzyaadx4(11)=xyzzyaadw4(3)*xyzzyaadw4(4)
xyzzyaadx4(19)=xyzzyaadx4(11)
xyzzyaadx4(8)=xyzzyaadw4(1)*xyzzyaadw4(8)
xyzzyaadx4(16)=xyzzyaadx4(8)
xyzzyaadx4(14)=xyzzyaadw4(2)*(xyzzyaadw4(8)+2.d0)
xyzzyaadx4(18)=xyzzyaadw4(3)*xyzzyaadw4(8)
xyzzyaadx4(20)=xyzzyaadx4(18)
xyzzyaadx4(9)=xyzzyaadw4(1)*xyzzyaadw4(12)
xyzzyaadx4(23)=xyzzyaadx4(9)
xyzzyaadx4(15)=xyzzyaadw4(2)*xyzzyaadw4(12)
xyzzyaadx4(24)=xyzzyaadx4(15)
xyzzyaadx4(21)=xyzzyaadw4(3)*(xyzzyaadw4(12)+2.d0)
xyzzyaadx4(12)=xyzzyaadw4(1)*xyzzyaadw4(9)
xyzzyaadx4(17)=xyzzyaadx4(12)
xyzzyaadx4(22)=xyzzyaadx4(12)
xyzzyaadw4(1:3)=xyzzyaadw4(1:3)*xyzzyaads4
xyzzyaadw4(4:12)=xyzzyaadw4(4:12)*xyzzyaadt4
xyzzyaadx4(1:6)=xyzzyaadx4(1:6)*xyzzyaads4
xyzzyaadx4(7:24)=xyzzyaadx4(7:24)*xyzzyaadt4
case(3)
xyzzyaadt4=c_prim(xyzzyaaam4)*xyzzyaadr4
xyzzyaadv4(1)=xyzzyaadt4*xyzzyaaax4
xyzzyaadv4(2)=xyzzyaadt4*xyzzyaaay4
xyzzyaadv4(3)=xyzzyaadt4*xyzzyaaaz4
xyzzyaacj4=xyzzyaaci4*xyzzyaaax4
xyzzyaack4=xyzzyaaci4*xyzzyaaay4
xyzzyaacl4=xyzzyaaci4*xyzzyaaaz4
xyzzyaadw4(1)=1.d0+xyzzyaacj4*xyzzyaaax4
xyzzyaadw4(2)=xyzzyaacj4*xyzzyaaay4
xyzzyaadw4(3)=xyzzyaacj4*xyzzyaaaz4
xyzzyaadw4(5)=1.d0+xyzzyaack4*xyzzyaaay4
xyzzyaadw4(6)=xyzzyaack4*xyzzyaaaz4
xyzzyaadw4(9)=1.d0+xyzzyaacl4*xyzzyaaaz4
xyzzyaadw4(4)=xyzzyaadw4(2)
xyzzyaadw4(7)=xyzzyaadw4(3)
xyzzyaadw4(8)=xyzzyaadw4(6)
xyzzyaadx4(1)=xyzzyaacj4*(xyzzyaadw4(1)+2.d0)
xyzzyaadx4(4)=xyzzyaack4*xyzzyaadw4(1)
xyzzyaadx4(7)=xyzzyaadx4(4)
xyzzyaadx4(5)=xyzzyaacl4*xyzzyaadw4(1)
xyzzyaadx4(13)=xyzzyaadx4(5)
xyzzyaadx4(2)=xyzzyaacj4*xyzzyaadw4(5)
xyzzyaadx4(10)=xyzzyaadx4(2)
xyzzyaadx4(8)=xyzzyaack4*(xyzzyaadw4(5)+2.d0)
xyzzyaadx4(12)=xyzzyaacl4*xyzzyaadw4(5)
xyzzyaadx4(14)=xyzzyaadx4(12)
xyzzyaadx4(3)=xyzzyaacj4*xyzzyaadw4(9)
xyzzyaadx4(17)=xyzzyaadx4(3)
xyzzyaadx4(9)=xyzzyaack4*xyzzyaadw4(9)
xyzzyaadx4(18)=xyzzyaadx4(9)
xyzzyaadx4(15)=xyzzyaacl4*(xyzzyaadw4(9)+2.d0)
xyzzyaadx4(6)=xyzzyaacj4*xyzzyaadw4(6)
xyzzyaadx4(11)=xyzzyaadx4(6)
xyzzyaadx4(16)=xyzzyaadx4(6)
xyzzyaadw4(1:9)=xyzzyaadw4(1:9)*xyzzyaadt4
xyzzyaadx4(1:18)=xyzzyaadx4(1:18)*xyzzyaadt4
case(4)
xyzzyaace4=xyzzyaaba4-xyzzyaabb4
xyzzyaabg4=3.d0*xyzzyaabc4-xyzzyaaaw4
xyzzyaadv4(1)=xyzzyaabg4
xyzzyaadv4(2)=xyzzyaabf4
xyzzyaadv4(3)=xyzzyaabe4
xyzzyaadv4(4)=xyzzyaace4
xyzzyaadv4(5)=xyzzyaabd4
xyzzyaadu4=c_prim(xyzzyaaam4)*xyzzyaadr4
xyzzyaadv4(1:5)=xyzzyaadv4(1:5)*xyzzyaadu4
xyzzyaadp4=7.d0+xyzzyaaci4*xyzzyaaaw4
xyzzyaadp4=xyzzyaaci4*xyzzyaadp4
xyzzyaacj4=xyzzyaaci4*xyzzyaaax4
xyzzyaacm4=xyzzyaacj4*xyzzyaaay4
xyzzyaack4=xyzzyaaci4*xyzzyaaay4
xyzzyaacn4=xyzzyaacj4*xyzzyaaaz4
xyzzyaacl4=xyzzyaaci4*xyzzyaaaz4
xyzzyaaco4=xyzzyaack4*xyzzyaaaz4
xyzzyaacy4=1.d0+xyzzyaacj4*xyzzyaaax4
xyzzyaadf4=xyzzyaacy4+2.d0
xyzzyaacz4=1.d0+xyzzyaack4*xyzzyaaay4
xyzzyaadg4=xyzzyaacz4+2.d0
xyzzyaada4=1.d0+xyzzyaacl4*xyzzyaaaz4
xyzzyaadh4=xyzzyaada4+2.d0
xyzzyaadb4=xyzzyaaci4*xyzzyaabg4-2.d0
xyzzyaadc4=xyzzyaaci4*xyzzyaace4
xyzzyaadw4(1)=xyzzyaadb4*xyzzyaaax4
xyzzyaadw4(2)=xyzzyaadb4*xyzzyaaay4
xyzzyaadw4(3)=(xyzzyaadb4+6.d0)*xyzzyaaaz4
xyzzyaadw4(4)=xyzzyaacy4*xyzzyaaaz4
xyzzyaadw4(5)=xyzzyaacj4*xyzzyaabe4
xyzzyaadw4(6)=xyzzyaada4*xyzzyaaax4
xyzzyaadw4(7)=xyzzyaadw4(5)
xyzzyaadw4(8)=xyzzyaacz4*xyzzyaaaz4
xyzzyaadw4(9)=xyzzyaada4*xyzzyaaay4
xyzzyaadw4(10)=(2.d0+xyzzyaaci4*xyzzyaace4)*xyzzyaaax4
xyzzyaadw4(11)=(xyzzyaadc4-2.d0)*xyzzyaaay4
xyzzyaadw4(12)=xyzzyaadc4*xyzzyaaaz4
xyzzyaadw4(13)=xyzzyaacy4*xyzzyaaay4
xyzzyaadw4(14)=xyzzyaacz4*xyzzyaaax4
xyzzyaadw4(15)=xyzzyaadw4(5)
xyzzyaadw4(1:15)=xyzzyaadw4(1:15)*xyzzyaadu4
xyzzyaade4=xyzzyaaba4+xyzzyaabb4-2.d0*xyzzyaabc4
xyzzyaadx4(1)=-xyzzyaacj4*xyzzyaacj4*xyzzyaade4-xyzzyaaci4*(xyzzyaade4&
&+4.d0*xyzzyaaba4)-2.d0
xyzzyaadx4(2)=-xyzzyaack4*xyzzyaack4*xyzzyaade4-xyzzyaaci4*(xyzzyaade4&
&+4.d0*xyzzyaabb4)-2.d0
xyzzyaadx4(3)=-xyzzyaacl4*xyzzyaacl4*xyzzyaade4-xyzzyaaci4*(xyzzyaade4&
&-8.d0*xyzzyaabc4)+4.d0
xyzzyaadi4=2.d0*(1.d0+xyzzyaadq4*xyzzyaade4)
xyzzyaadx4(4)=xyzzyaacm4*(xyzzyaadi4-6.d0)
xyzzyaadx4(5)=xyzzyaacn4*xyzzyaadi4
xyzzyaadx4(6)=xyzzyaaco4*xyzzyaadi4
xyzzyaadx4(7)=xyzzyaacn4*xyzzyaadf4
xyzzyaadx4(8)=xyzzyaacn4*xyzzyaacz4
xyzzyaadx4(9)=xyzzyaacn4*xyzzyaadh4
xyzzyaadx4(10)=xyzzyaaco4*xyzzyaacy4
xyzzyaadx4(11)=(-xyzzyaacy4)*(-xyzzyaada4)
xyzzyaadx4(12)=xyzzyaacm4*xyzzyaada4
xyzzyaadx4(13)=xyzzyaadx4(10)
xyzzyaadx4(14)=xyzzyaaco4*xyzzyaadg4
xyzzyaadx4(15)=xyzzyaaco4*xyzzyaadh4
xyzzyaadx4(16)=xyzzyaadx4(8)
xyzzyaadx4(17)=xyzzyaacm4*xyzzyaada4
xyzzyaadx4(18)=(-xyzzyaacz4)*(-xyzzyaada4)
xyzzyaadx4(19)=2.d0+xyzzyaaci4*(xyzzyaacy4*xyzzyaace4+4.d0*xyzzyaaba4)
xyzzyaadx4(20)=xyzzyaaci4*(xyzzyaacz4*xyzzyaace4-4.d0*xyzzyaabb4)-2.d0
xyzzyaadx4(21)=xyzzyaaci4*xyzzyaace4*xyzzyaada4
xyzzyaadx4(22)=xyzzyaaci4*xyzzyaaci4*xyzzyaabd4*xyzzyaace4
xyzzyaadx4(23)=-2.d0*xyzzyaacn4*(xyzzyaadq4*xyzzyaace4-1.d0)
xyzzyaadx4(24)=-2.d0*xyzzyaaco4*(xyzzyaadq4*xyzzyaace4+1.d0)
xyzzyaadx4(25)=xyzzyaacm4*xyzzyaadf4
xyzzyaadx4(26)=xyzzyaacm4*xyzzyaadg4
xyzzyaadx4(27)=xyzzyaadx4(12)
xyzzyaadx4(28)=(-xyzzyaacy4)*(-xyzzyaacz4)
xyzzyaadx4(29)=xyzzyaadx4(10)
xyzzyaadx4(30)=xyzzyaadx4(8)
xyzzyaadx4(1:30)=xyzzyaadx4(1:30)*xyzzyaadu4
case(5)
xyzzyaadu4=c_prim(xyzzyaaam4)*xyzzyaadr4
xyzzyaabh4=xyzzyaaba4*xyzzyaaax4
xyzzyaabi4=xyzzyaabb4*xyzzyaaay4
xyzzyaabn4=xyzzyaaba4*xyzzyaaba4
xyzzyaabo4=xyzzyaabb4*xyzzyaabb4
xyzzyaabp4=xyzzyaabc4*xyzzyaabc4
xyzzyaabj4=xyzzyaaba4*xyzzyaaay4
xyzzyaabm4=xyzzyaaba4*xyzzyaaaz4
xyzzyaabk4=xyzzyaaax4*xyzzyaabb4
xyzzyaabl4=xyzzyaabb4*xyzzyaaaz4
xyzzyaacc4=xyzzyaabd4*xyzzyaaaz4
xyzzyaakk4=xyzzyaaba4*xyzzyaabb4
xyzzyaakl4=xyzzyaaba4*xyzzyaabc4
xyzzyaakm4=xyzzyaabb4*xyzzyaabc4
xyzzyaacq4=xyzzyaadq4*xyzzyaaba4
xyzzyaacr4=xyzzyaadq4*xyzzyaabb4
xyzzyaacs4=xyzzyaadq4*xyzzyaabc4
xyzzyaakn4=xyzzyaadq4*xyzzyaadq4
xyzzyaako4=xyzzyaadq4*xyzzyaadu4
xyzzyaakp4=xyzzyaaax4*xyzzyaadu4
xyzzyaakq4=xyzzyaaay4*xyzzyaadu4
xyzzyaakr4=xyzzyaaaz4*xyzzyaadu4
xyzzyaaks4=3.d0*xyzzyaaba4
xyzzyaakt4=3.d0*xyzzyaabb4
xyzzyaaku4=-2.d0*xyzzyaabc4
xyzzyaacy4=xyzzyaaks4+xyzzyaakt4+xyzzyaaku4
xyzzyaacz4=xyzzyaadq4*xyzzyaacy4
xyzzyaada4=-3.d0+xyzzyaacz4
xyzzyaadb4=3.d0*xyzzyaacs4
xyzzyaadc4=-1.5d0+xyzzyaadb4
xyzzyaadd4=-12.d0*xyzzyaabc4
xyzzyaade4=xyzzyaadd4+xyzzyaaks4+xyzzyaakt4
xyzzyaadf4=xyzzyaadq4*xyzzyaade4
xyzzyaadg4=-3.d0+xyzzyaadf4
xyzzyaaeo4=xyzzyaabd4*xyzzyaadg4*xyzzyaadu4
xyzzyaaep4=3.d0*xyzzyaacr4
xyzzyaakv4=6.d0*xyzzyaabc4
xyzzyaaeq4=-12.d0*xyzzyaacs4
xyzzyaaer4=12.d0+xyzzyaadf4
xyzzyaaes4=-30.d0*xyzzyaacq4
xyzzyaaet4=30.d0*xyzzyaacr4
xyzzyaaeu4=90.d0*xyzzyaacr4
xyzzyaaev4=-45.d0*xyzzyaabb4
xyzzyaakw4=-6.d0*xyzzyaaba4
xyzzyaakx4=-6.d0*xyzzyaabb4
xyzzyaaew4=xyzzyaakw4+xyzzyaakx4+4.d0*xyzzyaabc4
xyzzyaaex4=-6.d0*xyzzyaacs4
xyzzyaaey4=3.d0+xyzzyaaex4
xyzzyaaky4=4.d0*xyzzyaabp4
xyzzyaakz4=15.d0*xyzzyaaba4
xyzzyaaez4=xyzzyaakz4+xyzzyaakt4+xyzzyaaku4
xyzzyaafa4=xyzzyaadq4*xyzzyaaez4
xyzzyaafb4=xyzzyaakn4*xyzzyaaew4*xyzzyaaba4
xyzzyaafc4=-3.d0+xyzzyaafa4+xyzzyaafb4
xyzzyaafd4=xyzzyaafc4*xyzzyaakr4
xyzzyaala4=15.d0*xyzzyaabb4
xyzzyaafe4=xyzzyaala4+xyzzyaaks4+xyzzyaaku4
xyzzyaaff4=xyzzyaadq4*xyzzyaafe4
xyzzyaafg4=xyzzyaakn4*xyzzyaaew4*xyzzyaabb4
xyzzyaafh4=-3.d0+xyzzyaaff4+xyzzyaafg4
xyzzyaafi4=xyzzyaafh4*xyzzyaakr4
xyzzyaalb4=9.d0*xyzzyaaba4
xyzzyaaji4=9.d0*xyzzyaabb4
xyzzyaajj4=-14.d0*xyzzyaabc4
xyzzyaafj4=xyzzyaalb4+xyzzyaaji4+xyzzyaajj4
xyzzyaafk4=xyzzyaadq4*xyzzyaafj4
xyzzyaafl4=xyzzyaakn4*xyzzyaaew4*xyzzyaabc4
xyzzyaafm4=6.d0+xyzzyaafk4+xyzzyaafl4
xyzzyaafn4=xyzzyaafm4*xyzzyaakr4
xyzzyaajk4=24.d0*xyzzyaabc4
xyzzyaafo4=xyzzyaakw4+xyzzyaakx4+xyzzyaajk4
xyzzyaafp4=xyzzyaakn4*xyzzyaafo4*xyzzyaaba4
xyzzyaajl4=21.d0*xyzzyaaba4
xyzzyaajm4=-36.d0*xyzzyaabc4
xyzzyaafq4=xyzzyaaji4+xyzzyaajl4+xyzzyaajm4
xyzzyaafr4=xyzzyaadq4*xyzzyaafq4
xyzzyaafs4=-9.d0+xyzzyaafr4+xyzzyaafp4
xyzzyaaft4=xyzzyaafs4*xyzzyaakp4
xyzzyaafu4=xyzzyaadd4+xyzzyaala4+xyzzyaaks4
xyzzyaafv4=xyzzyaadq4*xyzzyaafu4
xyzzyaafw4=xyzzyaakn4*xyzzyaafo4*xyzzyaabb4
xyzzyaafx4=-3.d0+xyzzyaafv4+xyzzyaafw4
xyzzyaafy4=xyzzyaafx4*xyzzyaakp4
xyzzyaajn4=-60.d0*xyzzyaabc4
xyzzyaafz4=xyzzyaajn4+xyzzyaaks4+xyzzyaakt4
xyzzyaaga4=xyzzyaadq4*xyzzyaafz4
xyzzyaagb4=xyzzyaakn4*xyzzyaafo4*xyzzyaabc4
xyzzyaagc4=12.d0+xyzzyaaga4+xyzzyaagb4
xyzzyaagd4=xyzzyaagc4*xyzzyaakp4
xyzzyaage4=xyzzyaadd4+xyzzyaakz4+xyzzyaakt4
xyzzyaagf4=xyzzyaadq4*xyzzyaage4
xyzzyaagg4=-3.d0+xyzzyaafp4+xyzzyaagf4
xyzzyaagh4=xyzzyaagg4*xyzzyaakq4
xyzzyaagi4=xyzzyaadq4*xyzzyaafo4
xyzzyaagj4=-18.d0+xyzzyaagi4
xyzzyaagk4=xyzzyaacc4*xyzzyaagj4*xyzzyaako4
xyzzyaajo4=21.d0*xyzzyaabb4
xyzzyaagl4=xyzzyaalb4+xyzzyaajm4+xyzzyaajo4
xyzzyaagm4=xyzzyaadq4*xyzzyaagl4
xyzzyaagn4=-9.d0+xyzzyaafw4+xyzzyaagm4
xyzzyaago4=xyzzyaagn4*xyzzyaakq4
xyzzyaagp4=xyzzyaagc4*xyzzyaakq4
xyzzyaajp4=30.d0*xyzzyaabb4
xyzzyaajq4=-30.d0*xyzzyaaba4
xyzzyaagq4=-60.d0*xyzzyaacs4
xyzzyaalc4=60.d0*xyzzyaaba4
xyzzyaald4=-60.d0*xyzzyaabb4
xyzzyaagr4=xyzzyaalc4+xyzzyaald4
xyzzyaags4=xyzzyaakn4*xyzzyaagr4*xyzzyaabc4
xyzzyaajr4=-150.d0*xyzzyaaba4
xyzzyaagt4=xyzzyaajp4+xyzzyaajr4
xyzzyaagu4=xyzzyaadq4*xyzzyaagt4
xyzzyaajs4=60.d0*xyzzyaabn4
xyzzyaagv4=-60.d0*xyzzyaakk4
xyzzyaagw4=xyzzyaajs4+xyzzyaagv4
xyzzyaagx4=xyzzyaakn4*xyzzyaagw4
xyzzyaagy4=30.d0+xyzzyaagu4+xyzzyaagx4
xyzzyaagz4=xyzzyaagy4*xyzzyaakr4
xyzzyaajt4=150.d0*xyzzyaabb4
xyzzyaaha4=xyzzyaajq4+xyzzyaajt4
xyzzyaahb4=xyzzyaadq4*xyzzyaaha4
xyzzyaahc4=60.d0*xyzzyaakk4
xyzzyaaju4=-60.d0*xyzzyaabo4
xyzzyaahd4=xyzzyaahc4+xyzzyaaju4
xyzzyaahe4=xyzzyaakn4*xyzzyaahd4
xyzzyaahf4=-30.d0+xyzzyaahb4+xyzzyaahe4
xyzzyaahg4=xyzzyaahf4*xyzzyaakr4
xyzzyaahh4=90.d0+xyzzyaagq4
xyzzyaahi4=xyzzyaahh4*xyzzyaabb4
xyzzyaahj4=-90.d0-xyzzyaagq4
xyzzyaahk4=xyzzyaahj4*xyzzyaaba4
xyzzyaahl4=xyzzyaahi4+xyzzyaahk4
xyzzyaahm4=xyzzyaaaz4*xyzzyaahl4*xyzzyaako4
xyzzyaajv4=-60.d0*xyzzyaacq4
xyzzyaajw4=-60.d0*xyzzyaacr4
xyzzyaajx4=120.d0*xyzzyaacq4
xyzzyaahn4=-180.d0+xyzzyaajx4
xyzzyaaho4=xyzzyaacc4*xyzzyaahn4*xyzzyaako4
xyzzyaajy4=120.d0*xyzzyaacr4
xyzzyaahp4=-180.d0+xyzzyaajy4
xyzzyaahq4=xyzzyaacc4*xyzzyaahp4*xyzzyaako4
xyzzyaajz4=120.d0*xyzzyaacs4
xyzzyaahr4=-180.d0+xyzzyaajz4
xyzzyaahs4=xyzzyaacc4*xyzzyaahr4*xyzzyaako4
xyzzyaaka4=90.d0*xyzzyaabb4
xyzzyaaht4=-180.d0*xyzzyaakk4
xyzzyaahu4=xyzzyaajs4+xyzzyaaht4
xyzzyaahv4=xyzzyaakn4*xyzzyaahu4
xyzzyaahw4=-180.d0*xyzzyaacr4
xyzzyaakb4=-210.d0*xyzzyaaba4
xyzzyaakc4=270.d0*xyzzyaabb4
xyzzyaahx4=xyzzyaakb4+xyzzyaakc4
xyzzyaahy4=xyzzyaadq4*xyzzyaahx4
xyzzyaahz4=90.d0+xyzzyaahy4+xyzzyaahv4
xyzzyaaia4=xyzzyaahz4*xyzzyaakp4
xyzzyaakd4=450.d0*xyzzyaabb4
xyzzyaaib4=xyzzyaajq4+xyzzyaakd4
xyzzyaaic4=xyzzyaadq4*xyzzyaaib4
xyzzyaake4=-180.d0*xyzzyaabo4
xyzzyaaid4=xyzzyaahc4+xyzzyaake4
xyzzyaaie4=xyzzyaakn4*xyzzyaaid4
xyzzyaaif4=-90.d0+xyzzyaaic4+xyzzyaaie4
xyzzyaaig4=xyzzyaaif4*xyzzyaakp4
xyzzyaaih4=-180.d0*xyzzyaacs4
xyzzyaaii4=90.d0+xyzzyaaih4
xyzzyaaij4=xyzzyaaii4*xyzzyaabb4
xyzzyaaik4=-30.d0-xyzzyaagq4
xyzzyaail4=xyzzyaaik4*xyzzyaaba4
xyzzyaaim4=xyzzyaaij4+xyzzyaail4
xyzzyaain4=xyzzyaaax4*xyzzyaaim4*xyzzyaako4
xyzzyaaio4=30.d0+xyzzyaagq4
xyzzyaakf4=-90.d0*xyzzyaaba4
xyzzyaaip4=180.d0*xyzzyaakk4
xyzzyaaiq4=xyzzyaaju4+xyzzyaaip4
xyzzyaair4=xyzzyaakn4*xyzzyaaiq4
xyzzyaakg4=-450.d0*xyzzyaaba4
xyzzyaais4=xyzzyaajp4+xyzzyaakg4
xyzzyaait4=xyzzyaadq4*xyzzyaais4
xyzzyaakh4=180.d0*xyzzyaabn4
xyzzyaaiu4=xyzzyaagv4+xyzzyaakh4
xyzzyaaiv4=xyzzyaakn4*xyzzyaaiu4
xyzzyaaiw4=90.d0+xyzzyaait4+xyzzyaaiv4
xyzzyaaix4=xyzzyaaiw4*xyzzyaakq4
xyzzyaaki4=-270.d0*xyzzyaaba4
xyzzyaakj4=210.d0*xyzzyaabb4
xyzzyaaiy4=xyzzyaaki4+xyzzyaakj4
xyzzyaaiz4=xyzzyaadq4*xyzzyaaiy4
xyzzyaaja4=-9.d1+xyzzyaaiz4+xyzzyaair4
xyzzyaajb4=xyzzyaaja4*xyzzyaakq4
xyzzyaajc4=xyzzyaaio4*xyzzyaabb4
xyzzyaajd4=180.d0*xyzzyaacs4
xyzzyaaje4=-90.d0+xyzzyaajd4
xyzzyaajf4=xyzzyaaje4*xyzzyaaba4
xyzzyaajg4=xyzzyaajc4+xyzzyaajf4
xyzzyaajh4=xyzzyaaay4*xyzzyaajg4*xyzzyaako4
xyzzyaadv4(1)=xyzzyaabc4*xyzzyaaaz4-1.5d0*(xyzzyaabm4+xyzzyaabl4)
xyzzyaadv4(2)=6.d0*xyzzyaaax4*xyzzyaabc4-1.5d0*(xyzzyaabk4+xyzzyaabh4)
xyzzyaadv4(3)=6.d0*xyzzyaaay4*xyzzyaabc4-1.5d0*(xyzzyaabj4+xyzzyaabi4)
xyzzyaadv4(4)=15.d0*(xyzzyaabm4-xyzzyaabl4)
xyzzyaadv4(5)=30.d0*xyzzyaacc4
xyzzyaadv4(6)=-45.d0*xyzzyaabk4+15.d0*xyzzyaabh4
xyzzyaadv4(7)=45.d0*xyzzyaabj4-15.d0*xyzzyaabi4
xyzzyaadv4(1:7)=xyzzyaadv4(1:7)*xyzzyaadu4
xyzzyaadw4(1)=xyzzyaabf4*xyzzyaadu4*xyzzyaada4
xyzzyaadw4(2)=xyzzyaabe4*xyzzyaadu4*xyzzyaada4
xyzzyaadw4(3)=xyzzyaadu4*(3.d0*xyzzyaabc4-2.d0*xyzzyaadq4*xyzzyaabp4+x&
&yzzyaadc4*(xyzzyaaba4+xyzzyaabb4))
xyzzyaadw4(4)=xyzzyaadu4*((-4.5d0+xyzzyaaep4+xyzzyaaeq4)*xyzzyaaba4-1.&
&5d0*xyzzyaabb4+3.d0*xyzzyaadq4*xyzzyaabn4+xyzzyaakv4)
xyzzyaadw4(5)=xyzzyaaeo4
xyzzyaadw4(6)=xyzzyaabf4*xyzzyaaer4*xyzzyaadu4
xyzzyaadw4(7)=xyzzyaaeo4
xyzzyaadw4(8)=xyzzyaadu4*(3.d0*xyzzyaadq4*xyzzyaabo4+(-1.5d0+xyzzyaaep&
&4)*xyzzyaaba4+(-4.5d0+xyzzyaaeq4)*xyzzyaabb4+xyzzyaakv4)
xyzzyaadw4(9)=xyzzyaabe4*xyzzyaaer4*xyzzyaadu4
xyzzyaadw4(10)=xyzzyaabf4*(30.d0+xyzzyaaes4+xyzzyaaet4)*xyzzyaadu4
xyzzyaadw4(11)=xyzzyaabe4*(-30.d0+xyzzyaaes4+xyzzyaaet4)*xyzzyaadu4
xyzzyaadw4(12)=(xyzzyaaba4*(15.d0-30.d0*xyzzyaacs4)+xyzzyaabb4*(-15.d0&
&+30.d0*xyzzyaacs4))*xyzzyaadu4
xyzzyaadw4(13)=xyzzyaabe4*(30.d0+xyzzyaajv4)*xyzzyaadu4
xyzzyaadw4(14)=xyzzyaabf4*(30.d0+xyzzyaajw4)*xyzzyaadu4
xyzzyaadw4(15)=xyzzyaabd4*xyzzyaaio4*xyzzyaadu4
xyzzyaadw4(16)=xyzzyaadu4*(xyzzyaaev4+(45.d0+xyzzyaaeu4)*xyzzyaaba4-30&
&.d0*xyzzyaadq4*xyzzyaabn4)
xyzzyaadw4(17)=xyzzyaabd4*(-90.d0+xyzzyaaes4+xyzzyaaeu4)*xyzzyaadu4
xyzzyaadw4(18)=xyzzyaadq4*xyzzyaabf4*(xyzzyaajq4+xyzzyaaka4)*xyzzyaadu&
&4
xyzzyaadw4(19)=xyzzyaabd4*(90.d0+xyzzyaaet4-90.d0*xyzzyaacq4)*xyzzyaad&
&u4
xyzzyaadw4(20)=(30.d0*xyzzyaadq4*xyzzyaabo4+xyzzyaaev4+xyzzyaaba4*(45.&
&d0-90.d0*xyzzyaacr4))*xyzzyaadu4
xyzzyaadw4(21)=xyzzyaabe4*(xyzzyaakf4+xyzzyaajp4)*xyzzyaako4
xyzzyaadx4(1)=xyzzyaafd4
xyzzyaadx4(2)=xyzzyaafi4
xyzzyaadx4(3)=xyzzyaafn4
xyzzyaadx4(4)=(12.d0+xyzzyaadq4*xyzzyaaew4)*xyzzyaacc4*xyzzyaako4
xyzzyaadx4(5)=xyzzyaadu4*(xyzzyaadq4*xyzzyaaey4*xyzzyaabh4+xyzzyaaax4*&
&(-3.d0+xyzzyaakn4*(xyzzyaaky4-6.d0*xyzzyaakm4)+ xyzzyaadq4*xyzzyaakt4&
&))
xyzzyaadx4(6)=xyzzyaadu4*(xyzzyaadq4*xyzzyaaey4*xyzzyaabi4+xyzzyaaay4*&
&(-3.d0+xyzzyaakn4*(xyzzyaaky4-6.d0*xyzzyaakl4)+ xyzzyaadq4*xyzzyaaks4&
&))
xyzzyaadx4(7)=xyzzyaaft4
xyzzyaadx4(8)=xyzzyaafy4
xyzzyaadx4(9)=xyzzyaagd4
xyzzyaadx4(10)=xyzzyaagh4
xyzzyaadx4(11)=xyzzyaakr4*(12.d0+xyzzyaafp4+xyzzyaadq4*(xyzzyaadd4-15.&
&d0*xyzzyaaba4+xyzzyaakt4))
xyzzyaadx4(12)=xyzzyaagk4
xyzzyaadx4(13)=xyzzyaagh4
xyzzyaadx4(14)=xyzzyaago4
xyzzyaadx4(15)=xyzzyaagp4
xyzzyaadx4(16)=xyzzyaafy4
xyzzyaadx4(17)=xyzzyaagk4
xyzzyaadx4(18)=xyzzyaakr4*(12.d0+xyzzyaafw4+xyzzyaadq4*(xyzzyaadd4-15.&
&d0*xyzzyaabb4+xyzzyaaks4))
xyzzyaadx4(19)=xyzzyaagz4
xyzzyaadx4(20)=xyzzyaahg4
xyzzyaadx4(21)=xyzzyaahm4
xyzzyaadx4(22)=60.d0*xyzzyaacc4*xyzzyaakn4*(xyzzyaaba4-xyzzyaabb4)*xyz&
&zyaadu4
xyzzyaadx4(23)=(30.d0+xyzzyaadq4*(xyzzyaajq4+xyzzyaajp4+xyzzyaajn4)+xy&
&zzyaags4)*xyzzyaakp4
xyzzyaadx4(24)=(-30.d0+xyzzyaags4+xyzzyaadq4*(xyzzyaajq4+xyzzyaajp4+60&
&.d0*xyzzyaabc4))*xyzzyaakq4
xyzzyaadx4(25)=xyzzyaaho4
xyzzyaadx4(26)=xyzzyaahq4
xyzzyaadx4(27)=xyzzyaahs4
xyzzyaadx4(28)=(30.d0+xyzzyaajv4+xyzzyaajw4+120.d0*xyzzyaakn4*xyzzyaak&
&k4)*xyzzyaakr4
xyzzyaadx4(29)=(30.d0+xyzzyaajv4+xyzzyaagq4+120.d0*xyzzyaakn4*xyzzyaak&
&l4)*xyzzyaakq4
xyzzyaadx4(30)=(30.d0+xyzzyaajw4+xyzzyaagq4+120.d0*xyzzyaakn4*xyzzyaak&
&m4)*xyzzyaakp4
xyzzyaadx4(31)=xyzzyaaia4
xyzzyaadx4(32)=xyzzyaaig4
xyzzyaadx4(33)=xyzzyaain4
xyzzyaadx4(34)=(-90.d0+xyzzyaahv4+xyzzyaadq4*(xyzzyaaka4+90.d0*xyzzyaa&
&ba4))*xyzzyaakq4
xyzzyaadx4(35)=(xyzzyaaka4+(-90.d0+xyzzyaahw4)*xyzzyaaba4+60.d0*xyzzya&
&adq4*xyzzyaabn4)*xyzzyaaaz4*xyzzyaako4
xyzzyaadx4(36)=(180.d0+xyzzyaahw4+60.d0*xyzzyaacq4)*xyzzyaacc4*xyzzyaa&
&ko4
xyzzyaadx4(37)=xyzzyaaix4
xyzzyaadx4(38)=xyzzyaajb4
xyzzyaadx4(39)=xyzzyaajh4
xyzzyaadx4(40)=(90.d0+xyzzyaair4+xyzzyaadq4*(xyzzyaakf4-90.d0*xyzzyaab&
&b4))*xyzzyaakp4
xyzzyaadx4(41)=(xyzzyaajw4+180.d0*(xyzzyaacq4-1.d0))*xyzzyaacc4*xyzzya&
&ako4
xyzzyaadx4(42)=(-60.d0*xyzzyaadq4*xyzzyaabo4+xyzzyaaka4+xyzzyaaba4*(-9&
&0.d0+180.d0*xyzzyaacr4))*xyzzyaaaz4*xyzzyaako4
case(6)
xyzzyaacc4=xyzzyaabd4*xyzzyaaaz4
xyzzyaabn4=xyzzyaaba4*xyzzyaaba4
xyzzyaabo4=xyzzyaabb4*xyzzyaabb4
xyzzyaabp4=xyzzyaabc4*xyzzyaabc4
xyzzyaabq4=xyzzyaaba4*xyzzyaabb4
xyzzyaabr4=xyzzyaaba4*xyzzyaabc4
xyzzyaabs4=xyzzyaabb4*xyzzyaabc4
xyzzyaabt4=xyzzyaaba4*xyzzyaabf4
xyzzyaabu4=xyzzyaabd4*xyzzyaabe4
xyzzyaabv4=xyzzyaabf4*xyzzyaabc4
xyzzyaabw4=xyzzyaabd4*xyzzyaabf4
xyzzyaabx4=xyzzyaabb4*xyzzyaabe4
xyzzyaaby4=xyzzyaabe4*xyzzyaabc4
xyzzyaabz4=xyzzyaaba4*xyzzyaabd4
xyzzyaaca4=xyzzyaabd4*xyzzyaabb4
xyzzyaacb4=xyzzyaabd4*xyzzyaabc4
xyzzyaacp4=xyzzyaabn4+xyzzyaabo4
xyzzyaace4=xyzzyaaba4-xyzzyaabb4
xyzzyaacd4=xyzzyaaba4+xyzzyaabb4
xyzzyaacf4=2.d0*xyzzyaadq4
xyzzyaacg4=3.d0*xyzzyaadq4
xyzzyaacq4=xyzzyaadq4*xyzzyaaba4
xyzzyaacr4=xyzzyaadq4*xyzzyaabb4
xyzzyaacs4=xyzzyaadq4*xyzzyaabc4
xyzzyaach4=2.d0*xyzzyaacr4
xyzzyaacv4=4.d0*xyzzyaacs4
xyzzyaacw4=8.d0*xyzzyaacs4
xyzzyaacx4=6.d0*xyzzyaacr4
xyzzyaact4=xyzzyaadq4*xyzzyaabn4
xyzzyaacu4=xyzzyaadq4*xyzzyaabo4
xyzzyaacy4=xyzzyaabp4-3.d0*(xyzzyaabr4+xyzzyaabs4)
xyzzyaacz4=0.375d0*xyzzyaacp4
xyzzyaada4=0.75d0*xyzzyaabq4
xyzzyaadv4(1)=(xyzzyaacy4+xyzzyaacz4+xyzzyaada4)
xyzzyaadb4=7.5d0*(xyzzyaabt4+xyzzyaabu4)
xyzzyaadv4(2)=10.d0*xyzzyaabv4-xyzzyaadb4
xyzzyaadc4=7.5d0*(xyzzyaabw4+xyzzyaabx4)
xyzzyaadv4(3)=10.d0*xyzzyaaby4-xyzzyaadc4
xyzzyaadd4=45.d0*(xyzzyaabr4-xyzzyaabs4)
xyzzyaade4=7.5d0*(xyzzyaabo4-xyzzyaabn4)
xyzzyaadv4(4)=xyzzyaadd4+xyzzyaade4
xyzzyaadf4=15.d0*(xyzzyaabz4+xyzzyaaca4)
xyzzyaadv4(5)=90.d0*xyzzyaacb4-xyzzyaadf4
xyzzyaadg4=315.d0*xyzzyaabu4
xyzzyaadv4(6)=105.d0*xyzzyaabt4-xyzzyaadg4
xyzzyaadh4=315.d0*xyzzyaabw4
xyzzyaadv4(7)=xyzzyaadh4-105.d0*xyzzyaabx4
xyzzyaadv4(8)=105.d0*xyzzyaacp4-630.d0*xyzzyaabq4
xyzzyaadv4(9)=420.d0*(xyzzyaabz4-xyzzyaaca4)
xyzzyaadu4=c_prim(xyzzyaaam4)*xyzzyaadr4
do xyzzyaaan4=1,9
xyzzyaadv4(xyzzyaaan4)=xyzzyaadv4(xyzzyaaan4)*xyzzyaadu4
enddo
xyzzyaadp4=xyzzyaacf4*(xyzzyaacf4*xyzzyaaaw4-11.d0)
xyzzyaadi4=xyzzyaacg4*xyzzyaacp4
xyzzyaadj4=xyzzyaabc4*(24.d0+xyzzyaacw4)
xyzzyaadk4=6.d0*xyzzyaabb4*(1.d0+xyzzyaacv4)
xyzzyaadl4=6.d0*xyzzyaaba4*(xyzzyaacr4+xyzzyaacv4-1.d0)
xyzzyaadm4=-0.25d0*(xyzzyaadi4+xyzzyaadj4-xyzzyaadk4+xyzzyaadl4)
xyzzyaadw4(1)=xyzzyaaax4*xyzzyaadm4
xyzzyaadw4(2)=xyzzyaaay4*xyzzyaadm4
xyzzyaadj4=8.d0*xyzzyaabc4*(xyzzyaacs4-2.d0)
xyzzyaadk4=24.d0*xyzzyaabb4*(xyzzyaacs4-1.d0)
xyzzyaadl4=xyzzyaadl4+30.d0*xyzzyaaba4
xyzzyaadm4=xyzzyaadi4+xyzzyaadj4-xyzzyaadk4+xyzzyaadl4
xyzzyaadw4(3)=-0.25d0*xyzzyaaaz4*xyzzyaadm4
xyzzyaadj4=6.d0*xyzzyaact4-3.d0*xyzzyaabb4+4.d0*xyzzyaabc4
xyzzyaadk4=9.d0-xyzzyaacx4+xyzzyaacw4
xyzzyaadw4(4)=2.5d0*xyzzyaaaz4*(xyzzyaadj4-xyzzyaaba4*xyzzyaadk4)
xyzzyaadk4=3.d0*xyzzyaacd4-4.d0*xyzzyaabc4
xyzzyaadw4(5)=5.d0*xyzzyaacc4*(xyzzyaadq4*xyzzyaadk4-3.d0)
xyzzyaadl4=xyzzyaabc4*(12.d0-xyzzyaacw4)
xyzzyaadm4=xyzzyaacd4*(6.d0*xyzzyaacs4-3.d0)
xyzzyaadm4=2.5d0*(xyzzyaadm4+xyzzyaadl4)
xyzzyaadw4(6)=xyzzyaaax4*xyzzyaadm4
xyzzyaadw4(7)=xyzzyaadw4(5)
xyzzyaadw4(9)=xyzzyaaay4*xyzzyaadm4
xyzzyaadj4=6.d0*xyzzyaacu4-xyzzyaaba4*(3.d0-xyzzyaacx4)
xyzzyaadk4=4.d0*xyzzyaabc4-xyzzyaabb4*(9.d0+xyzzyaacw4)
xyzzyaadw4(8)=2.5d0*xyzzyaaaz4*(xyzzyaadj4+xyzzyaadk4)
xyzzyaadl4=xyzzyaact4-xyzzyaacu4
xyzzyaadm4=6.d0*(xyzzyaabc4+xyzzyaadq4*xyzzyaabs4)
xyzzyaadn4=2.d0*xyzzyaaba4*(1.d0+3.d0*xyzzyaacs4)
xyzzyaadw4(10)=15.d0*xyzzyaaax4*(xyzzyaadl4+xyzzyaadm4-xyzzyaadn4)
xyzzyaadi4=6.d0*xyzzyaabc4
xyzzyaadj4=xyzzyaadq4*(xyzzyaacd4-xyzzyaadi4)
xyzzyaadk4=2.d0*xyzzyaabb4-xyzzyaadi4
xyzzyaadw4(11)=15.d0*xyzzyaaay4*(xyzzyaadj4*xyzzyaace4+xyzzyaadk4)
xyzzyaadj4=xyzzyaadj4+6.d0
xyzzyaadw4(12)=15.d0*xyzzyaaaz4*xyzzyaace4*xyzzyaadj4
xyzzyaadw4(15)=30.d0*xyzzyaacc4*xyzzyaadj4
xyzzyaadk4=2.d0*xyzzyaact4-xyzzyaabb4+xyzzyaadi4
xyzzyaadl4=xyzzyaacf4*(xyzzyaabb4-xyzzyaadi4)-3.d0
xyzzyaadw4(13)=15.d0*xyzzyaaay4*(xyzzyaadk4+xyzzyaaba4*xyzzyaadl4)
xyzzyaadm4=2.d0*xyzzyaacu4+xyzzyaaba4*(2.d0*xyzzyaacr4-1.d0)
xyzzyaadn4=xyzzyaadi4-3.d0*xyzzyaabb4*(1.d0+4.d0*xyzzyaacs4)
xyzzyaadw4(14)=15.d0*xyzzyaaax4*(xyzzyaadm4+xyzzyaadn4)
xyzzyaadi4=105.d0*xyzzyaaaz4
xyzzyaadj4=3.d0*xyzzyaaba4*(1.d0+xyzzyaach4)
xyzzyaadj4=xyzzyaadj4-2.d0*xyzzyaact4-3.d0*xyzzyaabb4
xyzzyaadw4(16)=xyzzyaadi4*xyzzyaadj4
xyzzyaadk4=xyzzyaaba4-3.d0*xyzzyaabb4
xyzzyaadl4=1.d0-2.d0*xyzzyaacs4
xyzzyaadm4=210.d0*xyzzyaacc4
xyzzyaadw4(17)=(-xyzzyaadm4)*(3.d0+xyzzyaadq4*xyzzyaadk4)
xyzzyaadw4(18)=105.d0*xyzzyaaax4*xyzzyaadk4*xyzzyaadl4
xyzzyaadw4(19)=xyzzyaadm4*(3.d0-3.d0*xyzzyaacq4+xyzzyaacr4)
xyzzyaadn4=xyzzyaaba4*(xyzzyaacx4-3.d0)
xyzzyaadw4(20)=xyzzyaadi4*(2.d0*xyzzyaacu4-3.d0*xyzzyaabb4-xyzzyaadn4)
xyzzyaadk4=xyzzyaabb4-3.d0*xyzzyaaba4
xyzzyaadl4=2.d0*xyzzyaacs4-1.d0
xyzzyaadw4(21)=105.d0*xyzzyaaay4*xyzzyaadk4*xyzzyaadl4
xyzzyaadi4=2.d0*xyzzyaaba4*(1+3.d0*xyzzyaacr4)
xyzzyaadj4=xyzzyaact4+xyzzyaabb4*(6.d0+xyzzyaacr4)
xyzzyaadw4(22)=210.d0*xyzzyaaax4*(xyzzyaadi4-xyzzyaadj4)
xyzzyaadk4=xyzzyaabb4*(xyzzyaacr4-2.d0)
xyzzyaadl4=xyzzyaact4+6.d0*xyzzyaaba4*(1.d0-xyzzyaacr4)
xyzzyaadw4(23)=-210.d0*xyzzyaaay4*(xyzzyaadk4+xyzzyaadl4)
xyzzyaadm4=6.d0*xyzzyaabq4-xyzzyaacp4
xyzzyaadw4(24)=210.d0*xyzzyaadq4*xyzzyaaaz4*xyzzyaadm4
xyzzyaadn4=xyzzyaaba4*(3.d0+xyzzyaach4)
xyzzyaado4=2.d0*xyzzyaact4+xyzzyaabb4
xyzzyaadw4(25)=420.d0*xyzzyaaay4*(xyzzyaadn4-xyzzyaado4)
xyzzyaadl4=2.d0*xyzzyaacu4-3.d0*xyzzyaabb4
xyzzyaadm4=xyzzyaaba4*(xyzzyaach4-1.d0)
xyzzyaadw4(26)=420.d0*xyzzyaaax4*(xyzzyaadl4-xyzzyaadm4)
xyzzyaadw4(27)=840.d0*xyzzyaadq4*xyzzyaacc4*(xyzzyaaba4-xyzzyaabb4)
do xyzzyaaan4=1,27
xyzzyaadw4(xyzzyaaan4)=xyzzyaadw4(xyzzyaaan4)*xyzzyaadu4
enddo
end select
xyzzyaaap4=xyzzyaaag4+1
xyzzyaaaq4=xyzzyaaag4+xyzzyaaah4
ao_m(xyzzyaaap4:xyzzyaaaq4)=ao_m(xyzzyaaap4:xyzzyaaaq4)+xyzzyaadv4(1:x&
&yzzyaaah4)
agra1_m(xyzzyaaap4:xyzzyaaaq4)=agra1_m(xyzzyaaap4:xyzzyaaaq4)+xyzzyaad&
&w4(1:xyzzyaaai4:3)
agra2_m(xyzzyaaap4:xyzzyaaaq4)=agra2_m(xyzzyaaap4:xyzzyaaaq4)+xyzzyaad&
&w4(2:xyzzyaaai4:3)
agra3_m(xyzzyaaap4:xyzzyaaaq4)=agra3_m(xyzzyaaap4:xyzzyaaaq4)+xyzzyaad&
&w4(3:xyzzyaaai4:3)
asderiv1_m(xyzzyaaap4:xyzzyaaaq4)=asderiv1_m(xyzzyaaap4:xyzzyaaaq4)+xy&
&zzyaadx4(1:xyzzyaaaj4:6)
asderiv2_m(xyzzyaaap4:xyzzyaaaq4)=asderiv2_m(xyzzyaaap4:xyzzyaaaq4)+xy&
&zzyaadx4(2:xyzzyaaaj4:6)
asderiv3_m(xyzzyaaap4:xyzzyaaaq4)=asderiv3_m(xyzzyaaap4:xyzzyaaaq4)+xy&
&zzyaadx4(3:xyzzyaaaj4:6)
asderiv4_m(xyzzyaaap4:xyzzyaaaq4)=asderiv4_m(xyzzyaaap4:xyzzyaaaq4)+xy&
&zzyaadx4(4:xyzzyaaaj4:6)
asderiv5_m(xyzzyaaap4:xyzzyaaaq4)=asderiv5_m(xyzzyaaap4:xyzzyaaaq4)+xy&
&zzyaadx4(5:xyzzyaaaj4:6)
asderiv6_m(xyzzyaaap4:xyzzyaaaq4)=asderiv6_m(xyzzyaaap4:xyzzyaaaq4)+xy&
&zzyaadx4(6:xyzzyaaaj4:6)
enddo
if(xyzzyaale4)then
do xyzzyaaan4=1,xyzzyaaah4
xyzzyaaas4(xyzzyaaar4+xyzzyaaan4)=xyzzyaaag4+xyzzyaaan4
enddo
xyzzyaaar4=xyzzyaaar4+xyzzyaaah4
endif
enddo
enddo
if(use_gpcc)call cusp_wfdet_real(rvec,jspin,.true.,.true.,cusp_val_r,c&
&usp_grad_r,cusp_lap_r,cusp_sderivs_r)
xyzzyaaat4=gauss_offset(jspin)
xyzzyaaav4=nuc_nele(jspin)
xyzzyaaau4=xyzzyaaat4-1+xyzzyaaav4
orbval(xyzzyaaat4:xyzzyaaau4,1)=multi_ddot_s(xyzzyaaav4,xyzzyaaar4,xyz&
&zyaaas4,orbmask(xyzzyaaat4),rck(:,:,:,xyzzyaaab1),size_rck,maxb,ao_m,&
&rnorm)
orbgrad(1,xyzzyaaat4:xyzzyaaau4,1)=multi_ddot_s(xyzzyaaav4,xyzzyaaar4,&
&xyzzyaaas4,orbmask(xyzzyaaat4),rck(:,:,:,xyzzyaaab1),size_rck,maxb,ag&
&ra1_m,rnorm)
orbgrad(2,xyzzyaaat4:xyzzyaaau4,1)=multi_ddot_s(xyzzyaaav4,xyzzyaaar4,&
&xyzzyaaas4,orbmask(xyzzyaaat4),rck(:,:,:,xyzzyaaab1),size_rck,maxb,ag&
&ra2_m,rnorm)
orbgrad(3,xyzzyaaat4:xyzzyaaau4,1)=multi_ddot_s(xyzzyaaav4,xyzzyaaar4,&
&xyzzyaaas4,orbmask(xyzzyaaat4),rck(:,:,:,xyzzyaaab1),size_rck,maxb,ag&
&ra3_m,rnorm)
orbsderivs(1,xyzzyaaat4:xyzzyaaau4,1)=multi_ddot_s(xyzzyaaav4,xyzzyaaa&
&r4,xyzzyaaas4,orbmask(xyzzyaaat4),rck(:,:,:,xyzzyaaab1),size_rck,maxb&
&,asderiv1_m,rnorm)
orbsderivs(2,xyzzyaaat4:xyzzyaaau4,1)=multi_ddot_s(xyzzyaaav4,xyzzyaaa&
&r4,xyzzyaaas4,orbmask(xyzzyaaat4),rck(:,:,:,xyzzyaaab1),size_rck,maxb&
&,asderiv2_m,rnorm)
orbsderivs(3,xyzzyaaat4:xyzzyaaau4,1)=multi_ddot_s(xyzzyaaav4,xyzzyaaa&
&r4,xyzzyaaas4,orbmask(xyzzyaaat4),rck(:,:,:,xyzzyaaab1),size_rck,maxb&
&,asderiv3_m,rnorm)
orbsderivs(4,xyzzyaaat4:xyzzyaaau4,1)=multi_ddot_s(xyzzyaaav4,xyzzyaaa&
&r4,xyzzyaaas4,orbmask(xyzzyaaat4),rck(:,:,:,xyzzyaaab1),size_rck,maxb&
&,asderiv4_m,rnorm)
orbsderivs(5,xyzzyaaat4:xyzzyaaau4,1)=multi_ddot_s(xyzzyaaav4,xyzzyaaa&
&r4,xyzzyaaas4,orbmask(xyzzyaaat4),rck(:,:,:,xyzzyaaab1),size_rck,maxb&
&,asderiv5_m,rnorm)
orbsderivs(6,xyzzyaaat4:xyzzyaaau4,1)=multi_ddot_s(xyzzyaaav4,xyzzyaaa&
&r4,xyzzyaaas4,orbmask(xyzzyaaat4),rck(:,:,:,xyzzyaaab1),size_rck,maxb&
&,asderiv6_m,rnorm)
if(use_gpcc)then
do xyzzyaaan4=1,gauss_gs_norb
if(.not.orbmask(xyzzyaaan4))cycle
orbval(xyzzyaaan4,1)=orbval(xyzzyaaan4,1)+cusp_val_r(xyzzyaaan4)
orbgrad(:,xyzzyaaan4,1)=orbgrad(:,xyzzyaaan4,1)+cusp_grad_r(:,xyzzyaaa&
&n4)
orbsderivs(:,xyzzyaaan4,1)=orbsderivs(:,xyzzyaaan4,1)+cusp_sderivs_r(:&
&,xyzzyaaan4)
enddo
endif
if(excite)then
do xyzzyaaan4=1,gauss_ex_norb
xyzzyaaao4=gauss_gs_norb+xyzzyaaan4
if(.not.orbmask(xyzzyaaao4))cycle
xyzzyaaac4=full2vrt(xyzzyaaan4,jspin)
psi(xyzzyaaan4)=sum(ao_m(:)*rck_ex(:,xyzzyaaac4,jspin))*rnorm
fgra1(xyzzyaaan4)=sum(agra1_m(:)*rck_ex(:,xyzzyaaac4,jspin))*rnorm
fgra2(xyzzyaaan4)=sum(agra2_m(:)*rck_ex(:,xyzzyaaac4,jspin))*rnorm
fgra3(xyzzyaaan4)=sum(agra3_m(:)*rck_ex(:,xyzzyaaac4,jspin))*rnorm
fsderiv1(xyzzyaaan4)=sum(asderiv1_m(:)*rck_ex(:,xyzzyaaac4,jspin))*rno&
&rm
fsderiv2(xyzzyaaan4)=sum(asderiv2_m(:)*rck_ex(:,xyzzyaaac4,jspin))*rno&
&rm
fsderiv3(xyzzyaaan4)=sum(asderiv3_m(:)*rck_ex(:,xyzzyaaac4,jspin))*rno&
&rm
fsderiv4(xyzzyaaan4)=sum(asderiv4_m(:)*rck_ex(:,xyzzyaaac4,jspin))*rno&
&rm
fsderiv5(xyzzyaaan4)=sum(asderiv5_m(:)*rck_ex(:,xyzzyaaac4,jspin))*rno&
&rm
fsderiv6(xyzzyaaan4)=sum(asderiv6_m(:)*rck_ex(:,xyzzyaaac4,jspin))*rno&
&rm
if(use_gpcc)then
psi(xyzzyaaan4)=psi(xyzzyaaan4)+cusp_val_r(xyzzyaaao4)
fgra1(xyzzyaaan4)=fgra1(xyzzyaaan4)+cusp_grad_r(1,xyzzyaaao4)
fgra2(xyzzyaaan4)=fgra2(xyzzyaaan4)+cusp_grad_r(2,xyzzyaaao4)
fgra3(xyzzyaaan4)=fgra3(xyzzyaaan4)+cusp_grad_r(3,xyzzyaaao4)
fsderiv1(xyzzyaaan4)=fsderiv1(xyzzyaaan4)+cusp_sderivs_r(1,xyzzyaaao4)
fsderiv2(xyzzyaaan4)=fsderiv2(xyzzyaaan4)+cusp_sderivs_r(2,xyzzyaaao4)
fsderiv3(xyzzyaaan4)=fsderiv3(xyzzyaaan4)+cusp_sderivs_r(3,xyzzyaaao4)
fsderiv4(xyzzyaaan4)=fsderiv4(xyzzyaaan4)+cusp_sderivs_r(4,xyzzyaaao4)
fsderiv5(xyzzyaaan4)=fsderiv5(xyzzyaaan4)+cusp_sderivs_r(5,xyzzyaaao4)
fsderiv6(xyzzyaaan4)=fsderiv6(xyzzyaaan4)+cusp_sderivs_r(6,xyzzyaaao4)
endif
enddo
if(cusp_correction)then
do xyzzyaaab4=1,num_centres
if(is_ae(xyzzyaaab4))then
xyzzyaaax4=xpos_in_cell(xyzzyaaab4,1)
xyzzyaaay4=ypos_in_cell(xyzzyaaab4,1)
xyzzyaaaz4=zpos_in_cell(xyzzyaaab4,1)
xyzzyaaax4=rvec(1)-xyzzyaaax4
xyzzyaaay4=rvec(2)-xyzzyaaay4
xyzzyaaaz4=rvec(3)-xyzzyaaaz4
xyzzyaaba4=xyzzyaaax4*xyzzyaaax4
xyzzyaabb4=xyzzyaaay4*xyzzyaaay4
xyzzyaabc4=xyzzyaaaz4*xyzzyaaaz4
xyzzyaabd4=xyzzyaaax4*xyzzyaaay4
xyzzyaabf4=xyzzyaaax4*xyzzyaaaz4
xyzzyaabe4=xyzzyaaay4*xyzzyaaaz4
xyzzyaaaw4=xyzzyaaba4+xyzzyaabb4+xyzzyaabc4
do xyzzyaaan4=1,num_unique_orbitals(jspin)
xyzzyaady4=rcusp_sq(xyzzyaaan4,xyzzyaaab4,xyzzyaaac1)
if(xyzzyaaaw4<xyzzyaady4)then
if(xyzzyaaaw4/=0.d0)then
xyzzyaadz4=sqrt(xyzzyaaaw4)
xyzzyaaeg4=1.d0/xyzzyaadz4
xyzzyaaeh4=2.d0*xyzzyaaeg4
xyzzyaaed4=xyzzyaaax4*xyzzyaaeg4
xyzzyaaee4=xyzzyaaay4*xyzzyaaeg4
xyzzyaaef4=xyzzyaaaz4*xyzzyaaeg4
else
xyzzyaadz4=0.d0
xyzzyaaeg4=1.d0
xyzzyaaeh4=2.d0
xyzzyaaed4=1.d0
xyzzyaaee4=1.d0
xyzzyaaef4=1.d0
endif
xyzzyaaag1=xyzzyaaan4>nuc_nele(jspin)
if(xyzzyaaag1)then
xyzzyaaaa1=xyzzyaaan4-nuc_nele(jspin)
call wfdet_s_bf(xyzzyaadz4,xyzzyaaaw4,xyzzyaaba4,xyzzyaabb4,xyzzyaabc4&
&,xyzzyaabd4,xyzzyaabf4,xyzzyaabe4,3.d0,xyzzyaaaa1,xyzzyaaab4,jspin,1,&
&1,1,.true.,xyzzyaaab1,xyzzyaaad1,xyzzyaaae1,xyzzyaaaf1)
else
call wfdet_s_bf(xyzzyaadz4,xyzzyaaaw4,xyzzyaaba4,xyzzyaabb4,xyzzyaabc4&
&,xyzzyaabd4,xyzzyaabf4,xyzzyaabe4,3.d0,xyzzyaaan4,xyzzyaaab4,jspin,1,&
&1,1,.false.,xyzzyaaab1,xyzzyaaad1,xyzzyaaae1,xyzzyaaaf1)
endif
xyzzyaaei4=acusp(1,xyzzyaaan4,xyzzyaaab4,xyzzyaaac1)
xyzzyaaej4=acusp(2,xyzzyaaan4,xyzzyaaab4,xyzzyaaac1)
xyzzyaaek4=acusp(3,xyzzyaaan4,xyzzyaaab4,xyzzyaaac1)
xyzzyaael4=acusp(4,xyzzyaaan4,xyzzyaaab4,xyzzyaaac1)
xyzzyaaem4=acusp(5,xyzzyaaan4,xyzzyaaab4,xyzzyaaac1)
xyzzyaaea4=xyzzyaaei4+xyzzyaaej4*xyzzyaadz4
xyzzyaaeb4=xyzzyaaej4+2.d0*xyzzyaaek4*xyzzyaadz4
xyzzyaaec4=2.d0*xyzzyaaek4+6.d0*xyzzyaael4*xyzzyaadz4
xyzzyaaen4=xyzzyaadz4*xyzzyaadz4
xyzzyaaea4=xyzzyaaea4+xyzzyaaek4*xyzzyaaen4
xyzzyaaeb4=xyzzyaaeb4+3.d0*xyzzyaael4*xyzzyaaen4
xyzzyaaec4=xyzzyaaec4+12.d0*xyzzyaaem4*xyzzyaaen4
xyzzyaaen4=xyzzyaaen4*xyzzyaadz4
xyzzyaaea4=xyzzyaaea4+xyzzyaael4*xyzzyaaen4
xyzzyaaeb4=xyzzyaaeb4+4.d0*xyzzyaaem4*xyzzyaaen4
xyzzyaaen4=xyzzyaaen4*xyzzyaadz4
xyzzyaaea4=xyzzyaaea4+xyzzyaaem4*xyzzyaaen4
xyzzyaacy4=disign(xyzzyaaan4,xyzzyaaab4,xyzzyaaac1)*exp(xyzzyaaea4)+ps&
&hift(xyzzyaaan4,xyzzyaaab4,xyzzyaaac1)
xyzzyaacz4=xyzzyaacy4*xyzzyaaeb4
xyzzyaada4=(xyzzyaaeh4+xyzzyaaeb4)*xyzzyaaeb4+xyzzyaaec4
xyzzyaadb4=xyzzyaaeb4*(xyzzyaaeb4-xyzzyaaeg4)+xyzzyaaec4
xyzzyaadb4=xyzzyaadb4*xyzzyaaeg4**2
xyzzyaadc4=xyzzyaaeb4*xyzzyaaeg4
xyzzyaadd4=xyzzyaadb4*xyzzyaacy4
if(xyzzyaaag1)then
xyzzyaaac4=vrt2full(xyzzyaaaa1,jspin)
psi(xyzzyaaac4)=psi(xyzzyaaac4)-xyzzyaaad1(1)+xyzzyaacy4
fgra1(xyzzyaaac4)=fgra1(xyzzyaaac4)+(xyzzyaacz4-xyzzyaaae1(1))*xyzzyaa&
&ed4
fgra2(xyzzyaaac4)=fgra2(xyzzyaaac4)+(xyzzyaacz4-xyzzyaaae1(1))*xyzzyaa&
&ee4
fgra3(xyzzyaaac4)=fgra3(xyzzyaaac4)+(xyzzyaacz4-xyzzyaaae1(1))*xyzzyaa&
&ef4
fsderiv1(xyzzyaaac4)=fsderiv1(xyzzyaaac4)-xyzzyaaaf1(1,1)+(xyzzyaadc4+&
&xyzzyaadb4*xyzzyaaba4)*xyzzyaacy4
fsderiv2(xyzzyaaac4)=fsderiv2(xyzzyaaac4)-xyzzyaaaf1(2,1)+(xyzzyaadc4+&
&xyzzyaadb4*xyzzyaabb4)*xyzzyaacy4
fsderiv3(xyzzyaaac4)=fsderiv3(xyzzyaaac4)-xyzzyaaaf1(3,1)+(xyzzyaadc4+&
&xyzzyaadb4*xyzzyaabc4)*xyzzyaacy4
fsderiv4(xyzzyaaac4)=fsderiv4(xyzzyaaac4)-xyzzyaaaf1(4,1)+xyzzyaadd4*x&
&yzzyaabd4
fsderiv5(xyzzyaaac4)=fsderiv5(xyzzyaaac4)-xyzzyaaaf1(5,1)+xyzzyaadd4*x&
&yzzyaabf4
fsderiv6(xyzzyaaac4)=fsderiv6(xyzzyaaac4)-xyzzyaaaf1(6,1)+xyzzyaadd4*x&
&yzzyaabe4
else
xyzzyaaac4=xyzzyaaan4+gauss_offset(jspin)-1
orbval(xyzzyaaac4,1)=orbval(xyzzyaaac4,1)-xyzzyaaad1(1)+xyzzyaacy4
orbgrad(1,xyzzyaaac4,1)=orbgrad(1,xyzzyaaac4,1)+(xyzzyaacz4-xyzzyaaae1&
&(1))*xyzzyaaed4
orbgrad(2,xyzzyaaac4,1)=orbgrad(2,xyzzyaaac4,1)+(xyzzyaacz4-xyzzyaaae1&
&(1))*xyzzyaaee4
orbgrad(3,xyzzyaaac4,1)=orbgrad(3,xyzzyaaac4,1)+(xyzzyaacz4-xyzzyaaae1&
&(1))*xyzzyaaef4
orbsderivs(1,xyzzyaaac4,1)=orbsderivs(1,xyzzyaaac4,1)-xyzzyaaaf1(1,1)+&
&(xyzzyaadc4+xyzzyaadb4*xyzzyaaba4)*xyzzyaacy4
orbsderivs(2,xyzzyaaac4,1)=orbsderivs(2,xyzzyaaac4,1)-xyzzyaaaf1(2,1)+&
&(xyzzyaadc4+xyzzyaadb4*xyzzyaabb4)*xyzzyaacy4
orbsderivs(3,xyzzyaaac4,1)=orbsderivs(3,xyzzyaaac4,1)-xyzzyaaaf1(3,1)+&
&(xyzzyaadc4+xyzzyaadb4*xyzzyaabc4)*xyzzyaacy4
orbsderivs(4,xyzzyaaac4,1)=orbsderivs(4,xyzzyaaac4,1)-xyzzyaaaf1(4,1)+&
&xyzzyaadd4*xyzzyaabd4
orbsderivs(5,xyzzyaaac4,1)=orbsderivs(5,xyzzyaaac4,1)-xyzzyaaaf1(5,1)+&
&xyzzyaadd4*xyzzyaabf4
orbsderivs(6,xyzzyaaac4,1)=orbsderivs(6,xyzzyaaac4,1)-xyzzyaaaf1(6,1)+&
&xyzzyaadd4*xyzzyaabe4
endif
endif
enddo
endif
enddo
endif
do xyzzyaaan4=1,gauss_ex_norb
if(.not.orbmask(gauss_gs_norb+xyzzyaaan4))cycle
orbval(gauss_gs_norb+xyzzyaaan4,1)=psi(xyzzyaaan4)
orbgrad(1,gauss_gs_norb+xyzzyaaan4,1)=fgra1(xyzzyaaan4)
orbgrad(2,gauss_gs_norb+xyzzyaaan4,1)=fgra2(xyzzyaaan4)
orbgrad(3,gauss_gs_norb+xyzzyaaan4,1)=fgra3(xyzzyaaan4)
orbsderivs(1,gauss_gs_norb+xyzzyaaan4,1)=fsderiv1(xyzzyaaan4)
orbsderivs(2,gauss_gs_norb+xyzzyaaan4,1)=fsderiv2(xyzzyaaan4)
orbsderivs(3,gauss_gs_norb+xyzzyaaan4,1)=fsderiv3(xyzzyaaan4)
orbsderivs(4,gauss_gs_norb+xyzzyaaan4,1)=fsderiv4(xyzzyaaan4)
orbsderivs(5,gauss_gs_norb+xyzzyaaan4,1)=fsderiv5(xyzzyaaan4)
orbsderivs(6,gauss_gs_norb+xyzzyaaan4,1)=fsderiv6(xyzzyaaan4)
enddo
else
if(cusp_correction)then
do xyzzyaaab4=1,num_centres
if(is_ae(xyzzyaaab4))then
xyzzyaaax4=xpos_in_cell(xyzzyaaab4,1)
xyzzyaaay4=ypos_in_cell(xyzzyaaab4,1)
xyzzyaaaz4=zpos_in_cell(xyzzyaaab4,1)
xyzzyaaax4=rvec(1)-xyzzyaaax4
xyzzyaaay4=rvec(2)-xyzzyaaay4
xyzzyaaaz4=rvec(3)-xyzzyaaaz4
xyzzyaaba4=xyzzyaaax4*xyzzyaaax4
xyzzyaabb4=xyzzyaaay4*xyzzyaaay4
xyzzyaabc4=xyzzyaaaz4*xyzzyaaaz4
xyzzyaabd4=xyzzyaaax4*xyzzyaaay4
xyzzyaabf4=xyzzyaaax4*xyzzyaaaz4
xyzzyaabe4=xyzzyaaay4*xyzzyaaaz4
xyzzyaaaw4=xyzzyaaba4+xyzzyaabb4+xyzzyaabc4
do xyzzyaaan4=1,num_unique_orbitals(jspin)
xyzzyaady4=rcusp_sq(xyzzyaaan4,xyzzyaaab4,xyzzyaaac1)
if(xyzzyaaaw4<xyzzyaady4)then
if(xyzzyaaaw4/=0.d0)then
xyzzyaadz4=sqrt(xyzzyaaaw4)
xyzzyaaeg4=1.d0/xyzzyaadz4
xyzzyaaeh4=2.d0*xyzzyaaeg4
xyzzyaaed4=xyzzyaaax4*xyzzyaaeg4
xyzzyaaee4=xyzzyaaay4*xyzzyaaeg4
xyzzyaaef4=xyzzyaaaz4*xyzzyaaeg4
else
xyzzyaadz4=0.d0
xyzzyaaeg4=1.d0
xyzzyaaeh4=2.d0
xyzzyaaed4=1.d0
xyzzyaaee4=1.d0
xyzzyaaef4=1.d0
endif
call wfdet_s_bf(xyzzyaadz4,xyzzyaaaw4,xyzzyaaba4,xyzzyaabb4,xyzzyaabc4&
&,xyzzyaabd4,xyzzyaabf4,xyzzyaabe4,3.d0,xyzzyaaan4,xyzzyaaab4,jspin,1,&
&1,1,.false.,xyzzyaaab1,xyzzyaaad1,xyzzyaaae1,xyzzyaaaf1)
xyzzyaaei4=acusp(1,xyzzyaaan4,xyzzyaaab4,xyzzyaaac1)
xyzzyaaej4=acusp(2,xyzzyaaan4,xyzzyaaab4,xyzzyaaac1)
xyzzyaaek4=acusp(3,xyzzyaaan4,xyzzyaaab4,xyzzyaaac1)
xyzzyaael4=acusp(4,xyzzyaaan4,xyzzyaaab4,xyzzyaaac1)
xyzzyaaem4=acusp(5,xyzzyaaan4,xyzzyaaab4,xyzzyaaac1)
xyzzyaaea4=xyzzyaaei4+xyzzyaaej4*xyzzyaadz4
xyzzyaaeb4=xyzzyaaej4+2.d0*xyzzyaaek4*xyzzyaadz4
xyzzyaaec4=2.d0*xyzzyaaek4+6.d0*xyzzyaael4*xyzzyaadz4
xyzzyaaen4=xyzzyaadz4*xyzzyaadz4
xyzzyaaea4=xyzzyaaea4+xyzzyaaek4*xyzzyaaen4
xyzzyaaeb4=xyzzyaaeb4+3.d0*xyzzyaael4*xyzzyaaen4
xyzzyaaec4=xyzzyaaec4+12.d0*xyzzyaaem4*xyzzyaaen4
xyzzyaaen4=xyzzyaaen4*xyzzyaadz4
xyzzyaaea4=xyzzyaaea4+xyzzyaael4*xyzzyaaen4
xyzzyaaeb4=xyzzyaaeb4+4.d0*xyzzyaaem4*xyzzyaaen4
xyzzyaaen4=xyzzyaaen4*xyzzyaadz4
xyzzyaaea4=xyzzyaaea4+xyzzyaaem4*xyzzyaaen4
xyzzyaacy4=disign(xyzzyaaan4,xyzzyaaab4,xyzzyaaac1)*exp(xyzzyaaea4)+ps&
&hift(xyzzyaaan4,xyzzyaaab4,xyzzyaaac1)
xyzzyaacz4=xyzzyaacy4*xyzzyaaeb4
xyzzyaada4=(xyzzyaaeh4+xyzzyaaeb4)*xyzzyaaeb4+xyzzyaaec4
xyzzyaadb4=xyzzyaaeb4*(xyzzyaaeb4-xyzzyaaeg4)+xyzzyaaec4
xyzzyaadb4=xyzzyaadb4*xyzzyaaeg4**2
xyzzyaadc4=xyzzyaaeb4*xyzzyaaeg4
xyzzyaadd4=xyzzyaadb4*xyzzyaacy4
xyzzyaaac4=xyzzyaaan4+gauss_offset(jspin)-1
orbval(xyzzyaaac4,1)=orbval(xyzzyaaac4,1)-xyzzyaaad1(1)+xyzzyaacy4
orbgrad(1,xyzzyaaac4,1)=orbgrad(1,xyzzyaaac4,1)+(xyzzyaacz4-xyzzyaaae1&
&(1))*xyzzyaaed4
orbgrad(2,xyzzyaaac4,1)=orbgrad(2,xyzzyaaac4,1)+(xyzzyaacz4-xyzzyaaae1&
&(1))*xyzzyaaee4
orbgrad(3,xyzzyaaac4,1)=orbgrad(3,xyzzyaaac4,1)+(xyzzyaacz4-xyzzyaaae1&
&(1))*xyzzyaaef4
orbsderivs(1,xyzzyaaac4,1)=orbsderivs(1,xyzzyaaac4,1)-xyzzyaaaf1(1,1)+&
&(xyzzyaadc4+xyzzyaadb4*xyzzyaaba4)*xyzzyaacy4
orbsderivs(2,xyzzyaaac4,1)=orbsderivs(2,xyzzyaaac4,1)-xyzzyaaaf1(2,1)+&
&(xyzzyaadc4+xyzzyaadb4*xyzzyaabb4)*xyzzyaacy4
orbsderivs(3,xyzzyaaac4,1)=orbsderivs(3,xyzzyaaac4,1)-xyzzyaaaf1(3,1)+&
&(xyzzyaadc4+xyzzyaadb4*xyzzyaabc4)*xyzzyaacy4
orbsderivs(4,xyzzyaaac4,1)=orbsderivs(4,xyzzyaaac4,1)-xyzzyaaaf1(4,1)+&
&xyzzyaadd4*xyzzyaabd4
orbsderivs(5,xyzzyaaac4,1)=orbsderivs(5,xyzzyaaac4,1)-xyzzyaaaf1(5,1)+&
&xyzzyaadd4*xyzzyaabf4
orbsderivs(6,xyzzyaaac4,1)=orbsderivs(6,xyzzyaaac4,1)-xyzzyaaaf1(6,1)+&
&xyzzyaadd4*xyzzyaabe4
endif
enddo
endif
enddo
endif
endif
end subroutine xyzzyaaai1
end module slaarnaav
