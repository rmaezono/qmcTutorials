module slaarnaaw
use dsp
use slaarnaat
use slaarnabp
use store
use slaarnabg,  only : painv,rion,ngsgrid_minus_1,which_ion_displaced,&
&ion_displacement
use slaarnabi,      only : use_gpcc,cusp_wfdet_real
use slaarnabt, only : multi_ddot_s
use slaarnaca,     only : is_ae
use slaarnaai,  only : wfdet_s
implicit none
private
public gauss_mol_orb_eval
integer xyzzyaaaa1,xyzzyaaab1,xyzzyaaac1,xyzzyaaad1
real(dp) xyzzyaaae1(2),xyzzyaaaf1(2),xyzzyaaag1(2)
logical xyzzyaaah1
contains
subroutine gauss_mol_orb_eval(rvec,jspin,norb,orbmask,val,fsd,orbval,o&
&rbgrad,orblap)
implicit none
integer,intent(in) :: jspin,norb
real(dp),intent(in) :: rvec(3)
real(dp),intent(inout) :: orbval(norb,real1_complex2),orbgrad(3,norb,r&
&eal1_complex2),orblap(norb,real1_complex2)
logical,intent(in) :: val,fsd,orbmask(norb)
integer xyzzyaaaa2(3)
xyzzyaaac1=which_ssingle(jspin,spin_dep_in)
xyzzyaaad1=which_ssingle(jspin,spin_dep_full)
if(.not.molgscreening)then
if(.not.fsd)then
call xyzzyaaai1(rvec,jspin,norb,orbmask,orbval)
elseif(.not.val)then
call xyzzyaaaj1(rvec,jspin,norb,orbmask,orbgrad,orblap)
else
call xyzzyaaak1(rvec,jspin,norb,orbmask,orbval,orbgrad,orblap)
endif
else
xyzzyaaaa2=nint(matmul(rvec-gs_origin,painv))
xyzzyaaaa2(1)=min(xyzzyaaaa2(1),ngsgrid_minus_1)
xyzzyaaaa2(2)=min(xyzzyaaaa2(2),ngsgrid_minus_1)
xyzzyaaaa2(3)=min(xyzzyaaaa2(3),ngsgrid_minus_1)
xyzzyaaaa2(1)=max(xyzzyaaaa2(1),0)
xyzzyaaaa2(2)=max(xyzzyaaaa2(2),0)
xyzzyaaaa2(3)=max(xyzzyaaaa2(3),0)
xyzzyaaaa1=cell_map(xyzzyaaaa2(1),xyzzyaaaa2(2),xyzzyaaaa2(3))
if(.not.fsd)then
call xyzzyaaal1(rvec,jspin,norb,orbmask,orbval)
elseif(.not.val)then
call xyzzyaaam1(rvec,jspin,norb,orbmask,orbgrad,orblap)
else
call xyzzyaaan1(rvec,jspin,norb,orbmask,orbval,orbgrad,orblap)
endif
endif
if(complex_wf)then
if(val)orbval(:,2)=0.d0
if(fsd)then
orbgrad(:,:,2)=0.d0
orblap(:,2)=0.d0
endif
endif
end subroutine gauss_mol_orb_eval
subroutine xyzzyaaai1(rvec,jspin,norb,orbmask,orbval)
implicit none
integer,intent(in) :: jspin,norb
logical,intent(in) :: orbmask(norb)
real(dp),intent(in) :: rvec(3)
real(dp),intent(inout) :: orbval(norb,real1_complex2)
integer xyzzyaaaa3,xyzzyaaab3,xyzzyaaac3,xyzzyaaad3,xyzzyaaae3,xyzzyaa&
&af3,xyzzyaaag3,xyzzyaaah3,xyzzyaaai3,xyzzyaaaj3,xyzzyaaak3,xyzzyaaal3&
&,xyzzyaaam3,xyzzyaaan3,xyzzyaaao3,xyzzyaaap3,xyzzyaaaq3(num_ao),xyzzy&
&aaar3,xyzzyaaas3
logical xyzzyaaat3
real(dp) xyzzyaaau3,xyzzyaaav3,xyzzyaaaw3,xyzzyaaax3,xyzzyaaay3,xyzzya&
&aaz3,xyzzyaaba3,xyzzyaabb3,xyzzyaabc3,xyzzyaabd3,xyzzyaabe3,xyzzyaabf&
&3,xyzzyaabg3,xyzzyaabh3,xyzzyaabi3,xyzzyaabj3,xyzzyaabk3,xyzzyaabl3,x&
&yzzyaabm3,xyzzyaabn3,xyzzyaabo3,xyzzyaabp3,xyzzyaabq3,xyzzyaabr3,xyzz&
&yaabs3,xyzzyaabt3,xyzzyaabu3,xyzzyaabv3,xyzzyaabw3,xyzzyaabx3,xyzzyaa&
&by3,xyzzyaabz3,xyzzyaaca3,xyzzyaacb3,xyzzyaacc3,xyzzyaacd3,xyzzyaace3&
&,xyzzyaacf3,xyzzyaacg3,xyzzyaach3,xyzzyaaci3,xyzzyaacj3,xyzzyaack3,xy&
&zzyaacl3,xyzzyaacm3,xyzzyaacn3,xyzzyaaco3(9),xyzzyaacp3,xyzzyaacq3,xy&
&zzyaacr3,xyzzyaacs3,xyzzyaact3,xyzzyaacu3
xyzzyaaaa3=0
ao_m=0.d0
xyzzyaaap3=0
do xyzzyaaab3=1,num_centres
if(which_ion_displaced==xyzzyaaab3)then
xyzzyaaau3=xpos_in_cell(xyzzyaaab3,1)+ion_displacement(1)
xyzzyaaav3=ypos_in_cell(xyzzyaaab3,1)+ion_displacement(2)
xyzzyaaaw3=zpos_in_cell(xyzzyaaab3,1)+ion_displacement(3)
else
xyzzyaaau3=xpos_in_cell(xyzzyaaab3,1)
xyzzyaaav3=ypos_in_cell(xyzzyaaab3,1)
xyzzyaaaw3=zpos_in_cell(xyzzyaaab3,1)
endif
xyzzyaaau3=rvec(1)-xyzzyaaau3
xyzzyaaav3=rvec(2)-xyzzyaaav3
xyzzyaaaw3=rvec(3)-xyzzyaaaw3
xyzzyaaax3=xyzzyaaau3*xyzzyaaau3
xyzzyaaay3=xyzzyaaav3*xyzzyaaav3
xyzzyaaaz3=xyzzyaaaw3*xyzzyaaaw3
xyzzyaaba3=xyzzyaaax3+xyzzyaaay3+xyzzyaaaz3
xyzzyaaac3=num_shells_on_centre(xyzzyaaab3,1)
do xyzzyaaae3=1,xyzzyaaac3
xyzzyaaaa3=xyzzyaaaa3+1
xyzzyaaaf3=shell_sequence_number(xyzzyaaaa3)
xyzzyaacp3=min_exponent(xyzzyaaaf3)
xyzzyaacd3=xyzzyaacp3*xyzzyaaba3
if(xyzzyaacd3>screening_tolerance)cycle
xyzzyaaag3=shell_am(xyzzyaaaf3)
xyzzyaaah3=numao_in_shell(xyzzyaaaf3)
xyzzyaaai3=first_ao(xyzzyaaaf3)-1
xyzzyaaaj3=primitive(xyzzyaaaf3)
xyzzyaaak3=primitive(xyzzyaaaf3+1)-1
xyzzyaaat3=.false.
do xyzzyaaal3=xyzzyaaaj3,xyzzyaaak3
xyzzyaacp3=exponent(xyzzyaaal3)
xyzzyaacd3=xyzzyaacp3*xyzzyaaba3
if(xyzzyaacd3>30.d0)cycle
xyzzyaaat3=.true.
xyzzyaacq3=exp(-xyzzyaacd3)
select case (xyzzyaaag3)
case(1)
xyzzyaaco3(1)=c_prim(xyzzyaaal3)*xyzzyaacq3
case(2)
xyzzyaaco3(1)=c_prim(xyzzyaaal3)*xyzzyaacq3
xyzzyaacn3=c_prim2(xyzzyaaal3)*xyzzyaacq3
xyzzyaaco3(2)=xyzzyaacn3*xyzzyaaau3
xyzzyaaco3(3)=xyzzyaacn3*xyzzyaaav3
xyzzyaaco3(4)=xyzzyaacn3*xyzzyaaaw3
case(3)
xyzzyaacn3=c_prim(xyzzyaaal3)*xyzzyaacq3
xyzzyaaco3(1)=xyzzyaacn3*xyzzyaaau3
xyzzyaaco3(2)=xyzzyaacn3*xyzzyaaav3
xyzzyaaco3(3)=xyzzyaacn3*xyzzyaaaw3
case(4)
xyzzyaaco3(1)=3.d0*xyzzyaaaz3-xyzzyaaba3
xyzzyaaco3(2)=xyzzyaaau3*xyzzyaaaw3
xyzzyaaco3(3)=xyzzyaaav3*xyzzyaaaw3
xyzzyaaco3(4)=xyzzyaaax3-xyzzyaaay3
xyzzyaaco3(5)=xyzzyaaau3*xyzzyaaav3
xyzzyaacn3=c_prim(xyzzyaaal3)*xyzzyaacq3
do xyzzyaaam3=1,5
xyzzyaaco3(xyzzyaaam3)=xyzzyaaco3(xyzzyaaam3)*xyzzyaacn3
enddo
case(5)
xyzzyaabe3=xyzzyaaax3*xyzzyaaau3
xyzzyaabf3=xyzzyaaay3*xyzzyaaav3
xyzzyaabg3=xyzzyaaaz3*xyzzyaaaw3
xyzzyaabb3=xyzzyaaau3*xyzzyaaav3
xyzzyaabd3=xyzzyaaau3*xyzzyaaaw3
xyzzyaabc3=xyzzyaaav3*xyzzyaaaw3
xyzzyaabh3=xyzzyaabb3*xyzzyaaau3
xyzzyaabi3=xyzzyaabb3*xyzzyaaav3
xyzzyaabl3=xyzzyaabd3*xyzzyaaau3
xyzzyaabm3=xyzzyaabd3*xyzzyaaaw3
xyzzyaabj3=xyzzyaabc3*xyzzyaaav3
xyzzyaabk3=xyzzyaabc3*xyzzyaaaw3
xyzzyaaco3(1)=xyzzyaabg3-1.5d0*(xyzzyaabl3+xyzzyaabj3)
xyzzyaaco3(2)=6.d0*xyzzyaabm3-1.5d0*(xyzzyaabe3+xyzzyaabi3)
xyzzyaaco3(3)=6.d0*xyzzyaabk3-1.5d0*(xyzzyaabh3+xyzzyaabf3)
xyzzyaaco3(4)=15.d0*(xyzzyaabl3-xyzzyaabj3)
xyzzyaaco3(5)=30.d0*xyzzyaabb3*xyzzyaaaw3
xyzzyaaco3(6)=15.d0*xyzzyaabe3-45.d0*xyzzyaabi3
xyzzyaaco3(7)=45.d0*xyzzyaabh3-15.d0*xyzzyaabf3
xyzzyaacn3=c_prim(xyzzyaaal3)*xyzzyaacq3
do xyzzyaaam3=1,7
xyzzyaaco3(xyzzyaaam3)=xyzzyaaco3(xyzzyaaam3)*xyzzyaacn3
enddo
case(6)
xyzzyaabb3=xyzzyaaau3*xyzzyaaav3
xyzzyaabd3=xyzzyaaau3*xyzzyaaaw3
xyzzyaabc3=xyzzyaaav3*xyzzyaaaw3
xyzzyaabn3=xyzzyaaax3*xyzzyaaax3
xyzzyaabo3=xyzzyaaay3*xyzzyaaay3
xyzzyaabp3=xyzzyaaaz3*xyzzyaaaz3
xyzzyaabq3=xyzzyaaax3*xyzzyaaay3
xyzzyaabr3=xyzzyaaax3*xyzzyaaaz3
xyzzyaabs3=xyzzyaaay3*xyzzyaaaz3
xyzzyaabt3=xyzzyaaax3*xyzzyaabd3
xyzzyaabu3=xyzzyaabb3*xyzzyaabc3
xyzzyaabv3=xyzzyaabd3*xyzzyaaaz3
xyzzyaabw3=xyzzyaabb3*xyzzyaabd3
xyzzyaabx3=xyzzyaaay3*xyzzyaabc3
xyzzyaaby3=xyzzyaabc3*xyzzyaaaz3
xyzzyaabz3=xyzzyaaax3*xyzzyaabb3
xyzzyaaca3=xyzzyaabb3*xyzzyaaay3
xyzzyaacb3=xyzzyaabb3*xyzzyaaaz3
xyzzyaacc3=xyzzyaabn3+xyzzyaabo3
xyzzyaacd3=xyzzyaabp3-3.d0*(xyzzyaabr3+xyzzyaabs3)
xyzzyaace3=0.375d0*xyzzyaacc3
xyzzyaacf3=0.75d0*xyzzyaabq3
xyzzyaaco3(1)=(xyzzyaacd3+xyzzyaace3+xyzzyaacf3)
xyzzyaacg3=7.5d0*(xyzzyaabt3+xyzzyaabu3)
xyzzyaaco3(2)=10.d0*xyzzyaabv3-xyzzyaacg3
xyzzyaach3=7.5d0*(xyzzyaabw3+xyzzyaabx3)
xyzzyaaco3(3)=10.d0*xyzzyaaby3-xyzzyaach3
xyzzyaaci3=45.d0*(xyzzyaabr3-xyzzyaabs3)
xyzzyaacj3=7.5d0*(xyzzyaabo3-xyzzyaabn3)
xyzzyaaco3(4)=xyzzyaaci3+xyzzyaacj3
xyzzyaack3=15.d0*(xyzzyaabz3+xyzzyaaca3)
xyzzyaaco3(5)=90.d0*xyzzyaacb3-xyzzyaack3
xyzzyaacl3=315.d0*xyzzyaabu3
xyzzyaaco3(6)=105.d0*xyzzyaabt3-xyzzyaacl3
xyzzyaacm3=315.d0*xyzzyaabw3
xyzzyaaco3(7)=xyzzyaacm3-105.d0*xyzzyaabx3
xyzzyaaco3(8)=105.d0*xyzzyaacc3-630.d0*xyzzyaabq3
xyzzyaaco3(9)=420.d0*(xyzzyaabz3-xyzzyaaca3)
xyzzyaacn3=c_prim(xyzzyaaal3)*xyzzyaacq3
do xyzzyaaam3=1,9
xyzzyaaco3(xyzzyaaam3)=xyzzyaaco3(xyzzyaaam3)*xyzzyaacn3
enddo
case(11)
xyzzyaaco3(1)=c_prim(xyzzyaaal3)*xyzzyaaba3*xyzzyaacq3
case(12)
xyzzyaacn3=c_prim(xyzzyaaal3)*xyzzyaacq3
xyzzyaaco3(1)=xyzzyaacn3*xyzzyaaau3*xyzzyaaba3
xyzzyaaco3(2)=xyzzyaacn3*xyzzyaaav3*xyzzyaaba3
xyzzyaaco3(3)=xyzzyaacn3*xyzzyaaaw3*xyzzyaaba3
end select
xyzzyaaan3=xyzzyaaai3+1
xyzzyaaao3=xyzzyaaai3+xyzzyaaah3
ao_m(xyzzyaaan3:xyzzyaaao3)=ao_m(xyzzyaaan3:xyzzyaaao3)+xyzzyaaco3(1:x&
&yzzyaaah3)
enddo
if(xyzzyaaat3)then
do xyzzyaaam3=1,xyzzyaaah3
xyzzyaaaq3(xyzzyaaap3+xyzzyaaam3)=xyzzyaaai3+xyzzyaaam3
enddo
xyzzyaaap3=xyzzyaaap3+xyzzyaaah3
endif
enddo
enddo
if(use_gpcc)call cusp_wfdet_real(rvec,jspin,.true.,.false.,cusp_val_r,&
&cusp_grad_r,cusp_lap_r)
xyzzyaaar3=gauss_offset(jspin)
xyzzyaaas3=nuc_nele(jspin)
orbval(xyzzyaaar3:xyzzyaaar3-1+xyzzyaaas3,1)=multi_ddot_s(xyzzyaaas3,x&
&yzzyaaap3,xyzzyaaaq3,orbmask(xyzzyaaar3),rck(:,:,:,xyzzyaaac1),size_r&
&ck,maxb,ao_m,rnorm)
if(use_gpcc)then
do xyzzyaaam3=1,gauss_gs_norb
if(.not.orbmask(xyzzyaaam3))cycle
orbval(xyzzyaaam3,1)=orbval(xyzzyaaam3,1)+cusp_val_r(xyzzyaaam3)
enddo
endif
if(excite)then
do xyzzyaaam3=1,gauss_ex_norb
xyzzyaaad3=gauss_gs_norb+xyzzyaaam3
if(.not.orbmask(xyzzyaaad3))cycle
xyzzyaaac3=full2vrt(xyzzyaaam3,jspin)
psi(xyzzyaaam3)=sum(ao_m(:)*rck_ex(:,xyzzyaaac3,jspin))*rnorm
if(use_gpcc)psi(xyzzyaaam3)=psi(xyzzyaaam3)+cusp_val_r(xyzzyaaad3)
enddo
if(cusp_correction)then
do xyzzyaaab3=1,num_centres
if(is_ae(xyzzyaaab3))then
xyzzyaaau3=xpos_in_cell(xyzzyaaab3,1)
xyzzyaaav3=ypos_in_cell(xyzzyaaab3,1)
xyzzyaaaw3=zpos_in_cell(xyzzyaaab3,1)
xyzzyaaau3=rvec(1)-xyzzyaaau3
xyzzyaaav3=rvec(2)-xyzzyaaav3
xyzzyaaaw3=rvec(3)-xyzzyaaaw3
xyzzyaaba3=xyzzyaaau3*xyzzyaaau3+xyzzyaaav3*xyzzyaaav3+xyzzyaaaw3*xyzz&
&yaaaw3
do xyzzyaaam3=1,num_unique_orbitals(jspin)
xyzzyaacs3=rcusp_sq(xyzzyaaam3,xyzzyaaab3,xyzzyaaad1)
if(xyzzyaaba3<xyzzyaacs3)then
xyzzyaacr3=sqrt(xyzzyaaba3)
xyzzyaaah1=xyzzyaaam3>nuc_nele(jspin)
if(xyzzyaaah1)then
xyzzyaaab1=xyzzyaaam3-nuc_nele(jspin)
call wfdet_s(xyzzyaacr3,0,3.d0,xyzzyaaab1,xyzzyaaab3,jspin,1,1,1,.true&
&.,xyzzyaaac1,xyzzyaaae1,xyzzyaaag1,xyzzyaaaf1)
else
call wfdet_s(xyzzyaacr3,0,3.d0,xyzzyaaam3,xyzzyaaab3,jspin,1,1,1,.fals&
&e.,xyzzyaaac1,xyzzyaaae1,xyzzyaaag1,xyzzyaaaf1)
endif
xyzzyaact3=acusp(1,xyzzyaaam3,xyzzyaaab3,xyzzyaaad1)
xyzzyaacu3=1.d0
do xyzzyaaad3=2,5
xyzzyaacu3=xyzzyaacu3*xyzzyaacr3
xyzzyaact3=xyzzyaact3+acusp(xyzzyaaad3,xyzzyaaam3,xyzzyaaab3,xyzzyaaad&
&1)*xyzzyaacu3
enddo
if(xyzzyaaah1)then
xyzzyaaac3=vrt2full(xyzzyaaab1,jspin)
psi(xyzzyaaac3)=psi(xyzzyaaac3)-xyzzyaaae1(1)+disign(xyzzyaaam3,xyzzya&
&aab3,xyzzyaaad1)*exp(xyzzyaact3)+pshift(xyzzyaaam3,xyzzyaaab3,xyzzyaa&
&ad1)
else
xyzzyaaac3=xyzzyaaam3+gauss_offset(jspin)-1
orbval(xyzzyaaac3,1)=orbval(xyzzyaaac3,1)-xyzzyaaae1(1)+disign(xyzzyaa&
&am3,xyzzyaaab3,xyzzyaaad1)*exp(xyzzyaact3)+pshift(xyzzyaaam3,xyzzyaaa&
&b3,xyzzyaaad1)
endif
endif
enddo
endif
enddo
endif
do xyzzyaaam3=1,gauss_ex_norb
xyzzyaaad3=gauss_gs_norb+xyzzyaaam3
if(.not.orbmask(xyzzyaaad3))cycle
orbval(xyzzyaaad3,1)=psi(xyzzyaaam3)
enddo
else
if(cusp_correction)then
do xyzzyaaab3=1,num_centres
if(is_ae(xyzzyaaab3))then
xyzzyaaau3=xpos_in_cell(xyzzyaaab3,1)
xyzzyaaav3=ypos_in_cell(xyzzyaaab3,1)
xyzzyaaaw3=zpos_in_cell(xyzzyaaab3,1)
xyzzyaaau3=rvec(1)-xyzzyaaau3
xyzzyaaav3=rvec(2)-xyzzyaaav3
xyzzyaaaw3=rvec(3)-xyzzyaaaw3
xyzzyaaba3=xyzzyaaau3*xyzzyaaau3+xyzzyaaav3*xyzzyaaav3+xyzzyaaaw3*xyzz&
&yaaaw3
do xyzzyaaam3=1,num_unique_orbitals(jspin)
xyzzyaacs3=rcusp_sq(xyzzyaaam3,xyzzyaaab3,xyzzyaaad1)
if(xyzzyaaba3<xyzzyaacs3)then
xyzzyaacr3=sqrt(xyzzyaaba3)
call wfdet_s(xyzzyaacr3,0,3.d0,xyzzyaaam3,xyzzyaaab3,jspin,1,1,1,.fals&
&e.,xyzzyaaac1,xyzzyaaae1,xyzzyaaag1,xyzzyaaaf1)
xyzzyaact3=acusp(1,xyzzyaaam3,xyzzyaaab3,xyzzyaaad1)
xyzzyaacu3=1.d0
do xyzzyaaad3=2,5
xyzzyaacu3=xyzzyaacu3*xyzzyaacr3
xyzzyaact3=xyzzyaact3+acusp(xyzzyaaad3,xyzzyaaam3,xyzzyaaab3,xyzzyaaad&
&1)*xyzzyaacu3
enddo
xyzzyaaac3=xyzzyaaam3+gauss_offset(jspin)-1
orbval(xyzzyaaac3,1)=orbval(xyzzyaaac3,1)-xyzzyaaae1(1)+disign(xyzzyaa&
&am3,xyzzyaaab3,xyzzyaaad1)*exp(xyzzyaact3)+ pshift(xyzzyaaam3,xyzzyaa&
&ab3,xyzzyaaad1)
endif
enddo
endif
enddo
endif
endif
end subroutine xyzzyaaai1
subroutine xyzzyaaaj1(rvec,jspin,norb,orbmask,orbgrad,orblap)
implicit none
integer,intent(in) :: jspin,norb
real(dp),intent(in) :: rvec(3)
real(dp),intent(inout) :: orbgrad(3,norb,real1_complex2),orblap(norb,r&
&eal1_complex2)
logical,intent(in) :: orbmask(norb)
integer xyzzyaaaa4,xyzzyaaab4,xyzzyaaac4,xyzzyaaad4,xyzzyaaae4,xyzzyaa&
&af4,xyzzyaaag4,xyzzyaaah4,xyzzyaaai4,xyzzyaaaj4,xyzzyaaak4,xyzzyaaal4&
&,xyzzyaaam4,xyzzyaaan4,xyzzyaaao4,xyzzyaaap4,xyzzyaaaq4,xyzzyaaar4(nu&
&m_ao),xyzzyaaas4,xyzzyaaat4,xyzzyaaau4
real(dp) xyzzyaaav4,xyzzyaaaw4,xyzzyaaax4,xyzzyaaay4,xyzzyaaaz4,xyzzya&
&aba4,xyzzyaabb4,xyzzyaabc4,xyzzyaabd4,xyzzyaabe4,xyzzyaabf4,xyzzyaabg&
&4,xyzzyaabh4,xyzzyaabi4,xyzzyaabj4,xyzzyaabk4,xyzzyaabl4,xyzzyaabm4,x&
&yzzyaabn4,xyzzyaabo4,xyzzyaabp4,xyzzyaabq4,xyzzyaabr4,xyzzyaabs4,xyzz&
&yaabt4,xyzzyaabu4,xyzzyaabv4,xyzzyaabw4,xyzzyaabx4,xyzzyaaby4,xyzzyaa&
&bz4,xyzzyaaca4,xyzzyaacb4,xyzzyaacc4,xyzzyaacd4,xyzzyaace4,xyzzyaacf4&
&,xyzzyaacg4,xyzzyaach4,xyzzyaaci4,xyzzyaacj4,xyzzyaack4,xyzzyaacl4,xy&
&zzyaacm4,xyzzyaacn4,xyzzyaaco4,xyzzyaacp4,xyzzyaacq4,xyzzyaacr4,xyzzy&
&aacs4,xyzzyaact4,xyzzyaacu4,xyzzyaacv4,xyzzyaacw4,xyzzyaacx4,xyzzyaac&
&y4,xyzzyaacz4,xyzzyaada4,xyzzyaadb4,xyzzyaadc4,xyzzyaadd4,xyzzyaade4,&
&xyzzyaadf4,xyzzyaadg4,xyzzyaadh4,xyzzyaadi4,xyzzyaadj4,xyzzyaadk4,xyz&
&zyaadl4,xyzzyaadm4,xyzzyaadn4,xyzzyaado4,xyzzyaadp4,xyzzyaadq4,xyzzya&
&adr4(9),xyzzyaads4(9),xyzzyaadt4(27),xyzzyaadu4,xyzzyaadv4,xyzzyaadw4&
&,xyzzyaadx4,xyzzyaady4,xyzzyaadz4,xyzzyaaea4,xyzzyaaeb4,xyzzyaaec4,xy&
&zzyaaed4,xyzzyaaee4,xyzzyaaef4,xyzzyaaeg4,xyzzyaaeh4,xyzzyaaei4,xyzzy&
&aaej4
logical xyzzyaaek4
xyzzyaaaa4=0
alap_m=0.d0
agra1_m=0.d0
agra2_m=0.d0
agra3_m=0.d0
xyzzyaaaq4=0
do xyzzyaaab4=1,num_centres
if(which_ion_displaced==xyzzyaaab4)then
xyzzyaaaw4=xpos_in_cell(xyzzyaaab4,1)+ion_displacement(1)
xyzzyaaax4=ypos_in_cell(xyzzyaaab4,1)+ion_displacement(2)
xyzzyaaay4=zpos_in_cell(xyzzyaaab4,1)+ion_displacement(3)
else
xyzzyaaaw4=xpos_in_cell(xyzzyaaab4,1)
xyzzyaaax4=ypos_in_cell(xyzzyaaab4,1)
xyzzyaaay4=zpos_in_cell(xyzzyaaab4,1)
endif
xyzzyaaaw4=rvec(1)-xyzzyaaaw4
xyzzyaaax4=rvec(2)-xyzzyaaax4
xyzzyaaay4=rvec(3)-xyzzyaaay4
xyzzyaaaz4=xyzzyaaaw4*xyzzyaaaw4
xyzzyaaba4=xyzzyaaax4*xyzzyaaax4
xyzzyaabb4=xyzzyaaay4*xyzzyaaay4
xyzzyaaav4=xyzzyaaaz4+xyzzyaaba4+xyzzyaabb4
xyzzyaaac4=num_shells_on_centre(xyzzyaaab4,1)
do xyzzyaaad4=1,xyzzyaaac4
xyzzyaaaa4=xyzzyaaaa4+1
xyzzyaaae4=shell_sequence_number(xyzzyaaaa4)
xyzzyaadm4=min_exponent(xyzzyaaae4)
xyzzyaacu4=xyzzyaadm4*xyzzyaaav4
if(xyzzyaacu4>screening_tolerance)cycle
xyzzyaaaf4=shell_am(xyzzyaaae4)
xyzzyaaag4=first_ao(xyzzyaaae4)-1
xyzzyaaah4=numao_in_shell(xyzzyaaae4)
xyzzyaaai4=xyzzyaaah4*3
xyzzyaaaj4=primitive(xyzzyaaae4)
xyzzyaaak4=primitive(xyzzyaaae4+1)-1
xyzzyaaek4=.false.
do xyzzyaaal4=xyzzyaaaj4,xyzzyaaak4
xyzzyaadm4=exponent(xyzzyaaal4)
xyzzyaacu4=xyzzyaadm4*xyzzyaaav4
if(xyzzyaacu4>30.d0)cycle
xyzzyaaek4=.true.
xyzzyaadn4=exp(-xyzzyaacu4)
xyzzyaach4=-xyzzyaadm4-xyzzyaadm4
select case (xyzzyaaaf4)
case(1)
xyzzyaado4=c_prim(xyzzyaaal4)*xyzzyaadn4*xyzzyaach4
xyzzyaadt4(1)=xyzzyaaaw4*xyzzyaado4
xyzzyaadt4(2)=xyzzyaaax4*xyzzyaado4
xyzzyaadt4(3)=xyzzyaaay4*xyzzyaado4
xyzzyaacu4=3.d0+xyzzyaach4*xyzzyaaav4
xyzzyaads4(1)=xyzzyaacu4*xyzzyaado4
case(2)
xyzzyaadt4(1)=xyzzyaach4*xyzzyaaaw4
xyzzyaadt4(2)=xyzzyaach4*xyzzyaaax4
xyzzyaadt4(3)=xyzzyaach4*xyzzyaaay4
xyzzyaadt4(4)=1.d0+xyzzyaadt4(1)*xyzzyaaaw4
xyzzyaadt4(5)=xyzzyaadt4(1)*xyzzyaaax4
xyzzyaadt4(6)=xyzzyaadt4(1)*xyzzyaaay4
xyzzyaadt4(8)=1.d0+xyzzyaadt4(2)*xyzzyaaax4
xyzzyaadt4(9)=xyzzyaadt4(2)*xyzzyaaay4
xyzzyaadt4(7)=xyzzyaadt4(5)
xyzzyaadt4(10)=xyzzyaadt4(6)
xyzzyaadt4(11)=xyzzyaadt4(9)
xyzzyaadt4(12)=1.d0+xyzzyaadt4(3)*xyzzyaaay4
xyzzyaado4=c_prim(xyzzyaaal4)*xyzzyaadn4
xyzzyaadp4=c_prim2(xyzzyaaal4)*xyzzyaadn4
xyzzyaadt4(1:3)=xyzzyaadt4(1:3)*xyzzyaado4
xyzzyaadt4(4:12)=xyzzyaadt4(4:12)*xyzzyaadp4
xyzzyaacu4=3.d0+xyzzyaach4*xyzzyaaav4
xyzzyaacv4=xyzzyaach4*xyzzyaacu4
xyzzyaacw4=(xyzzyaacv4+2.d0*xyzzyaach4)*xyzzyaadp4
xyzzyaads4(1)=xyzzyaacv4*xyzzyaado4
xyzzyaads4(2)=xyzzyaacw4*xyzzyaaaw4
xyzzyaads4(3)=xyzzyaacw4*xyzzyaaax4
xyzzyaads4(4)=xyzzyaacw4*xyzzyaaay4
case(3)
xyzzyaaci4=xyzzyaach4*xyzzyaaaw4
xyzzyaacj4=xyzzyaach4*xyzzyaaax4
xyzzyaack4=xyzzyaach4*xyzzyaaay4
xyzzyaacx4=xyzzyaach4*(5+xyzzyaach4*xyzzyaaav4)
xyzzyaadt4(1)=1.d0+xyzzyaaci4*xyzzyaaaw4
xyzzyaadt4(2)=xyzzyaaci4*xyzzyaaax4
xyzzyaadt4(3)=xyzzyaaci4*xyzzyaaay4
xyzzyaadt4(5)=1.d0+xyzzyaacj4*xyzzyaaax4
xyzzyaadt4(6)=xyzzyaacj4*xyzzyaaay4
xyzzyaadt4(9)=1.d0+xyzzyaack4*xyzzyaaay4
xyzzyaadt4(4)=xyzzyaadt4(2)
xyzzyaadt4(7)=xyzzyaadt4(3)
xyzzyaadt4(8)=xyzzyaadt4(6)
xyzzyaads4(1)=xyzzyaacx4*xyzzyaaaw4
xyzzyaads4(2)=xyzzyaacx4*xyzzyaaax4
xyzzyaads4(3)=xyzzyaacx4*xyzzyaaay4
xyzzyaadp4=c_prim(xyzzyaaal4)*xyzzyaadn4
xyzzyaadt4(1:9)=xyzzyaadt4(1:9)*xyzzyaadp4
xyzzyaads4(1:3)=xyzzyaads4(1:3)*xyzzyaadp4
case(4)
xyzzyaabc4=xyzzyaaaw4*xyzzyaaax4
xyzzyaabd4=xyzzyaaax4*xyzzyaaay4
xyzzyaabe4=xyzzyaaaw4*xyzzyaaay4
xyzzyaabz4=xyzzyaaaz4-xyzzyaaba4
xyzzyaabf4=3.d0*xyzzyaabb4-xyzzyaaav4
xyzzyaaci4=xyzzyaach4*xyzzyaaaw4
xyzzyaacj4=xyzzyaach4*xyzzyaaax4
xyzzyaack4=xyzzyaach4*xyzzyaaay4
xyzzyaacu4=1.d0+xyzzyaaci4*xyzzyaaaw4
xyzzyaacv4=1.d0+xyzzyaacj4*xyzzyaaax4
xyzzyaacw4=1.d0+xyzzyaack4*xyzzyaaay4
xyzzyaacx4=xyzzyaach4*xyzzyaabf4-2.d0
xyzzyaacy4=xyzzyaach4*xyzzyaabz4
xyzzyaadt4(1)=xyzzyaacx4*xyzzyaaaw4
xyzzyaadt4(2)=xyzzyaacx4*xyzzyaaax4
xyzzyaadt4(3)=(xyzzyaacx4+6.d0)*xyzzyaaay4
xyzzyaadt4(4)=xyzzyaacu4*xyzzyaaay4
xyzzyaadt4(5)=xyzzyaaci4*xyzzyaabd4
xyzzyaadt4(6)=xyzzyaacw4*xyzzyaaaw4
xyzzyaadt4(7)=xyzzyaadt4(5)
xyzzyaadt4(8)=xyzzyaacv4*xyzzyaaay4
xyzzyaadt4(9)=xyzzyaacw4*xyzzyaaax4
xyzzyaadt4(10)=(2.d0+xyzzyaach4*xyzzyaabz4)*xyzzyaaaw4
xyzzyaadt4(11)=(xyzzyaacy4-2.d0)*xyzzyaaax4
xyzzyaadt4(12)=xyzzyaacy4*xyzzyaaay4
xyzzyaadt4(13)=xyzzyaacu4*xyzzyaaax4
xyzzyaadt4(14)=xyzzyaacv4*xyzzyaaaw4
xyzzyaadt4(15)=xyzzyaadt4(5)
xyzzyaadq4=c_prim(xyzzyaaal4)*xyzzyaadn4
xyzzyaadt4(1:15)=xyzzyaadt4(1:15)*xyzzyaadq4
xyzzyaacu4=7.d0+xyzzyaach4*xyzzyaaav4
xyzzyaacu4=xyzzyaach4*xyzzyaacu4*xyzzyaadq4
xyzzyaads4(1)=xyzzyaacu4*xyzzyaabf4
xyzzyaads4(2)=xyzzyaacu4*xyzzyaabe4
xyzzyaads4(3)=xyzzyaacu4*xyzzyaabd4
xyzzyaads4(4)=xyzzyaacu4*xyzzyaabz4
xyzzyaads4(5)=xyzzyaacu4*xyzzyaabc4
case(5)
xyzzyaabc4=xyzzyaaaw4*xyzzyaaax4
xyzzyaabe4=xyzzyaaaw4*xyzzyaaay4
xyzzyaabd4=xyzzyaaax4*xyzzyaaay4
xyzzyaabt4=xyzzyaabc4*xyzzyaaay4
xyzzyaaby4=xyzzyaaaz4+xyzzyaaba4
xyzzyaaca4=xyzzyaaba4-xyzzyaaaz4
xyzzyaacb4=2.d0*xyzzyaadm4
xyzzyaacc4=3.d0*xyzzyaadm4
xyzzyaacd4=xyzzyaacb4*xyzzyaaaz4
xyzzyaace4=xyzzyaacb4*xyzzyaaba4
xyzzyaacf4=xyzzyaacb4*xyzzyaabb4
xyzzyaacg4=4.d0*xyzzyaabb4
xyzzyaadl4=2.d0*xyzzyaadm4*xyzzyaaav4-9.d0
xyzzyaabu4=3.d0*xyzzyaaaz4
xyzzyaabv4=3.d0*xyzzyaaba4
xyzzyaacw4=xyzzyaabu4+xyzzyaabv4-(2.d0*xyzzyaabb4)
xyzzyaacv4=xyzzyaadm4*xyzzyaacw4-3.d0
xyzzyaadt4(1)=xyzzyaabe4*xyzzyaacv4
xyzzyaadt4(2)=xyzzyaabd4*xyzzyaacv4
xyzzyaads4(1)=(-xyzzyaadm4)*xyzzyaaay4*xyzzyaacw4*xyzzyaadl4
xyzzyaacw4=6.d0*xyzzyaabb4
xyzzyaacx4=xyzzyaadm4*xyzzyaacw4-3.d0
xyzzyaacy4=2.d0*xyzzyaacf4*xyzzyaabb4
xyzzyaadt4(3)=0.5d0*(xyzzyaacw4-xyzzyaacy4+xyzzyaaby4*xyzzyaacx4)
xyzzyaacz4=xyzzyaacd4*xyzzyaaaz4-xyzzyaaba4+xyzzyaacg4
xyzzyaada4=xyzzyaacb4*(xyzzyaaba4-xyzzyaacg4)-3
xyzzyaadt4(4)=1.5d0*(xyzzyaacz4+xyzzyaaaz4*xyzzyaada4)
xyzzyaada4=xyzzyaacc4*(xyzzyaaby4-xyzzyaacg4)
xyzzyaadt4(5)=xyzzyaabc4*(xyzzyaada4-3.d0)
xyzzyaadt4(6)=xyzzyaabe4*(xyzzyaada4+12.d0)
xyzzyaads4(2)=(-xyzzyaaaw4)*xyzzyaada4*xyzzyaadl4
xyzzyaadt4(7)=xyzzyaadt4(5)
xyzzyaadt4(9)=xyzzyaabd4*(xyzzyaada4+12.d0)
xyzzyaadc4=xyzzyaace4*xyzzyaaba4+xyzzyaaaz4*(xyzzyaace4-1.d0)
xyzzyaadd4=xyzzyaaba4*(3.d0+8.d0*xyzzyaadm4*xyzzyaabb4)
xyzzyaadt4(8)=1.5d0*(xyzzyaadc4-xyzzyaadd4+xyzzyaacg4)
xyzzyaads4(3)=(-xyzzyaaax4)*xyzzyaada4*xyzzyaadl4
xyzzyaade4=xyzzyaadm4*xyzzyaaca4
xyzzyaadt4(10)=30.d0*xyzzyaabe4*(xyzzyaade4+1.d0)
xyzzyaadt4(11)=30.d0*xyzzyaabd4*(xyzzyaade4-1.d0)
xyzzyaadt4(12)=15.d0*xyzzyaaca4*(xyzzyaacf4-1.d0)
xyzzyaads4(4)=-30.d0*xyzzyaaay4*xyzzyaade4*xyzzyaadl4
xyzzyaadt4(13)=30.d0*(1.d0-xyzzyaacd4)*xyzzyaabd4
xyzzyaadt4(14)=30.d0*(1.d0-xyzzyaace4)*xyzzyaabe4
xyzzyaadt4(15)=30.d0*(1.d0-xyzzyaacf4)*xyzzyaabc4
xyzzyaads4(5)=30.d0*xyzzyaacb4*xyzzyaabt4*xyzzyaadl4
xyzzyaadf4=xyzzyaabu4*(1+xyzzyaace4)
xyzzyaadg4=xyzzyaacd4*xyzzyaaaz4+xyzzyaabv4
xyzzyaadt4(16)=-15.d0*(xyzzyaadg4-xyzzyaadf4)
xyzzyaadh4=(-30.d0)*xyzzyaadm4*(xyzzyaaaz4-xyzzyaabv4)
xyzzyaadt4(17)=xyzzyaabc4*(xyzzyaadh4-90.d0)
xyzzyaadt4(18)=xyzzyaabe4*xyzzyaadh4
xyzzyaads4(6)=(-xyzzyaaaw4)*xyzzyaadh4*xyzzyaadl4
xyzzyaadi4=30.d0*xyzzyaadm4*(xyzzyaaba4-xyzzyaabu4)
xyzzyaadj4=xyzzyaaaz4*(6.d0*xyzzyaadm4*xyzzyaaba4-3.d0)
xyzzyaadk4=xyzzyaaba4*(xyzzyaace4-3.d0)
xyzzyaadt4(19)=xyzzyaabc4*(90.d0+xyzzyaadi4)
xyzzyaadt4(20)=15.d0*(xyzzyaadk4-xyzzyaadj4)
xyzzyaadt4(21)=xyzzyaabd4*xyzzyaadi4
xyzzyaads4(7)=(-xyzzyaaax4)*xyzzyaadi4*xyzzyaadl4
xyzzyaadq4=c_prim(xyzzyaaal4)*xyzzyaadn4
do xyzzyaaam4=1,21
xyzzyaadt4(xyzzyaaam4)=xyzzyaadt4(xyzzyaaam4)*xyzzyaadq4
enddo
do xyzzyaaam4=1,7
xyzzyaads4(xyzzyaaam4)=xyzzyaads4(xyzzyaaam4)*xyzzyaadq4
enddo
case(6)
xyzzyaabc4=xyzzyaaaw4*xyzzyaaax4
xyzzyaabe4=xyzzyaaaw4*xyzzyaaay4
xyzzyaabd4=xyzzyaaax4*xyzzyaaay4
xyzzyaabt4=xyzzyaabc4*xyzzyaaay4
xyzzyaabg4=xyzzyaaaz4*xyzzyaaaz4
xyzzyaabh4=xyzzyaaba4*xyzzyaaba4
xyzzyaabi4=xyzzyaabb4*xyzzyaabb4
xyzzyaabj4=xyzzyaaaz4*xyzzyaaba4
xyzzyaabk4=xyzzyaaaz4*xyzzyaabb4
xyzzyaabl4=xyzzyaaba4*xyzzyaabb4
xyzzyaabm4=xyzzyaaaz4*xyzzyaabe4
xyzzyaabn4=xyzzyaabc4*xyzzyaabd4
xyzzyaabo4=xyzzyaabe4*xyzzyaabb4
xyzzyaabp4=xyzzyaabc4*xyzzyaabe4
xyzzyaabw4=xyzzyaaba4*xyzzyaabd4
xyzzyaabq4=xyzzyaabd4*xyzzyaabb4
xyzzyaabr4=xyzzyaaaz4*xyzzyaabc4
xyzzyaabx4=xyzzyaabc4*xyzzyaaba4
xyzzyaabs4=xyzzyaabc4*xyzzyaabb4
xyzzyaacl4=xyzzyaabg4+xyzzyaabh4
xyzzyaabz4=xyzzyaaaz4-xyzzyaaba4
xyzzyaaby4=xyzzyaaaz4+xyzzyaaba4
xyzzyaacb4=2.d0*xyzzyaadm4
xyzzyaacc4=3.d0*xyzzyaadm4
xyzzyaacm4=xyzzyaadm4*xyzzyaaaz4
xyzzyaacn4=xyzzyaadm4*xyzzyaaba4
xyzzyaaco4=xyzzyaadm4*xyzzyaabb4
xyzzyaace4=2.d0*xyzzyaacn4
xyzzyaacr4=4.d0*xyzzyaaco4
xyzzyaacs4=8.d0*xyzzyaaco4
xyzzyaact4=6.d0*xyzzyaacn4
xyzzyaacp4=xyzzyaadm4*xyzzyaabg4
xyzzyaacq4=xyzzyaadm4*xyzzyaabh4
xyzzyaacu4=xyzzyaabi4-3.d0*(xyzzyaabk4+xyzzyaabl4)
xyzzyaacv4=0.375d0*xyzzyaacl4
xyzzyaacw4=0.75d0*xyzzyaabj4
xyzzyaadr4(1)=(xyzzyaacu4+xyzzyaacv4+xyzzyaacw4)
xyzzyaacx4=7.5d0*(xyzzyaabm4+xyzzyaabn4)
xyzzyaadr4(2)=10.d0*xyzzyaabo4-xyzzyaacx4
xyzzyaacy4=7.5d0*(xyzzyaabp4+xyzzyaabw4)
xyzzyaadr4(3)=10.d0*xyzzyaabq4-xyzzyaacy4
xyzzyaacz4=45.d0*(xyzzyaabk4-xyzzyaabl4)
xyzzyaada4=7.5d0*(xyzzyaabh4-xyzzyaabg4)
xyzzyaadr4(4)=xyzzyaacz4+xyzzyaada4
xyzzyaadb4=15.d0*(xyzzyaabr4+xyzzyaabx4)
xyzzyaadr4(5)=90.d0*xyzzyaabs4-xyzzyaadb4
xyzzyaadc4=315.d0*xyzzyaabn4
xyzzyaadr4(6)=105.d0*xyzzyaabm4-xyzzyaadc4
xyzzyaadd4=315.d0*xyzzyaabp4
xyzzyaadr4(7)=xyzzyaadd4-105.d0*xyzzyaabw4
xyzzyaadr4(8)=105.d0*xyzzyaacl4-630.d0*xyzzyaabj4
xyzzyaadr4(9)=420.d0*(xyzzyaabr4-xyzzyaabx4)
xyzzyaadq4=c_prim(xyzzyaaal4)*xyzzyaadn4
do xyzzyaaam4=1,9
xyzzyaadr4(xyzzyaaam4)=xyzzyaadr4(xyzzyaaam4)*xyzzyaadq4
enddo
xyzzyaadl4=xyzzyaacb4*(xyzzyaacb4*xyzzyaaav4-11.d0)
do xyzzyaaam4=1,9
xyzzyaads4(xyzzyaaam4)=xyzzyaadr4(xyzzyaaam4)*xyzzyaadl4
enddo
xyzzyaade4=xyzzyaacc4*xyzzyaacl4
xyzzyaadf4=xyzzyaabb4*(24.d0+xyzzyaacs4)
xyzzyaadg4=6.d0*xyzzyaaba4*(1.d0+xyzzyaacr4)
xyzzyaadh4=6.d0*xyzzyaaaz4*(xyzzyaacn4+xyzzyaacr4-1.d0)
xyzzyaadi4=-0.25d0*(xyzzyaade4+xyzzyaadf4-xyzzyaadg4+xyzzyaadh4)
xyzzyaadt4(1)=xyzzyaaaw4*xyzzyaadi4
xyzzyaadt4(2)=xyzzyaaax4*xyzzyaadi4
xyzzyaadf4=8.d0*xyzzyaabb4*(xyzzyaaco4-2.d0)
xyzzyaadg4=24.d0*xyzzyaaba4*(xyzzyaaco4-1.d0)
xyzzyaadh4=xyzzyaadh4+30.d0*xyzzyaaaz4
xyzzyaadi4=xyzzyaade4+xyzzyaadf4-xyzzyaadg4+xyzzyaadh4
xyzzyaadt4(3)=-0.25d0*xyzzyaaay4*xyzzyaadi4
xyzzyaadf4=6.d0*xyzzyaacp4-3.d0*xyzzyaaba4+4.d0*xyzzyaabb4
xyzzyaadg4=9.d0-xyzzyaact4+xyzzyaacs4
xyzzyaadt4(4)=2.5d0*xyzzyaaay4*(xyzzyaadf4-xyzzyaaaz4*xyzzyaadg4)
xyzzyaadg4=3.d0*xyzzyaaby4-4.d0*xyzzyaabb4
xyzzyaadt4(5)=5.d0*xyzzyaabt4*(xyzzyaadm4*xyzzyaadg4-3.d0)
xyzzyaadh4=xyzzyaabb4*(12.d0-xyzzyaacs4)
xyzzyaadi4=xyzzyaaby4*(6.d0*xyzzyaaco4-3.d0)
xyzzyaadi4=2.5d0*(xyzzyaadi4+xyzzyaadh4)
xyzzyaadt4(6)=xyzzyaaaw4*xyzzyaadi4
xyzzyaadt4(7)=xyzzyaadt4(5)
xyzzyaadt4(9)=xyzzyaaax4*xyzzyaadi4
xyzzyaadf4=6.d0*xyzzyaacq4-xyzzyaaaz4*(3.d0-xyzzyaact4)
xyzzyaadg4=4.d0*xyzzyaabb4-xyzzyaaba4*(9.d0+xyzzyaacs4)
xyzzyaadt4(8)=2.5d0*xyzzyaaay4*(xyzzyaadf4+xyzzyaadg4)
xyzzyaadh4=xyzzyaacp4-xyzzyaacq4
xyzzyaadi4=6.d0*(xyzzyaabb4+xyzzyaadm4*xyzzyaabl4)
xyzzyaadj4=2.d0*xyzzyaaaz4*(1.d0+3.d0*xyzzyaaco4)
xyzzyaadt4(10)=15.d0*xyzzyaaaw4*(xyzzyaadh4+xyzzyaadi4-xyzzyaadj4)
xyzzyaade4=6.d0*xyzzyaabb4
xyzzyaadf4=xyzzyaadm4*(xyzzyaaby4-xyzzyaade4)
xyzzyaadg4=2.d0*xyzzyaaba4-xyzzyaade4
xyzzyaadt4(11)=15.d0*xyzzyaaax4*(xyzzyaadf4*xyzzyaabz4+xyzzyaadg4)
xyzzyaadf4=xyzzyaadf4+6.d0
xyzzyaadt4(12)=15.d0*xyzzyaaay4*xyzzyaabz4*xyzzyaadf4
xyzzyaadt4(15)=30.d0*xyzzyaabt4*xyzzyaadf4
xyzzyaadg4=2.d0*xyzzyaacp4-xyzzyaaba4+xyzzyaade4
xyzzyaadh4=xyzzyaacb4*(xyzzyaaba4-xyzzyaade4)-3.d0
xyzzyaadt4(13)=15.d0*xyzzyaaax4*(xyzzyaadg4+xyzzyaaaz4*xyzzyaadh4)
xyzzyaadi4=2.d0*xyzzyaacq4+xyzzyaaaz4*(2.d0*xyzzyaacn4-1.d0)
xyzzyaadj4=xyzzyaade4-3.d0*xyzzyaaba4*(1.d0+4.d0*xyzzyaaco4)
xyzzyaadt4(14)=15.d0*xyzzyaaaw4*(xyzzyaadi4+xyzzyaadj4)
xyzzyaade4=105.d0*xyzzyaaay4
xyzzyaadf4=3.d0*xyzzyaaaz4*(1.d0+xyzzyaace4)
xyzzyaadf4=xyzzyaadf4-2.d0*xyzzyaacp4-3.d0*xyzzyaaba4
xyzzyaadt4(16)=xyzzyaade4*xyzzyaadf4
xyzzyaadg4=xyzzyaaaz4-3.d0*xyzzyaaba4
xyzzyaadh4=1.d0-2.d0*xyzzyaaco4
xyzzyaadi4=210.d0*xyzzyaabt4
xyzzyaadt4(17)=(-xyzzyaadi4)*(3.d0+xyzzyaadm4*xyzzyaadg4)
xyzzyaadt4(18)=105.d0*xyzzyaaaw4*xyzzyaadg4*xyzzyaadh4
xyzzyaadt4(19)=xyzzyaadi4*(3.d0-3.d0*xyzzyaacm4+xyzzyaacn4)
xyzzyaadj4=xyzzyaaaz4*(xyzzyaact4-3.d0)
xyzzyaadt4(20)=xyzzyaade4*(2.d0*xyzzyaacq4-3.d0*xyzzyaaba4-xyzzyaadj4)
xyzzyaadg4=xyzzyaaba4-3.d0*xyzzyaaaz4
xyzzyaadh4=2.d0*xyzzyaaco4-1.d0
xyzzyaadt4(21)=105.d0*xyzzyaaax4*xyzzyaadg4*xyzzyaadh4
xyzzyaade4=2.d0*xyzzyaaaz4*(1+3.d0*xyzzyaacn4)
xyzzyaadf4=xyzzyaacp4+xyzzyaaba4*(6.d0+xyzzyaacn4)
xyzzyaadt4(22)=210.d0*xyzzyaaaw4*(xyzzyaade4-xyzzyaadf4)
xyzzyaadg4=xyzzyaaba4*(xyzzyaacn4-2.d0)
xyzzyaadh4=xyzzyaacp4+6.d0*xyzzyaaaz4*(1.d0-xyzzyaacn4)
xyzzyaadt4(23)=-210.d0*xyzzyaaax4*(xyzzyaadg4+xyzzyaadh4)
xyzzyaadi4=6.d0*xyzzyaabj4-xyzzyaacl4
xyzzyaadt4(24)=210.d0*xyzzyaadm4*xyzzyaaay4*xyzzyaadi4
xyzzyaadj4=xyzzyaaaz4*(3.d0+xyzzyaace4)
xyzzyaadk4=2.d0*xyzzyaacp4+xyzzyaaba4
xyzzyaadt4(25)=420.d0*xyzzyaaax4*(xyzzyaadj4-xyzzyaadk4)
xyzzyaadh4=2.d0*xyzzyaacq4-3.d0*xyzzyaaba4
xyzzyaadi4=xyzzyaaaz4*(xyzzyaace4-1.d0)
xyzzyaadt4(26)=420.d0*xyzzyaaaw4*(xyzzyaadh4-xyzzyaadi4)
xyzzyaadt4(27)=840.d0*xyzzyaadm4*xyzzyaabt4*(xyzzyaaaz4-xyzzyaaba4)
do xyzzyaaam4=1,27
xyzzyaadt4(xyzzyaaam4)=xyzzyaadt4(xyzzyaaam4)*xyzzyaadq4
enddo
case(11)
xyzzyaacu4=xyzzyaaav4*xyzzyaadm4
xyzzyaado4=c_prim(xyzzyaaal4)*2*xyzzyaadn4
xyzzyaadt4(1)=xyzzyaado4*xyzzyaaaw4*(1-xyzzyaacu4)
xyzzyaadt4(2)=xyzzyaado4*xyzzyaaax4*(1-xyzzyaacu4)
xyzzyaadt4(3)=xyzzyaado4*xyzzyaaay4*(1-xyzzyaacu4)
xyzzyaads4(1)=xyzzyaado4*(3-7*xyzzyaacu4+2*xyzzyaacu4*xyzzyaacu4)
case(12)
xyzzyaadq4=c_prim(xyzzyaaal4)*xyzzyaadn4
xyzzyaacv4=xyzzyaadm4*xyzzyaaav4
xyzzyaacw4=(-2)*xyzzyaadq4*(-1+xyzzyaadm4*xyzzyaaav4)
xyzzyaadt4(1)=xyzzyaadq4*(xyzzyaaba4+xyzzyaabb4-xyzzyaaaz4*(-3+2*xyzzy&
&aacv4))
xyzzyaadt4(2)=xyzzyaacw4*xyzzyaaaw4*xyzzyaaax4
xyzzyaadt4(3)=xyzzyaacw4*xyzzyaaaw4*xyzzyaaay4
xyzzyaadt4(4)=xyzzyaacw4*xyzzyaaaw4*xyzzyaaax4
xyzzyaadt4(5)=xyzzyaadq4*(xyzzyaaaz4*(1-2*xyzzyaadm4*xyzzyaaba4)+xyzzy&
&aabb4+xyzzyaaba4*(3-2*xyzzyaadm4*(xyzzyaaba4+xyzzyaabb4)))
xyzzyaadt4(6)=xyzzyaacw4*xyzzyaaax4*xyzzyaaay4
xyzzyaadt4(7)=xyzzyaacw4*xyzzyaaaw4*xyzzyaaay4
xyzzyaadt4(8)=xyzzyaacw4*xyzzyaaax4*xyzzyaaay4
xyzzyaadt4(9)=xyzzyaadq4*(xyzzyaaaz4+xyzzyaaba4-(-3+2*xyzzyaadm4*(xyzz&
&yaaaz4+xyzzyaaba4))*xyzzyaabb4-2*xyzzyaadm4*xyzzyaabb4*xyzzyaabb4)
xyzzyaacx4=2*xyzzyaadq4*(5+xyzzyaacv4*(-9+2*xyzzyaacv4))
xyzzyaads4(1)=xyzzyaacx4*xyzzyaaaw4
xyzzyaads4(2)=xyzzyaacx4*xyzzyaaax4
xyzzyaads4(3)=xyzzyaacx4*xyzzyaaay4
end select
xyzzyaaao4=xyzzyaaag4+1
xyzzyaaap4=xyzzyaaag4+xyzzyaaah4
alap_m(xyzzyaaao4:xyzzyaaap4)=alap_m(xyzzyaaao4:xyzzyaaap4)+xyzzyaads4&
&(1:xyzzyaaah4)
agra1_m(xyzzyaaao4:xyzzyaaap4)=agra1_m(xyzzyaaao4:xyzzyaaap4)+xyzzyaad&
&t4(1:xyzzyaaai4:3)
agra2_m(xyzzyaaao4:xyzzyaaap4)=agra2_m(xyzzyaaao4:xyzzyaaap4)+xyzzyaad&
&t4(2:xyzzyaaai4:3)
agra3_m(xyzzyaaao4:xyzzyaaap4)=agra3_m(xyzzyaaao4:xyzzyaaap4)+xyzzyaad&
&t4(3:xyzzyaaai4:3)
enddo
if(xyzzyaaek4)then
do xyzzyaaam4=1,xyzzyaaah4
xyzzyaaar4(xyzzyaaaq4+xyzzyaaam4)=xyzzyaaag4+xyzzyaaam4
enddo
xyzzyaaaq4=xyzzyaaaq4+xyzzyaaah4
endif
enddo
enddo
if(use_gpcc)call cusp_wfdet_real(rvec,jspin,.false.,.true.,cusp_val_r,&
&cusp_grad_r,cusp_lap_r)
xyzzyaaas4=gauss_offset(jspin)
xyzzyaaau4=nuc_nele(jspin)
xyzzyaaat4=xyzzyaaas4-1+xyzzyaaau4
orbgrad(1,xyzzyaaas4:xyzzyaaat4,1)=multi_ddot_s(xyzzyaaau4,xyzzyaaaq4,&
&xyzzyaaar4,orbmask(xyzzyaaas4),rck(:,:,:,xyzzyaaac1),size_rck,maxb,ag&
&ra1_m,rnorm)
orbgrad(2,xyzzyaaas4:xyzzyaaat4,1)=multi_ddot_s(xyzzyaaau4,xyzzyaaaq4,&
&xyzzyaaar4,orbmask(xyzzyaaas4),rck(:,:,:,xyzzyaaac1),size_rck,maxb,ag&
&ra2_m,rnorm)
orbgrad(3,xyzzyaaas4:xyzzyaaat4,1)=multi_ddot_s(xyzzyaaau4,xyzzyaaaq4,&
&xyzzyaaar4,orbmask(xyzzyaaas4),rck(:,:,:,xyzzyaaac1),size_rck,maxb,ag&
&ra3_m,rnorm)
orblap(xyzzyaaas4:xyzzyaaat4,1)=multi_ddot_s(xyzzyaaau4,xyzzyaaaq4,xyz&
&zyaaar4,orbmask(xyzzyaaas4),rck(:,:,:,xyzzyaaac1),size_rck,maxb,alap_&
&m,rnorm)
if(use_gpcc)then
do xyzzyaaam4=1,gauss_gs_norb
if(.not.orbmask(xyzzyaaam4))cycle
orbgrad(:,xyzzyaaam4,1)=orbgrad(:,xyzzyaaam4,1)+cusp_grad_r(:,xyzzyaaa&
&m4)
orblap(xyzzyaaam4,1)=orblap(xyzzyaaam4,1)+cusp_lap_r(xyzzyaaam4)
enddo
endif
if(excite)then
do xyzzyaaam4=1,gauss_ex_norb
xyzzyaaan4=gauss_gs_norb+xyzzyaaam4
if(.not.orbmask(xyzzyaaan4))cycle
xyzzyaaac4=full2vrt(xyzzyaaam4,jspin)
flap(xyzzyaaam4)=sum(alap_m(:)*rck_ex(:,xyzzyaaac4,jspin))*rnorm
fgra1(xyzzyaaam4)=sum(agra1_m(:)*rck_ex(:,xyzzyaaac4,jspin))*rnorm
fgra2(xyzzyaaam4)=sum(agra2_m(:)*rck_ex(:,xyzzyaaac4,jspin))*rnorm
fgra3(xyzzyaaam4)=sum(agra3_m(:)*rck_ex(:,xyzzyaaac4,jspin))*rnorm
if(use_gpcc)then
flap(xyzzyaaam4)=flap(xyzzyaaam4)+cusp_lap_r(xyzzyaaan4)
fgra1(xyzzyaaam4)=fgra1(xyzzyaaam4)+cusp_grad_r(1,xyzzyaaan4)
fgra2(xyzzyaaam4)=fgra2(xyzzyaaam4)+cusp_grad_r(2,xyzzyaaan4)
fgra3(xyzzyaaam4)=fgra3(xyzzyaaam4)+cusp_grad_r(3,xyzzyaaan4)
endif
enddo
if(cusp_correction)then
do xyzzyaaab4=1,num_centres
if(is_ae(xyzzyaaab4))then
xyzzyaaaw4=xpos_in_cell(xyzzyaaab4,1)
xyzzyaaax4=ypos_in_cell(xyzzyaaab4,1)
xyzzyaaay4=zpos_in_cell(xyzzyaaab4,1)
xyzzyaaaw4=rvec(1)-xyzzyaaaw4
xyzzyaaax4=rvec(2)-xyzzyaaax4
xyzzyaaay4=rvec(3)-xyzzyaaay4
xyzzyaaav4=xyzzyaaaw4*xyzzyaaaw4+xyzzyaaax4*xyzzyaaax4+xyzzyaaay4*xyzz&
&yaaay4
do xyzzyaaam4=1,num_unique_orbitals(jspin)
xyzzyaadu4=rcusp_sq(xyzzyaaam4,xyzzyaaab4,xyzzyaaad1)
if(xyzzyaaav4<xyzzyaadu4)then
if(xyzzyaaav4/=0.d0)then
xyzzyaadv4=sqrt(xyzzyaaav4)
xyzzyaadz4=1.d0/xyzzyaadv4
xyzzyaaea4=2.d0*xyzzyaadz4
xyzzyaaeb4=xyzzyaaaw4*xyzzyaadz4
xyzzyaaec4=xyzzyaaax4*xyzzyaadz4
xyzzyaaed4=xyzzyaaay4*xyzzyaadz4
else
xyzzyaadv4=0.d0
xyzzyaaea4=2.d0
xyzzyaaeb4=1.d0
xyzzyaaec4=1.d0
xyzzyaaed4=1.d0
endif
xyzzyaaah1=xyzzyaaam4>nuc_nele(jspin)
if(xyzzyaaah1)then
xyzzyaaab1=xyzzyaaam4-nuc_nele(jspin)
call wfdet_s(xyzzyaadv4,1,3.d0,xyzzyaaab1,xyzzyaaab4,jspin,1,1,1,.true&
&.,xyzzyaaac1,xyzzyaaae1,xyzzyaaag1,xyzzyaaaf1)
else
call wfdet_s(xyzzyaadv4,1,3.d0,xyzzyaaam4,xyzzyaaab4,jspin,1,1,1,.fals&
&e.,xyzzyaaac1,xyzzyaaae1,xyzzyaaag1,xyzzyaaaf1)
endif
xyzzyaaef4=acusp(1,xyzzyaaam4,xyzzyaaab4,xyzzyaaad1)
xyzzyaaeg4=acusp(2,xyzzyaaam4,xyzzyaaab4,xyzzyaaad1)
xyzzyaaeh4=acusp(3,xyzzyaaam4,xyzzyaaab4,xyzzyaaad1)
xyzzyaaei4=acusp(4,xyzzyaaam4,xyzzyaaab4,xyzzyaaad1)
xyzzyaaej4=acusp(5,xyzzyaaam4,xyzzyaaab4,xyzzyaaad1)
xyzzyaadw4=xyzzyaaef4+xyzzyaaeg4*xyzzyaadv4
xyzzyaadx4=xyzzyaaeg4+2.d0*xyzzyaaeh4*xyzzyaadv4
xyzzyaady4=2.d0*xyzzyaaeh4+6.d0*xyzzyaaei4*xyzzyaadv4
xyzzyaaee4=xyzzyaadv4*xyzzyaadv4
xyzzyaadw4=xyzzyaadw4+xyzzyaaeh4*xyzzyaaee4
xyzzyaadx4=xyzzyaadx4+3.d0*xyzzyaaei4*xyzzyaaee4
xyzzyaady4=xyzzyaady4+12.d0*xyzzyaaej4*xyzzyaaee4
xyzzyaaee4=xyzzyaaee4*xyzzyaadv4
xyzzyaadw4=xyzzyaadw4+xyzzyaaei4*xyzzyaaee4
xyzzyaadx4=xyzzyaadx4+4.d0*xyzzyaaej4*xyzzyaaee4
xyzzyaaee4=xyzzyaaee4*xyzzyaadv4
xyzzyaadw4=xyzzyaadw4+xyzzyaaej4*xyzzyaaee4
xyzzyaacu4=disign(xyzzyaaam4,xyzzyaaab4,xyzzyaaad1)*exp(xyzzyaadw4)+ps&
&hift(xyzzyaaam4,xyzzyaaab4,xyzzyaaad1)
xyzzyaacv4=xyzzyaacu4*xyzzyaadx4
xyzzyaacw4=(xyzzyaaea4+xyzzyaadx4)*xyzzyaadx4+xyzzyaady4
if(xyzzyaaah1)then
xyzzyaaac4=vrt2full(xyzzyaaab1,jspin)
fgra1(xyzzyaaac4)=fgra1(xyzzyaaac4)+(xyzzyaacv4-xyzzyaaag1(1))*xyzzyaa&
&eb4
fgra2(xyzzyaaac4)=fgra1(xyzzyaaac4)+(xyzzyaacv4-xyzzyaaag1(1))*xyzzyaa&
&ec4
fgra3(xyzzyaaac4)=fgra1(xyzzyaaac4)+(xyzzyaacv4-xyzzyaaag1(1))*xyzzyaa&
&ed4
flap(xyzzyaaac4)=flap(xyzzyaaac4)-xyzzyaaaf1(1)+xyzzyaacu4*xyzzyaacw4
else
xyzzyaaac4=xyzzyaaam4+gauss_offset(jspin)-1
orbgrad(1,xyzzyaaac4,1)=orbgrad(1,xyzzyaaac4,1)+(xyzzyaacv4-xyzzyaaag1&
&(1))*xyzzyaaeb4
orbgrad(2,xyzzyaaac4,1)=orbgrad(2,xyzzyaaac4,1)+(xyzzyaacv4-xyzzyaaag1&
&(1))*xyzzyaaec4
orbgrad(3,xyzzyaaac4,1)=orbgrad(3,xyzzyaaac4,1)+(xyzzyaacv4-xyzzyaaag1&
&(1))*xyzzyaaed4
orblap(xyzzyaaac4,1)=orblap(xyzzyaaac4,1)-xyzzyaaaf1(1)+xyzzyaacu4*xyz&
&zyaacw4
endif
endif
enddo
endif
enddo
endif
do xyzzyaaam4=1,gauss_ex_norb
xyzzyaaan4=gauss_gs_norb+xyzzyaaam4
if(.not.orbmask(xyzzyaaan4))cycle
orbgrad(1,xyzzyaaan4,1)=fgra1(xyzzyaaam4)
orbgrad(2,xyzzyaaan4,1)=fgra2(xyzzyaaam4)
orbgrad(3,xyzzyaaan4,1)=fgra3(xyzzyaaam4)
orblap(xyzzyaaan4,1)=flap(xyzzyaaam4)
enddo
else
if(cusp_correction)then
do xyzzyaaab4=1,num_centres
if(is_ae(xyzzyaaab4))then
xyzzyaaaw4=xpos_in_cell(xyzzyaaab4,1)
xyzzyaaax4=ypos_in_cell(xyzzyaaab4,1)
xyzzyaaay4=zpos_in_cell(xyzzyaaab4,1)
xyzzyaaaw4=rvec(1)-xyzzyaaaw4
xyzzyaaax4=rvec(2)-xyzzyaaax4
xyzzyaaay4=rvec(3)-xyzzyaaay4
xyzzyaaav4=xyzzyaaaw4*xyzzyaaaw4+xyzzyaaax4*xyzzyaaax4+xyzzyaaay4*xyzz&
&yaaay4
do xyzzyaaam4=1,num_unique_orbitals(jspin)
xyzzyaadu4=rcusp_sq(xyzzyaaam4,xyzzyaaab4,xyzzyaaad1)
if(xyzzyaaav4<xyzzyaadu4)then
if(xyzzyaaav4/=0.d0)then
xyzzyaadv4=sqrt(xyzzyaaav4)
xyzzyaadz4=1.d0/xyzzyaadv4
xyzzyaaea4=2.d0*xyzzyaadz4
xyzzyaaeb4=xyzzyaaaw4*xyzzyaadz4
xyzzyaaec4=xyzzyaaax4*xyzzyaadz4
xyzzyaaed4=xyzzyaaay4*xyzzyaadz4
else
xyzzyaadv4=0.d0
xyzzyaaea4=2.d0
xyzzyaaeb4=1.d0
xyzzyaaec4=1.d0
xyzzyaaed4=1.d0
endif
call wfdet_s(xyzzyaadv4,1,3.d0,xyzzyaaam4,xyzzyaaab4,jspin,1,1,1,.fals&
&e.,xyzzyaaac1,xyzzyaaae1,xyzzyaaag1,xyzzyaaaf1)
xyzzyaaef4=acusp(1,xyzzyaaam4,xyzzyaaab4,xyzzyaaad1)
xyzzyaaeg4=acusp(2,xyzzyaaam4,xyzzyaaab4,xyzzyaaad1)
xyzzyaaeh4=acusp(3,xyzzyaaam4,xyzzyaaab4,xyzzyaaad1)
xyzzyaaei4=acusp(4,xyzzyaaam4,xyzzyaaab4,xyzzyaaad1)
xyzzyaaej4=acusp(5,xyzzyaaam4,xyzzyaaab4,xyzzyaaad1)
xyzzyaadw4=xyzzyaaef4+xyzzyaaeg4*xyzzyaadv4
xyzzyaadx4=xyzzyaaeg4+2.d0*xyzzyaaeh4*xyzzyaadv4
xyzzyaady4=2.d0*xyzzyaaeh4+6.d0*xyzzyaaei4*xyzzyaadv4
xyzzyaaee4=xyzzyaadv4*xyzzyaadv4
xyzzyaadw4=xyzzyaadw4+xyzzyaaeh4*xyzzyaaee4
xyzzyaadx4=xyzzyaadx4+3.d0*xyzzyaaei4*xyzzyaaee4
xyzzyaady4=xyzzyaady4+12.d0*xyzzyaaej4*xyzzyaaee4
xyzzyaaee4=xyzzyaaee4*xyzzyaadv4
xyzzyaadw4=xyzzyaadw4+xyzzyaaei4*xyzzyaaee4
xyzzyaadx4=xyzzyaadx4+4.d0*xyzzyaaej4*xyzzyaaee4
xyzzyaaee4=xyzzyaaee4*xyzzyaadv4
xyzzyaadw4=xyzzyaadw4+xyzzyaaej4*xyzzyaaee4
xyzzyaacu4=disign(xyzzyaaam4,xyzzyaaab4,xyzzyaaad1)*exp(xyzzyaadw4)+ps&
&hift(xyzzyaaam4,xyzzyaaab4,xyzzyaaad1)
xyzzyaacv4=xyzzyaacu4*xyzzyaadx4
xyzzyaacw4=(xyzzyaaea4+xyzzyaadx4)*xyzzyaadx4+xyzzyaady4
xyzzyaaac4=xyzzyaaam4+gauss_offset(jspin)-1
orbgrad(1,xyzzyaaac4,1)=orbgrad(1,xyzzyaaac4,1)+(xyzzyaacv4-xyzzyaaag1&
&(1))*xyzzyaaeb4
orbgrad(2,xyzzyaaac4,1)=orbgrad(2,xyzzyaaac4,1)+(xyzzyaacv4-xyzzyaaag1&
&(1))*xyzzyaaec4
orbgrad(3,xyzzyaaac4,1)=orbgrad(3,xyzzyaaac4,1)+(xyzzyaacv4-xyzzyaaag1&
&(1))*xyzzyaaed4
orblap(xyzzyaaac4,1)=orblap(xyzzyaaac4,1)-xyzzyaaaf1(1)+xyzzyaacu4*xyz&
&zyaacw4
endif
enddo
endif
enddo
endif
endif
end subroutine xyzzyaaaj1
subroutine xyzzyaaak1(rvec,jspin,norb,orbmask,orbval,orbgrad,orblap)
implicit none
integer,intent(in) :: jspin,norb
real(dp),intent(in) :: rvec(3)
real(dp),intent(inout) :: orbval(norb,real1_complex2),orbgrad(3,norb,r&
&eal1_complex2),orblap(norb,real1_complex2)
logical,intent(in) :: orbmask(norb)
integer xyzzyaaaa5,xyzzyaaab5,xyzzyaaac5,xyzzyaaad5,xyzzyaaae5,xyzzyaa&
&af5,xyzzyaaag5,xyzzyaaah5,xyzzyaaai5,xyzzyaaaj5,xyzzyaaak5,xyzzyaaal5&
&,xyzzyaaam5,xyzzyaaan5,xyzzyaaao5,xyzzyaaap5,xyzzyaaaq5,xyzzyaaar5(nu&
&m_ao),xyzzyaaas5,xyzzyaaat5,xyzzyaaau5
real(dp) xyzzyaaav5,xyzzyaaaw5,xyzzyaaax5,xyzzyaaay5,xyzzyaaaz5,xyzzya&
&aba5,xyzzyaabb5,xyzzyaabc5,xyzzyaabd5,xyzzyaabe5,xyzzyaabf5,xyzzyaabg&
&5,xyzzyaabh5,xyzzyaabi5,xyzzyaabj5,xyzzyaabk5,xyzzyaabl5,xyzzyaabm5,x&
&yzzyaabn5,xyzzyaabo5,xyzzyaabp5,xyzzyaabq5,xyzzyaabr5,xyzzyaabs5,xyzz&
&yaabt5,xyzzyaabu5,xyzzyaabv5,xyzzyaabw5,xyzzyaabx5,xyzzyaaby5,xyzzyaa&
&bz5,xyzzyaaca5,xyzzyaacb5,xyzzyaacc5,xyzzyaacd5,xyzzyaace5,xyzzyaacf5&
&,xyzzyaacg5,xyzzyaach5,xyzzyaaci5,xyzzyaacj5,xyzzyaack5,xyzzyaacl5,xy&
&zzyaacm5,xyzzyaacn5,xyzzyaaco5,xyzzyaacp5,xyzzyaacq5,xyzzyaacr5,xyzzy&
&aacs5,xyzzyaact5,xyzzyaacu5,xyzzyaacv5,xyzzyaacw5,xyzzyaacx5,xyzzyaac&
&y5,xyzzyaacz5,xyzzyaada5,xyzzyaadb5,xyzzyaadc5,xyzzyaadd5,xyzzyaade5,&
&xyzzyaadf5,xyzzyaadg5,xyzzyaadh5,xyzzyaadi5,xyzzyaadj5,xyzzyaadk5,xyz&
&zyaadl5,xyzzyaadm5,xyzzyaadn5,xyzzyaado5,xyzzyaadp5,xyzzyaadq5,xyzzya&
&adr5,xyzzyaads5,xyzzyaadt5,xyzzyaadu5,xyzzyaadv5,xyzzyaadw5,xyzzyaadx&
&5,xyzzyaady5,xyzzyaadz5,xyzzyaaea5(9),xyzzyaaeb5(9),xyzzyaaec5(27),xy&
&zzyaaed5,xyzzyaaee5,xyzzyaaef5,xyzzyaaeg5,xyzzyaaeh5,xyzzyaaei5,xyzzy&
&aaej5,xyzzyaaek5,xyzzyaael5,xyzzyaaem5,xyzzyaaen5,xyzzyaaeo5,xyzzyaae&
&p5,xyzzyaaeq5,xyzzyaaer5,xyzzyaaes5
logical xyzzyaaet5
xyzzyaaaa5=0
ao_m=0.d0
alap_m=0.d0
agra1_m=0.d0
agra2_m=0.d0
agra3_m=0.d0
xyzzyaaaq5=0
do xyzzyaaab5=1,num_centres
if(which_ion_displaced==xyzzyaaab5)then
xyzzyaaaw5=xpos_in_cell(xyzzyaaab5,1)+ion_displacement(1)
xyzzyaaax5=ypos_in_cell(xyzzyaaab5,1)+ion_displacement(2)
xyzzyaaay5=zpos_in_cell(xyzzyaaab5,1)+ion_displacement(3)
else
xyzzyaaaw5=xpos_in_cell(xyzzyaaab5,1)
xyzzyaaax5=ypos_in_cell(xyzzyaaab5,1)
xyzzyaaay5=zpos_in_cell(xyzzyaaab5,1)
endif
xyzzyaaaw5=rvec(1)-xyzzyaaaw5
xyzzyaaax5=rvec(2)-xyzzyaaax5
xyzzyaaay5=rvec(3)-xyzzyaaay5
xyzzyaaaz5=xyzzyaaaw5*xyzzyaaaw5
xyzzyaaba5=xyzzyaaax5*xyzzyaaax5
xyzzyaabb5=xyzzyaaay5*xyzzyaaay5
xyzzyaaav5=xyzzyaaaz5+xyzzyaaba5+xyzzyaabb5
xyzzyaaac5=num_shells_on_centre(xyzzyaaab5,1)
do xyzzyaaad5=1,xyzzyaaac5
xyzzyaaaa5=xyzzyaaaa5+1
xyzzyaaae5=shell_sequence_number(xyzzyaaaa5)
xyzzyaadv5=min_exponent(xyzzyaaae5)
xyzzyaadd5=xyzzyaadv5*xyzzyaaav5
if(xyzzyaadd5>screening_tolerance)cycle
xyzzyaaaf5=shell_am(xyzzyaaae5)
xyzzyaaag5=first_ao(xyzzyaaae5)-1
xyzzyaaah5=numao_in_shell(xyzzyaaae5)
xyzzyaaai5=xyzzyaaah5*3
xyzzyaaaj5=primitive(xyzzyaaae5)
xyzzyaaak5=primitive(xyzzyaaae5+1)-1
xyzzyaaet5=.false.
do xyzzyaaal5=xyzzyaaaj5,xyzzyaaak5
xyzzyaadv5=exponent(xyzzyaaal5)
xyzzyaadd5=xyzzyaadv5*xyzzyaaav5
if(xyzzyaadd5>30.d0)cycle
xyzzyaaet5=.true.
xyzzyaadw5=exp(-xyzzyaadd5)
xyzzyaacq5=-xyzzyaadv5-xyzzyaadv5
select case (xyzzyaaaf5)
case(1)
xyzzyaaea5(1)=c_prim(xyzzyaaal5)*xyzzyaadw5
xyzzyaadx5=xyzzyaaea5(1)*xyzzyaacq5
xyzzyaaec5(1)=xyzzyaaaw5*xyzzyaadx5
xyzzyaaec5(2)=xyzzyaaax5*xyzzyaadx5
xyzzyaaec5(3)=xyzzyaaay5*xyzzyaadx5
xyzzyaadd5=3.d0+xyzzyaacq5*xyzzyaaav5
xyzzyaaeb5(1)=xyzzyaadd5*xyzzyaadx5
case(2)
xyzzyaadx5=c_prim(xyzzyaaal5)*xyzzyaadw5
xyzzyaady5=c_prim2(xyzzyaaal5)*xyzzyaadw5
xyzzyaaea5(1)=xyzzyaadx5
xyzzyaaea5(2)=xyzzyaady5*xyzzyaaaw5
xyzzyaaea5(3)=xyzzyaady5*xyzzyaaax5
xyzzyaaea5(4)=xyzzyaady5*xyzzyaaay5
xyzzyaaec5(1)=xyzzyaacq5*xyzzyaaaw5
xyzzyaaec5(2)=xyzzyaacq5*xyzzyaaax5
xyzzyaaec5(3)=xyzzyaacq5*xyzzyaaay5
xyzzyaaec5(4)=1.d0+xyzzyaaec5(1)*xyzzyaaaw5
xyzzyaaec5(5)=xyzzyaaec5(1)*xyzzyaaax5
xyzzyaaec5(6)=xyzzyaaec5(1)*xyzzyaaay5
xyzzyaaec5(8)=1.d0+xyzzyaaec5(2)*xyzzyaaax5
xyzzyaaec5(9)=xyzzyaaec5(2)*xyzzyaaay5
xyzzyaaec5(7)=xyzzyaaec5(5)
xyzzyaaec5(10)=xyzzyaaec5(6)
xyzzyaaec5(11)=xyzzyaaec5(9)
xyzzyaaec5(12)=1.d0+xyzzyaaec5(3)*xyzzyaaay5
xyzzyaaec5(1:3)=xyzzyaaec5(1:3)*xyzzyaadx5
xyzzyaaec5(4:12)=xyzzyaaec5(4:12)*xyzzyaady5
xyzzyaadd5=3.d0+xyzzyaacq5*xyzzyaaav5
xyzzyaade5=xyzzyaacq5*xyzzyaadd5
xyzzyaadf5=(xyzzyaade5+2.d0*xyzzyaacq5)*xyzzyaady5
xyzzyaaeb5(1)=xyzzyaade5*xyzzyaadx5
xyzzyaaeb5(2)=xyzzyaadf5*xyzzyaaaw5
xyzzyaaeb5(3)=xyzzyaadf5*xyzzyaaax5
xyzzyaaeb5(4)=xyzzyaadf5*xyzzyaaay5
case(3)
xyzzyaady5=c_prim(xyzzyaaal5)*xyzzyaadw5
xyzzyaaea5(1)=xyzzyaady5*xyzzyaaaw5
xyzzyaaea5(2)=xyzzyaady5*xyzzyaaax5
xyzzyaaea5(3)=xyzzyaady5*xyzzyaaay5
xyzzyaacr5=xyzzyaacq5*xyzzyaaaw5
xyzzyaacs5=xyzzyaacq5*xyzzyaaax5
xyzzyaact5=xyzzyaacq5*xyzzyaaay5
xyzzyaadg5=xyzzyaacq5*(5+xyzzyaacq5*xyzzyaaav5)
xyzzyaaec5(1)=1.d0+xyzzyaacr5*xyzzyaaaw5
xyzzyaaec5(2)=xyzzyaacr5*xyzzyaaax5
xyzzyaaec5(3)=xyzzyaacr5*xyzzyaaay5
xyzzyaaec5(5)=1.d0+xyzzyaacs5*xyzzyaaax5
xyzzyaaec5(6)=xyzzyaacs5*xyzzyaaay5
xyzzyaaec5(9)=1.d0+xyzzyaact5*xyzzyaaay5
xyzzyaaec5(4)=xyzzyaaec5(2)
xyzzyaaec5(7)=xyzzyaaec5(3)
xyzzyaaec5(8)=xyzzyaaec5(6)
xyzzyaaeb5(1)=xyzzyaadg5*xyzzyaaaw5
xyzzyaaeb5(2)=xyzzyaadg5*xyzzyaaax5
xyzzyaaeb5(3)=xyzzyaadg5*xyzzyaaay5
do xyzzyaaam5=1,9
xyzzyaaec5(xyzzyaaam5)=xyzzyaaec5(xyzzyaaam5)*xyzzyaady5
enddo
do xyzzyaaam5=1,3
xyzzyaaeb5(xyzzyaaam5)=xyzzyaaeb5(xyzzyaaam5)*xyzzyaady5
enddo
case(4)
xyzzyaabc5=xyzzyaaaw5*xyzzyaaax5
xyzzyaabd5=xyzzyaaax5*xyzzyaaay5
xyzzyaabe5=xyzzyaaaw5*xyzzyaaay5
xyzzyaaci5=xyzzyaaaz5-xyzzyaaba5
xyzzyaabf5=3.d0*xyzzyaabb5-xyzzyaaav5
xyzzyaaea5(1)=xyzzyaabf5
xyzzyaaea5(2)=xyzzyaabe5
xyzzyaaea5(3)=xyzzyaabd5
xyzzyaaea5(4)=xyzzyaaci5
xyzzyaaea5(5)=xyzzyaabc5
xyzzyaadz5=c_prim(xyzzyaaal5)*xyzzyaadw5
xyzzyaaea5(1:5)=xyzzyaaea5(1:5)*xyzzyaadz5
xyzzyaadu5=7.d0+xyzzyaacq5*xyzzyaaav5
xyzzyaadu5=xyzzyaacq5*xyzzyaadu5
xyzzyaaeb5(1:5)=xyzzyaaea5(1:5)*xyzzyaadu5
xyzzyaacr5=xyzzyaacq5*xyzzyaaaw5
xyzzyaacs5=xyzzyaacq5*xyzzyaaax5
xyzzyaact5=xyzzyaacq5*xyzzyaaay5
xyzzyaadd5=1.d0+xyzzyaacr5*xyzzyaaaw5
xyzzyaade5=1.d0+xyzzyaacs5*xyzzyaaax5
xyzzyaadf5=1.d0+xyzzyaact5*xyzzyaaay5
xyzzyaadg5=xyzzyaacq5*xyzzyaabf5-2.d0
xyzzyaadh5=xyzzyaacq5*xyzzyaaci5
xyzzyaaec5(1)=xyzzyaadg5*xyzzyaaaw5
xyzzyaaec5(2)=xyzzyaadg5*xyzzyaaax5
xyzzyaaec5(3)=(xyzzyaadg5+6.d0)*xyzzyaaay5
xyzzyaaec5(4)=xyzzyaadd5*xyzzyaaay5
xyzzyaaec5(5)=xyzzyaacr5*xyzzyaabd5
xyzzyaaec5(6)=xyzzyaadf5*xyzzyaaaw5
xyzzyaaec5(7)=xyzzyaaec5(5)
xyzzyaaec5(8)=xyzzyaade5*xyzzyaaay5
xyzzyaaec5(9)=xyzzyaadf5*xyzzyaaax5
xyzzyaaec5(10)=(2.d0+xyzzyaacq5*xyzzyaaci5)*xyzzyaaaw5
xyzzyaaec5(11)=(xyzzyaadh5-2.d0)*xyzzyaaax5
xyzzyaaec5(12)=xyzzyaadh5*xyzzyaaay5
xyzzyaaec5(13)=xyzzyaadd5*xyzzyaaax5
xyzzyaaec5(14)=xyzzyaade5*xyzzyaaaw5
xyzzyaaec5(15)=xyzzyaaec5(5)
do xyzzyaaam5=1,15
xyzzyaaec5(xyzzyaaam5)=xyzzyaaec5(xyzzyaaam5)*xyzzyaadz5
enddo
case(5)
xyzzyaabg5=xyzzyaaaz5*xyzzyaaaw5
xyzzyaabh5=xyzzyaaba5*xyzzyaaax5
xyzzyaabi5=xyzzyaabb5*xyzzyaaay5
xyzzyaabc5=xyzzyaaaw5*xyzzyaaax5
xyzzyaabe5=xyzzyaaaw5*xyzzyaaay5
xyzzyaabd5=xyzzyaaax5*xyzzyaaay5
xyzzyaabj5=xyzzyaabc5*xyzzyaaaw5
xyzzyaabk5=xyzzyaabc5*xyzzyaaax5
xyzzyaabn5=xyzzyaabe5*xyzzyaaaw5
xyzzyaabo5=xyzzyaabe5*xyzzyaaay5
xyzzyaabl5=xyzzyaabd5*xyzzyaaax5
xyzzyaabm5=xyzzyaabd5*xyzzyaaay5
xyzzyaace5=xyzzyaabc5*xyzzyaaay5
xyzzyaach5=xyzzyaaaz5+xyzzyaaba5
xyzzyaacj5=xyzzyaaba5-xyzzyaaaz5
xyzzyaacf5=3.d0*xyzzyaaaz5
xyzzyaacg5=3.d0*xyzzyaaba5
xyzzyaack5=2.d0*xyzzyaadv5
xyzzyaacl5=3.d0*xyzzyaadv5
xyzzyaacm5=xyzzyaack5*xyzzyaaaz5
xyzzyaacn5=xyzzyaack5*xyzzyaaba5
xyzzyaaco5=xyzzyaack5*xyzzyaabb5
xyzzyaacp5=4.d0*xyzzyaabb5
xyzzyaaea5(1)=xyzzyaabi5-1.5d0*(xyzzyaabn5+xyzzyaabl5)
xyzzyaaea5(2)=6.d0*xyzzyaabo5-1.5d0*(xyzzyaabg5+xyzzyaabk5)
xyzzyaaea5(3)=6.d0*xyzzyaabm5-1.5d0*(xyzzyaabj5+xyzzyaabh5)
xyzzyaaea5(4)=15.d0*(xyzzyaabn5-xyzzyaabl5)
xyzzyaaea5(5)=30.d0*xyzzyaace5
xyzzyaaea5(6)=15.d0*xyzzyaabg5-45.d0*xyzzyaabk5
xyzzyaaea5(7)=45.d0*xyzzyaabj5-15.d0*xyzzyaabh5
xyzzyaadz5=c_prim(xyzzyaaal5)*xyzzyaadw5
xyzzyaaea5(1:7)=xyzzyaaea5(1:7)*xyzzyaadz5
xyzzyaadu5=xyzzyaack5*(xyzzyaack5*xyzzyaaav5-9.d0)
xyzzyaaeb5(1:7)=xyzzyaaea5(1:7)*xyzzyaadu5
xyzzyaade5=xyzzyaacf5+xyzzyaacg5-(2.d0*xyzzyaabb5)
xyzzyaade5=xyzzyaadv5*xyzzyaade5-3.d0
xyzzyaaec5(1)=xyzzyaabe5*xyzzyaade5
xyzzyaaec5(2)=xyzzyaabd5*xyzzyaade5
xyzzyaadf5=6.d0*xyzzyaabb5
xyzzyaadg5=xyzzyaadv5*xyzzyaadf5-3.d0
xyzzyaadh5=2.d0*xyzzyaaco5*xyzzyaabb5
xyzzyaaec5(3)=0.5d0*(xyzzyaadf5-xyzzyaadh5+xyzzyaach5*xyzzyaadg5)
xyzzyaadi5=xyzzyaacm5*xyzzyaaaz5-xyzzyaaba5+xyzzyaacp5
xyzzyaadj5=xyzzyaack5*(xyzzyaaba5-xyzzyaacp5)-3
xyzzyaaec5(4)=1.5d0*(xyzzyaadi5+xyzzyaaaz5*xyzzyaadj5)
xyzzyaadj5=xyzzyaacl5*(xyzzyaach5-xyzzyaacp5)
xyzzyaaec5(5)=xyzzyaabc5*(xyzzyaadj5-3.d0)
xyzzyaaec5(6)=xyzzyaabe5*(xyzzyaadj5+12.d0)
xyzzyaaec5(7)=xyzzyaaec5(5)
xyzzyaaec5(9)=xyzzyaabd5*(xyzzyaadj5+12.d0)
xyzzyaadl5=xyzzyaacn5*xyzzyaaba5+xyzzyaaaz5*(xyzzyaacn5-1.d0)
xyzzyaadm5=xyzzyaaba5*(3.d0+8.d0*xyzzyaadv5*xyzzyaabb5)
xyzzyaaec5(8)=1.5d0*(xyzzyaadl5-xyzzyaadm5+xyzzyaacp5)
xyzzyaadn5=xyzzyaadv5*xyzzyaacj5
xyzzyaaec5(10)=30.d0*xyzzyaabe5*(xyzzyaadn5+1.d0)
xyzzyaaec5(11)=30.d0*xyzzyaabd5*(xyzzyaadn5-1.d0)
xyzzyaaec5(12)=15.d0*xyzzyaacj5*(xyzzyaaco5-1.d0)
xyzzyaaec5(13)=30.d0*(1.d0-xyzzyaacm5)*xyzzyaabd5
xyzzyaaec5(14)=30.d0*(1.d0-xyzzyaacn5)*xyzzyaabe5
xyzzyaaec5(15)=30.d0*(1.d0-xyzzyaaco5)*xyzzyaabc5
xyzzyaado5=xyzzyaacf5*(1+xyzzyaacn5)
xyzzyaadp5=xyzzyaacm5*xyzzyaaaz5+xyzzyaacg5
xyzzyaaec5(16)=-15.d0*(xyzzyaadp5-xyzzyaado5)
xyzzyaadq5=(-30.d0)*xyzzyaadv5*(xyzzyaaaz5-xyzzyaacg5)
xyzzyaaec5(17)=xyzzyaabc5*(xyzzyaadq5-90.d0)
xyzzyaaec5(18)=xyzzyaabe5*xyzzyaadq5
xyzzyaadr5=30.d0*xyzzyaadv5*(xyzzyaaba5-xyzzyaacf5)
xyzzyaads5=xyzzyaaaz5*(6.d0*xyzzyaadv5*xyzzyaaba5-3.d0)
xyzzyaadt5=xyzzyaaba5*(xyzzyaacn5-3.d0)
xyzzyaaec5(19)=xyzzyaabc5*(90.d0+xyzzyaadr5)
xyzzyaaec5(20)=15.d0*(xyzzyaadt5-xyzzyaads5)
xyzzyaaec5(21)=xyzzyaabd5*xyzzyaadr5
xyzzyaaec5(1:21)=xyzzyaaec5(1:21)*xyzzyaadz5
case(6)
xyzzyaabc5=xyzzyaaaw5*xyzzyaaax5
xyzzyaabe5=xyzzyaaaw5*xyzzyaaay5
xyzzyaabd5=xyzzyaaax5*xyzzyaaay5
xyzzyaace5=xyzzyaabc5*xyzzyaaay5
xyzzyaabp5=xyzzyaaaz5*xyzzyaaaz5
xyzzyaabq5=xyzzyaaba5*xyzzyaaba5
xyzzyaabr5=xyzzyaabb5*xyzzyaabb5
xyzzyaabs5=xyzzyaaaz5*xyzzyaaba5
xyzzyaabt5=xyzzyaaaz5*xyzzyaabb5
xyzzyaabu5=xyzzyaaba5*xyzzyaabb5
xyzzyaabv5=xyzzyaaaz5*xyzzyaabe5
xyzzyaabw5=xyzzyaabc5*xyzzyaabd5
xyzzyaabx5=xyzzyaabe5*xyzzyaabb5
xyzzyaaby5=xyzzyaabc5*xyzzyaabe5
xyzzyaabz5=xyzzyaaba5*xyzzyaabd5
xyzzyaaca5=xyzzyaabd5*xyzzyaabb5
xyzzyaacb5=xyzzyaaaz5*xyzzyaabc5
xyzzyaacc5=xyzzyaabc5*xyzzyaaba5
xyzzyaacd5=xyzzyaabc5*xyzzyaabb5
xyzzyaacu5=xyzzyaabp5+xyzzyaabq5
xyzzyaaci5=xyzzyaaaz5-xyzzyaaba5
xyzzyaach5=xyzzyaaaz5+xyzzyaaba5
xyzzyaack5=2.d0*xyzzyaadv5
xyzzyaacl5=3.d0*xyzzyaadv5
xyzzyaacv5=xyzzyaadv5*xyzzyaaaz5
xyzzyaacw5=xyzzyaadv5*xyzzyaaba5
xyzzyaacx5=xyzzyaadv5*xyzzyaabb5
xyzzyaacn5=2.d0*xyzzyaacw5
xyzzyaada5=4.d0*xyzzyaacx5
xyzzyaadb5=8.d0*xyzzyaacx5
xyzzyaadc5=6.d0*xyzzyaacw5
xyzzyaacy5=xyzzyaadv5*xyzzyaabp5
xyzzyaacz5=xyzzyaadv5*xyzzyaabq5
xyzzyaadd5=xyzzyaabr5-3.d0*(xyzzyaabt5+xyzzyaabu5)
xyzzyaade5=0.375d0*xyzzyaacu5
xyzzyaadf5=0.75d0*xyzzyaabs5
xyzzyaaea5(1)=(xyzzyaadd5+xyzzyaade5+xyzzyaadf5)
xyzzyaadg5=7.5d0*(xyzzyaabv5+xyzzyaabw5)
xyzzyaaea5(2)=10.d0*xyzzyaabx5-xyzzyaadg5
xyzzyaadh5=7.5d0*(xyzzyaaby5+xyzzyaabz5)
xyzzyaaea5(3)=10.d0*xyzzyaaca5-xyzzyaadh5
xyzzyaadi5=45.d0*(xyzzyaabt5-xyzzyaabu5)
xyzzyaadj5=7.5d0*(xyzzyaabq5-xyzzyaabp5)
xyzzyaaea5(4)=xyzzyaadi5+xyzzyaadj5
xyzzyaadk5=15.d0*(xyzzyaacb5+xyzzyaacc5)
xyzzyaaea5(5)=90.d0*xyzzyaacd5-xyzzyaadk5
xyzzyaadl5=315.d0*xyzzyaabw5
xyzzyaaea5(6)=105.d0*xyzzyaabv5-xyzzyaadl5
xyzzyaadm5=315.d0*xyzzyaaby5
xyzzyaaea5(7)=xyzzyaadm5-105.d0*xyzzyaabz5
xyzzyaaea5(8)=105.d0*xyzzyaacu5-630.d0*xyzzyaabs5
xyzzyaaea5(9)=420.d0*(xyzzyaacb5-xyzzyaacc5)
xyzzyaadz5=c_prim(xyzzyaaal5)*xyzzyaadw5
do xyzzyaaam5=1,9
xyzzyaaea5(xyzzyaaam5)=xyzzyaaea5(xyzzyaaam5)*xyzzyaadz5
enddo
xyzzyaadu5=xyzzyaack5*(xyzzyaack5*xyzzyaaav5-11.d0)
do xyzzyaaam5=1,9
xyzzyaaeb5(xyzzyaaam5)=xyzzyaaea5(xyzzyaaam5)*xyzzyaadu5
enddo
xyzzyaadn5=xyzzyaacl5*xyzzyaacu5
xyzzyaado5=xyzzyaabb5*(24.d0+xyzzyaadb5)
xyzzyaadp5=6.d0*xyzzyaaba5*(1.d0+xyzzyaada5)
xyzzyaadq5=6.d0*xyzzyaaaz5*(xyzzyaacw5+xyzzyaada5-1.d0)
xyzzyaadr5=-0.25d0*(xyzzyaadn5+xyzzyaado5-xyzzyaadp5+xyzzyaadq5)
xyzzyaaec5(1)=xyzzyaaaw5*xyzzyaadr5
xyzzyaaec5(2)=xyzzyaaax5*xyzzyaadr5
xyzzyaado5=8.d0*xyzzyaabb5*(xyzzyaacx5-2.d0)
xyzzyaadp5=24.d0*xyzzyaaba5*(xyzzyaacx5-1.d0)
xyzzyaadq5=xyzzyaadq5+30.d0*xyzzyaaaz5
xyzzyaadr5=xyzzyaadn5+xyzzyaado5-xyzzyaadp5+xyzzyaadq5
xyzzyaaec5(3)=-0.25d0*xyzzyaaay5*xyzzyaadr5
xyzzyaado5=6.d0*xyzzyaacy5-3.d0*xyzzyaaba5+4.d0*xyzzyaabb5
xyzzyaadp5=9.d0-xyzzyaadc5+xyzzyaadb5
xyzzyaaec5(4)=2.5d0*xyzzyaaay5*(xyzzyaado5-xyzzyaaaz5*xyzzyaadp5)
xyzzyaadp5=3.d0*xyzzyaach5-4.d0*xyzzyaabb5
xyzzyaaec5(5)=5.d0*xyzzyaace5*(xyzzyaadv5*xyzzyaadp5-3.d0)
xyzzyaadq5=xyzzyaabb5*(12.d0-xyzzyaadb5)
xyzzyaadr5=xyzzyaach5*(6.d0*xyzzyaacx5-3.d0)
xyzzyaadr5=2.5d0*(xyzzyaadr5+xyzzyaadq5)
xyzzyaaec5(6)=xyzzyaaaw5*xyzzyaadr5
xyzzyaaec5(7)=xyzzyaaec5(5)
xyzzyaaec5(9)=xyzzyaaax5*xyzzyaadr5
xyzzyaado5=6.d0*xyzzyaacz5-xyzzyaaaz5*(3.d0-xyzzyaadc5)
xyzzyaadp5=4.d0*xyzzyaabb5-xyzzyaaba5*(9.d0+xyzzyaadb5)
xyzzyaaec5(8)=2.5d0*xyzzyaaay5*(xyzzyaado5+xyzzyaadp5)
xyzzyaadq5=xyzzyaacy5-xyzzyaacz5
xyzzyaadr5=6.d0*(xyzzyaabb5+xyzzyaadv5*xyzzyaabu5)
xyzzyaads5=2.d0*xyzzyaaaz5*(1.d0+3.d0*xyzzyaacx5)
xyzzyaaec5(10)=15.d0*xyzzyaaaw5*(xyzzyaadq5+xyzzyaadr5-xyzzyaads5)
xyzzyaadn5=6.d0*xyzzyaabb5
xyzzyaado5=xyzzyaadv5*(xyzzyaach5-xyzzyaadn5)
xyzzyaadp5=2.d0*xyzzyaaba5-xyzzyaadn5
xyzzyaaec5(11)=15.d0*xyzzyaaax5*(xyzzyaado5*xyzzyaaci5+xyzzyaadp5)
xyzzyaado5=xyzzyaado5+6.d0
xyzzyaaec5(12)=15.d0*xyzzyaaay5*xyzzyaaci5*xyzzyaado5
xyzzyaaec5(15)=30.d0*xyzzyaace5*xyzzyaado5
xyzzyaadp5=2.d0*xyzzyaacy5-xyzzyaaba5+xyzzyaadn5
xyzzyaadq5=xyzzyaack5*(xyzzyaaba5-xyzzyaadn5)-3.d0
xyzzyaaec5(13)=15.d0*xyzzyaaax5*(xyzzyaadp5+xyzzyaaaz5*xyzzyaadq5)
xyzzyaadr5=2.d0*xyzzyaacz5+xyzzyaaaz5*(2.d0*xyzzyaacw5-1.d0)
xyzzyaads5=xyzzyaadn5-3.d0*xyzzyaaba5*(1.d0+4.d0*xyzzyaacx5)
xyzzyaaec5(14)=15.d0*xyzzyaaaw5*(xyzzyaadr5+xyzzyaads5)
xyzzyaadn5=105.d0*xyzzyaaay5
xyzzyaado5=3.d0*xyzzyaaaz5*(1.d0+xyzzyaacn5)
xyzzyaado5=xyzzyaado5-2.d0*xyzzyaacy5-3.d0*xyzzyaaba5
xyzzyaaec5(16)=xyzzyaadn5*xyzzyaado5
xyzzyaadp5=xyzzyaaaz5-3.d0*xyzzyaaba5
xyzzyaadq5=1.d0-2.d0*xyzzyaacx5
xyzzyaadr5=210.d0*xyzzyaace5
xyzzyaaec5(17)=(-xyzzyaadr5)*(3.d0+xyzzyaadv5*xyzzyaadp5)
xyzzyaaec5(18)=105.d0*xyzzyaaaw5*xyzzyaadp5*xyzzyaadq5
xyzzyaaec5(19)=xyzzyaadr5*(3.d0-3.d0*xyzzyaacv5+xyzzyaacw5)
xyzzyaads5=xyzzyaaaz5*(xyzzyaadc5-3.d0)
xyzzyaaec5(20)=xyzzyaadn5*(2.d0*xyzzyaacz5-3.d0*xyzzyaaba5-xyzzyaads5)
xyzzyaadp5=xyzzyaaba5-3.d0*xyzzyaaaz5
xyzzyaadq5=2.d0*xyzzyaacx5-1.d0
xyzzyaaec5(21)=105.d0*xyzzyaaax5*xyzzyaadp5*xyzzyaadq5
xyzzyaadn5=2.d0*xyzzyaaaz5*(1+3.d0*xyzzyaacw5)
xyzzyaado5=xyzzyaacy5+xyzzyaaba5*(6.d0+xyzzyaacw5)
xyzzyaaec5(22)=210.d0*xyzzyaaaw5*(xyzzyaadn5-xyzzyaado5)
xyzzyaadp5=xyzzyaaba5*(xyzzyaacw5-2.d0)
xyzzyaadq5=xyzzyaacy5+6.d0*xyzzyaaaz5*(1.d0-xyzzyaacw5)
xyzzyaaec5(23)=-210.d0*xyzzyaaax5*(xyzzyaadp5+xyzzyaadq5)
xyzzyaadr5=6.d0*xyzzyaabs5-xyzzyaacu5
xyzzyaaec5(24)=210.d0*xyzzyaadv5*xyzzyaaay5*xyzzyaadr5
xyzzyaads5=xyzzyaaaz5*(3.d0+xyzzyaacn5)
xyzzyaadt5=2.d0*xyzzyaacy5+xyzzyaaba5
xyzzyaaec5(25)=420.d0*xyzzyaaax5*(xyzzyaads5-xyzzyaadt5)
xyzzyaadq5=2.d0*xyzzyaacz5-3.d0*xyzzyaaba5
xyzzyaadr5=xyzzyaaaz5*(xyzzyaacn5-1.d0)
xyzzyaaec5(26)=420.d0*xyzzyaaaw5*(xyzzyaadq5-xyzzyaadr5)
xyzzyaaec5(27)=840.d0*xyzzyaadv5*xyzzyaace5*(xyzzyaaaz5-xyzzyaaba5)
do xyzzyaaam5=1,27
xyzzyaaec5(xyzzyaaam5)=xyzzyaaec5(xyzzyaaam5)*xyzzyaadz5
enddo
case(11)
xyzzyaaea5(1)=c_prim(xyzzyaaal5)*xyzzyaaav5*xyzzyaadw5
xyzzyaadd5=xyzzyaaav5*xyzzyaadv5
xyzzyaadx5=c_prim(xyzzyaaal5)*2*xyzzyaadw5
xyzzyaaec5(1)=xyzzyaadx5*xyzzyaaaw5*(1-xyzzyaadd5)
xyzzyaaec5(2)=xyzzyaadx5*xyzzyaaax5*(1-xyzzyaadd5)
xyzzyaaec5(3)=xyzzyaadx5*xyzzyaaay5*(1-xyzzyaadd5)
xyzzyaaeb5(1)=xyzzyaadx5*(3-7*xyzzyaadd5+2*xyzzyaadd5*xyzzyaadd5)
case(12)
xyzzyaadz5=c_prim(xyzzyaaal5)*xyzzyaadw5
xyzzyaaea5(1)=xyzzyaadz5*xyzzyaaaw5*xyzzyaaav5
xyzzyaaea5(2)=xyzzyaadz5*xyzzyaaax5*xyzzyaaav5
xyzzyaaea5(3)=xyzzyaadz5*xyzzyaaay5*xyzzyaaav5
xyzzyaade5=xyzzyaadv5*xyzzyaaav5
xyzzyaadf5=(-2)*xyzzyaadz5*(-1+xyzzyaadv5*xyzzyaaav5)
xyzzyaaec5(1)=xyzzyaadz5*(xyzzyaaba5+xyzzyaabb5-xyzzyaaaz5*(-3+2*xyzzy&
&aade5))
xyzzyaaec5(2)=xyzzyaadf5*xyzzyaaaw5*xyzzyaaax5
xyzzyaaec5(3)=xyzzyaadf5*xyzzyaaaw5*xyzzyaaay5
xyzzyaaec5(4)=xyzzyaadf5*xyzzyaaaw5*xyzzyaaax5
xyzzyaaec5(5)=xyzzyaadz5*(xyzzyaaaz5*(1-2*xyzzyaadv5*xyzzyaaba5)+xyzzy&
&aabb5+xyzzyaaba5*(3-2*xyzzyaadv5*(xyzzyaaba5+xyzzyaabb5)))
xyzzyaaec5(6)=xyzzyaadf5*xyzzyaaax5*xyzzyaaay5
xyzzyaaec5(7)=xyzzyaadf5*xyzzyaaaw5*xyzzyaaay5
xyzzyaaec5(8)=xyzzyaadf5*xyzzyaaax5*xyzzyaaay5
xyzzyaaec5(9)=xyzzyaadz5*(xyzzyaaaz5+xyzzyaaba5-(-3+2*xyzzyaadv5*(xyzz&
&yaaaz5+xyzzyaaba5))*xyzzyaabb5-2*xyzzyaadv5*xyzzyaabb5*xyzzyaabb5)
xyzzyaadg5=2*xyzzyaadz5*(5+xyzzyaade5*(-9+2*xyzzyaade5))
xyzzyaaeb5(1)=xyzzyaadg5*xyzzyaaaw5
xyzzyaaeb5(2)=xyzzyaadg5*xyzzyaaax5
xyzzyaaeb5(3)=xyzzyaadg5*xyzzyaaay5
end select
xyzzyaaao5=xyzzyaaag5+1
xyzzyaaap5=xyzzyaaag5+xyzzyaaah5
ao_m(xyzzyaaao5:xyzzyaaap5)=ao_m(xyzzyaaao5:xyzzyaaap5)+xyzzyaaea5(1:x&
&yzzyaaah5)
alap_m(xyzzyaaao5:xyzzyaaap5)=alap_m(xyzzyaaao5:xyzzyaaap5)+xyzzyaaeb5&
&(1:xyzzyaaah5)
agra1_m(xyzzyaaao5:xyzzyaaap5)=agra1_m(xyzzyaaao5:xyzzyaaap5)+xyzzyaae&
&c5(1:xyzzyaaai5:3)
agra2_m(xyzzyaaao5:xyzzyaaap5)=agra2_m(xyzzyaaao5:xyzzyaaap5)+xyzzyaae&
&c5(2:xyzzyaaai5:3)
agra3_m(xyzzyaaao5:xyzzyaaap5)=agra3_m(xyzzyaaao5:xyzzyaaap5)+xyzzyaae&
&c5(3:xyzzyaaai5:3)
enddo
if(xyzzyaaet5)then
do xyzzyaaam5=1,xyzzyaaah5
xyzzyaaar5(xyzzyaaaq5+xyzzyaaam5)=xyzzyaaag5+xyzzyaaam5
enddo
xyzzyaaaq5=xyzzyaaaq5+xyzzyaaah5
endif
enddo
enddo
if(use_gpcc)call cusp_wfdet_real(rvec,jspin,.true.,.true.,cusp_val_r,c&
&usp_grad_r,cusp_lap_r)
xyzzyaaas5=gauss_offset(jspin)
xyzzyaaau5=nuc_nele(jspin)
xyzzyaaat5=xyzzyaaas5-1+xyzzyaaau5
orbval(xyzzyaaas5:xyzzyaaat5,1)=multi_ddot_s(xyzzyaaau5,xyzzyaaaq5,xyz&
&zyaaar5,orbmask(xyzzyaaas5),rck(:,:,:,xyzzyaaac1),size_rck,maxb,ao_m,&
&rnorm)
orbgrad(1,xyzzyaaas5:xyzzyaaat5,1)=multi_ddot_s(xyzzyaaau5,xyzzyaaaq5,&
&xyzzyaaar5,orbmask(xyzzyaaas5),rck(:,:,:,xyzzyaaac1),size_rck,maxb,ag&
&ra1_m,rnorm)
orbgrad(2,xyzzyaaas5:xyzzyaaat5,1)=multi_ddot_s(xyzzyaaau5,xyzzyaaaq5,&
&xyzzyaaar5,orbmask(xyzzyaaas5),rck(:,:,:,xyzzyaaac1),size_rck,maxb,ag&
&ra2_m,rnorm)
orbgrad(3,xyzzyaaas5:xyzzyaaat5,1)=multi_ddot_s(xyzzyaaau5,xyzzyaaaq5,&
&xyzzyaaar5,orbmask(xyzzyaaas5),rck(:,:,:,xyzzyaaac1),size_rck,maxb,ag&
&ra3_m,rnorm)
orblap(xyzzyaaas5:xyzzyaaat5,1)=multi_ddot_s(xyzzyaaau5,xyzzyaaaq5,xyz&
&zyaaar5,orbmask(xyzzyaaas5),rck(:,:,:,xyzzyaaac1),size_rck,maxb,alap_&
&m,rnorm)
if(use_gpcc)then
do xyzzyaaam5=1,gauss_gs_norb
if(.not.orbmask(xyzzyaaam5))cycle
orbval(xyzzyaaam5,1)=orbval(xyzzyaaam5,1)+cusp_val_r(xyzzyaaam5)
orbgrad(:,xyzzyaaam5,1)=orbgrad(:,xyzzyaaam5,1)+cusp_grad_r(:,xyzzyaaa&
&m5)
orblap(xyzzyaaam5,1)=orblap(xyzzyaaam5,1)+cusp_lap_r(xyzzyaaam5)
enddo
endif
if(excite)then
do xyzzyaaam5=1,gauss_ex_norb
xyzzyaaan5=gauss_gs_norb+xyzzyaaam5
if(.not.orbmask(xyzzyaaan5))cycle
xyzzyaaac5=full2vrt(xyzzyaaam5,jspin)
psi(xyzzyaaam5)=sum(ao_m(:)*rck_ex(:,xyzzyaaac5,jspin))*rnorm
flap(xyzzyaaam5)=sum(alap_m(:)*rck_ex(:,xyzzyaaac5,jspin))*rnorm
fgra1(xyzzyaaam5)=sum(agra1_m(:)*rck_ex(:,xyzzyaaac5,jspin))*rnorm
fgra2(xyzzyaaam5)=sum(agra2_m(:)*rck_ex(:,xyzzyaaac5,jspin))*rnorm
fgra3(xyzzyaaam5)=sum(agra3_m(:)*rck_ex(:,xyzzyaaac5,jspin))*rnorm
if(use_gpcc)then
psi(xyzzyaaam5)=psi(xyzzyaaam5)+cusp_val_r(xyzzyaaan5)
flap(xyzzyaaam5)=flap(xyzzyaaam5)+cusp_lap_r(xyzzyaaan5)
fgra1(xyzzyaaam5)=fgra1(xyzzyaaam5)+cusp_grad_r(1,xyzzyaaan5)
fgra2(xyzzyaaam5)=fgra2(xyzzyaaam5)+cusp_grad_r(2,xyzzyaaan5)
fgra3(xyzzyaaam5)=fgra3(xyzzyaaam5)+cusp_grad_r(3,xyzzyaaan5)
endif
enddo
if(cusp_correction)then
do xyzzyaaab5=1,num_centres
if(is_ae(xyzzyaaab5))then
xyzzyaaaw5=xpos_in_cell(xyzzyaaab5,1)
xyzzyaaax5=ypos_in_cell(xyzzyaaab5,1)
xyzzyaaay5=zpos_in_cell(xyzzyaaab5,1)
xyzzyaaaw5=rvec(1)-xyzzyaaaw5
xyzzyaaax5=rvec(2)-xyzzyaaax5
xyzzyaaay5=rvec(3)-xyzzyaaay5
xyzzyaaav5=xyzzyaaaw5*xyzzyaaaw5+xyzzyaaax5*xyzzyaaax5+xyzzyaaay5*xyzz&
&yaaay5
do xyzzyaaam5=1,num_unique_orbitals(jspin)
xyzzyaaed5=rcusp_sq(xyzzyaaam5,xyzzyaaab5,xyzzyaaad1)
if(xyzzyaaav5<xyzzyaaed5)then
if(xyzzyaaav5/=0.d0)then
xyzzyaaee5=sqrt(xyzzyaaav5)
xyzzyaael5=1.d0/xyzzyaaee5
xyzzyaaem5=2.d0*xyzzyaael5
xyzzyaaei5=xyzzyaaaw5*xyzzyaael5
xyzzyaaej5=xyzzyaaax5*xyzzyaael5
xyzzyaaek5=xyzzyaaay5*xyzzyaael5
else
xyzzyaaee5=0.d0
xyzzyaaem5=2.d0
xyzzyaaei5=1.d0
xyzzyaaej5=1.d0
xyzzyaaek5=1.d0
endif
xyzzyaaah1=xyzzyaaam5>nuc_nele(jspin)
if(xyzzyaaah1)then
xyzzyaaab1=xyzzyaaam5-nuc_nele(jspin)
call wfdet_s(xyzzyaaee5,1,3.d0,xyzzyaaab1,xyzzyaaab5,jspin,1,1,1,.true&
&.,xyzzyaaac1,xyzzyaaae1,xyzzyaaag1,xyzzyaaaf1)
else
call wfdet_s(xyzzyaaee5,1,3.d0,xyzzyaaam5,xyzzyaaab5,jspin,1,1,1,.fals&
&e.,xyzzyaaac1,xyzzyaaae1,xyzzyaaag1,xyzzyaaaf1)
endif
xyzzyaaen5=acusp(1,xyzzyaaam5,xyzzyaaab5,xyzzyaaad1)
xyzzyaaeo5=acusp(2,xyzzyaaam5,xyzzyaaab5,xyzzyaaad1)
xyzzyaaep5=acusp(3,xyzzyaaam5,xyzzyaaab5,xyzzyaaad1)
xyzzyaaeq5=acusp(4,xyzzyaaam5,xyzzyaaab5,xyzzyaaad1)
xyzzyaaer5=acusp(5,xyzzyaaam5,xyzzyaaab5,xyzzyaaad1)
xyzzyaaef5=xyzzyaaen5+xyzzyaaeo5*xyzzyaaee5
xyzzyaaeg5=xyzzyaaeo5+2.d0*xyzzyaaep5*xyzzyaaee5
xyzzyaaeh5=2.d0*xyzzyaaep5+6.d0*xyzzyaaeq5*xyzzyaaee5
xyzzyaaes5=xyzzyaaee5*xyzzyaaee5
xyzzyaaef5=xyzzyaaef5+xyzzyaaep5*xyzzyaaes5
xyzzyaaeg5=xyzzyaaeg5+3.d0*xyzzyaaeq5*xyzzyaaes5
xyzzyaaeh5=xyzzyaaeh5+12.d0*xyzzyaaer5*xyzzyaaes5
xyzzyaaes5=xyzzyaaes5*xyzzyaaee5
xyzzyaaef5=xyzzyaaef5+xyzzyaaeq5*xyzzyaaes5
xyzzyaaeg5=xyzzyaaeg5+4.d0*xyzzyaaer5*xyzzyaaes5
xyzzyaaes5=xyzzyaaes5*xyzzyaaee5
xyzzyaaef5=xyzzyaaef5+xyzzyaaer5*xyzzyaaes5
xyzzyaadd5=disign(xyzzyaaam5,xyzzyaaab5,xyzzyaaad1)*exp(xyzzyaaef5)+ps&
&hift(xyzzyaaam5,xyzzyaaab5,xyzzyaaad1)
xyzzyaade5=xyzzyaadd5*xyzzyaaeg5
xyzzyaadf5=(xyzzyaaem5+xyzzyaaeg5)*xyzzyaaeg5+xyzzyaaeh5
if(xyzzyaaah1)then
xyzzyaaac5=vrt2full(xyzzyaaab1,jspin)
psi(xyzzyaaac5)=psi(xyzzyaaac5)-xyzzyaaae1(1)+xyzzyaadd5
fgra1(xyzzyaaac5)=fgra1(xyzzyaaac5)+(xyzzyaade5-xyzzyaaag1(1))*xyzzyaa&
&ei5
fgra2(xyzzyaaac5)=fgra2(xyzzyaaac5)+(xyzzyaade5-xyzzyaaag1(1))*xyzzyaa&
&ej5
fgra3(xyzzyaaac5)=fgra3(xyzzyaaac5)+(xyzzyaade5-xyzzyaaag1(1))*xyzzyaa&
&ek5
flap(xyzzyaaac5)=flap(xyzzyaaac5)-xyzzyaaaf1(1)+xyzzyaadd5*xyzzyaadf5
else
xyzzyaaac5=xyzzyaaam5+gauss_offset(jspin)-1
orbval(xyzzyaaac5,1)=orbval(xyzzyaaac5,1)-xyzzyaaae1(1)+xyzzyaadd5
orbgrad(1,xyzzyaaac5,1)=orbgrad(1,xyzzyaaac5,1)+(xyzzyaade5-xyzzyaaag1&
&(1))*xyzzyaaei5
orbgrad(2,xyzzyaaac5,1)=orbgrad(2,xyzzyaaac5,1)+(xyzzyaade5-xyzzyaaag1&
&(1))*xyzzyaaej5
orbgrad(3,xyzzyaaac5,1)=orbgrad(3,xyzzyaaac5,1)+(xyzzyaade5-xyzzyaaag1&
&(1))*xyzzyaaek5
orblap(xyzzyaaac5,1)=orblap(xyzzyaaac5,1)-xyzzyaaaf1(1)+xyzzyaadd5*xyz&
&zyaadf5
endif
endif
enddo
endif
enddo
endif
do xyzzyaaam5=1,gauss_ex_norb
xyzzyaaan5=gauss_gs_norb+xyzzyaaam5
if(.not.orbmask(xyzzyaaan5))cycle
orbval(xyzzyaaan5,1)=psi(xyzzyaaam5)
orbgrad(1,xyzzyaaan5,1)=fgra1(xyzzyaaam5)
orbgrad(2,xyzzyaaan5,1)=fgra2(xyzzyaaam5)
orbgrad(3,xyzzyaaan5,1)=fgra3(xyzzyaaam5)
orblap(xyzzyaaan5,1)=flap(xyzzyaaam5)
enddo
else
if(cusp_correction)then
do xyzzyaaab5=1,num_centres
if(is_ae(xyzzyaaab5))then
xyzzyaaaw5=xpos_in_cell(xyzzyaaab5,1)
xyzzyaaax5=ypos_in_cell(xyzzyaaab5,1)
xyzzyaaay5=zpos_in_cell(xyzzyaaab5,1)
xyzzyaaaw5=rvec(1)-xyzzyaaaw5
xyzzyaaax5=rvec(2)-xyzzyaaax5
xyzzyaaay5=rvec(3)-xyzzyaaay5
xyzzyaaav5=xyzzyaaaw5*xyzzyaaaw5+xyzzyaaax5*xyzzyaaax5+xyzzyaaay5*xyzz&
&yaaay5
do xyzzyaaam5=1,num_unique_orbitals(jspin)
xyzzyaaed5=rcusp_sq(xyzzyaaam5,xyzzyaaab5,xyzzyaaad1)
if(xyzzyaaav5<xyzzyaaed5)then
if(xyzzyaaav5/=0.d0)then
xyzzyaaee5=sqrt(xyzzyaaav5)
xyzzyaael5=1.d0/xyzzyaaee5
xyzzyaaem5=2.d0*xyzzyaael5
xyzzyaaei5=xyzzyaaaw5*xyzzyaael5
xyzzyaaej5=xyzzyaaax5*xyzzyaael5
xyzzyaaek5=xyzzyaaay5*xyzzyaael5
else
xyzzyaaee5=0.d0
xyzzyaaem5=2.d0
xyzzyaaei5=1.d0
xyzzyaaej5=1.d0
xyzzyaaek5=1.d0
endif
call wfdet_s(xyzzyaaee5,1,3.d0,xyzzyaaam5,xyzzyaaab5,jspin,1,1,1,.fals&
&e.,xyzzyaaac1,xyzzyaaae1,xyzzyaaag1,xyzzyaaaf1)
xyzzyaaen5=acusp(1,xyzzyaaam5,xyzzyaaab5,xyzzyaaad1)
xyzzyaaeo5=acusp(2,xyzzyaaam5,xyzzyaaab5,xyzzyaaad1)
xyzzyaaep5=acusp(3,xyzzyaaam5,xyzzyaaab5,xyzzyaaad1)
xyzzyaaeq5=acusp(4,xyzzyaaam5,xyzzyaaab5,xyzzyaaad1)
xyzzyaaer5=acusp(5,xyzzyaaam5,xyzzyaaab5,xyzzyaaad1)
xyzzyaaef5=xyzzyaaen5+xyzzyaaeo5*xyzzyaaee5
xyzzyaaeg5=xyzzyaaeo5+2.d0*xyzzyaaep5*xyzzyaaee5
xyzzyaaeh5=2.d0*xyzzyaaep5+6.d0*xyzzyaaeq5*xyzzyaaee5
xyzzyaaes5=xyzzyaaee5*xyzzyaaee5
xyzzyaaef5=xyzzyaaef5+xyzzyaaep5*xyzzyaaes5
xyzzyaaeg5=xyzzyaaeg5+3.d0*xyzzyaaeq5*xyzzyaaes5
xyzzyaaeh5=xyzzyaaeh5+12.d0*xyzzyaaer5*xyzzyaaes5
xyzzyaaes5=xyzzyaaes5*xyzzyaaee5
xyzzyaaef5=xyzzyaaef5+xyzzyaaeq5*xyzzyaaes5
xyzzyaaeg5=xyzzyaaeg5+4.d0*xyzzyaaer5*xyzzyaaes5
xyzzyaaes5=xyzzyaaes5*xyzzyaaee5
xyzzyaaef5=xyzzyaaef5+xyzzyaaer5*xyzzyaaes5
xyzzyaadd5=disign(xyzzyaaam5,xyzzyaaab5,xyzzyaaad1)*exp(xyzzyaaef5)+ps&
&hift(xyzzyaaam5,xyzzyaaab5,xyzzyaaad1)
xyzzyaade5=xyzzyaadd5*xyzzyaaeg5
xyzzyaadf5=(xyzzyaaem5+xyzzyaaeg5)*xyzzyaaeg5+xyzzyaaeh5
xyzzyaaac5=xyzzyaaam5+gauss_offset(jspin)-1
orbval(xyzzyaaac5,1)=orbval(xyzzyaaac5,1)-xyzzyaaae1(1)+xyzzyaadd5
orbgrad(1,xyzzyaaac5,1)=orbgrad(1,xyzzyaaac5,1)+(xyzzyaade5-xyzzyaaag1&
&(1))*xyzzyaaei5
orbgrad(2,xyzzyaaac5,1)=orbgrad(2,xyzzyaaac5,1)+(xyzzyaade5-xyzzyaaag1&
&(1))*xyzzyaaej5
orbgrad(3,xyzzyaaac5,1)=orbgrad(3,xyzzyaaac5,1)+(xyzzyaade5-xyzzyaaag1&
&(1))*xyzzyaaek5
orblap(xyzzyaaac5,1)=orblap(xyzzyaaac5,1)-xyzzyaaaf1(1)+xyzzyaadd5*xyz&
&zyaadf5
endif
enddo
endif
enddo
endif
endif
end subroutine xyzzyaaak1
subroutine xyzzyaaal1(rvec,jspin,norb,orbmask,orbval)
implicit none
integer,intent(in) :: jspin,norb
real(dp),intent(in) :: rvec(3)
real(dp),intent(inout) :: orbval(norb,real1_complex2)
logical,intent(in) :: orbmask(norb)
integer xyzzyaaaa6,xyzzyaaab6,xyzzyaaac6,xyzzyaaad6,xyzzyaaae6,xyzzyaa&
&af6,xyzzyaaag6,xyzzyaaah6,xyzzyaaai6,xyzzyaaaj6,xyzzyaaak6,xyzzyaaal6&
&,xyzzyaaam6,xyzzyaaan6,xyzzyaaao6,xyzzyaaap6,xyzzyaaaq6(num_ao),xyzzy&
&aaar6,xyzzyaaas6
real(dp) xyzzyaaat6,xyzzyaaau6,xyzzyaaav6,xyzzyaaaw6,xyzzyaaax6,xyzzya&
&aay6,xyzzyaaaz6,xyzzyaaba6,xyzzyaabb6,xyzzyaabc6,xyzzyaabd6,xyzzyaabe&
&6,xyzzyaabf6,xyzzyaabg6,xyzzyaabh6,xyzzyaabi6,xyzzyaabj6,xyzzyaabk6,x&
&yzzyaabl6,xyzzyaabm6,xyzzyaabn6,xyzzyaabo6,xyzzyaabp6,xyzzyaabq6,xyzz&
&yaabr6,xyzzyaabs6,xyzzyaabt6,xyzzyaabu6,xyzzyaabv6,xyzzyaabw6,xyzzyaa&
&bx6,xyzzyaaby6,xyzzyaabz6,xyzzyaaca6,xyzzyaacb6,xyzzyaacc6,xyzzyaacd6&
&,xyzzyaace6,xyzzyaacf6,xyzzyaacg6,xyzzyaach6,xyzzyaaci6,xyzzyaacj6,xy&
&zzyaack6,xyzzyaacl6,xyzzyaacm6,xyzzyaacn6(9),xyzzyaaco6,xyzzyaacp6,xy&
&zzyaacq6,xyzzyaacr6,xyzzyaacs6,xyzzyaact6
logical xyzzyaacu6
xyzzyaaaa6=0
ao_m=0.d0
xyzzyaaap6=0
do xyzzyaaab6=1,num_centres
xyzzyaaac6=num_shells_on_centre(xyzzyaaab6,xyzzyaaaa1)
if(xyzzyaaac6>0)then
xyzzyaaat6=rion(1,xyzzyaaab6)
xyzzyaaau6=rion(2,xyzzyaaab6)
xyzzyaaav6=rion(3,xyzzyaaab6)
xyzzyaaat6=rvec(1)-xyzzyaaat6
xyzzyaaau6=rvec(2)-xyzzyaaau6
xyzzyaaav6=rvec(3)-xyzzyaaav6
xyzzyaaaw6=xyzzyaaat6*xyzzyaaat6
xyzzyaaax6=xyzzyaaau6*xyzzyaaau6
xyzzyaaay6=xyzzyaaav6*xyzzyaaav6
xyzzyaaaz6=xyzzyaaaw6+xyzzyaaax6+xyzzyaaay6
do xyzzyaaae6=1,xyzzyaaac6
xyzzyaaaa6=xyzzyaaaa6+1
xyzzyaaaf6=shell_sequence_mol(xyzzyaaaa6,xyzzyaaaa1)
xyzzyaaco6=min_exponent(xyzzyaaaf6)
xyzzyaacc6=xyzzyaaco6*xyzzyaaaz6
if(xyzzyaacc6>screening_tolerance)cycle
xyzzyaaag6=shell_am(xyzzyaaaf6)
xyzzyaaah6=numao_in_shell(xyzzyaaaf6)
xyzzyaaai6=first_ao(xyzzyaaaf6)-1
xyzzyaaaj6=primitive(xyzzyaaaf6)
xyzzyaaak6=primitive(xyzzyaaaf6+1)-1
xyzzyaacu6=.false.
do xyzzyaaal6=xyzzyaaaj6,xyzzyaaak6
xyzzyaaco6=exponent(xyzzyaaal6)
xyzzyaacc6=xyzzyaaco6*xyzzyaaaz6
if(xyzzyaacc6>30.d0)cycle
xyzzyaacu6=.true.
xyzzyaacp6=exp(-xyzzyaacc6)
select case (xyzzyaaag6)
case(1)
xyzzyaacn6(1)=c_prim(xyzzyaaal6)*xyzzyaacp6
case(2)
xyzzyaacn6(1)=c_prim(xyzzyaaal6)*xyzzyaacp6
xyzzyaacm6=c_prim2(xyzzyaaal6)*xyzzyaacp6
xyzzyaacn6(2)=xyzzyaacm6*xyzzyaaat6
xyzzyaacn6(3)=xyzzyaacm6*xyzzyaaau6
xyzzyaacn6(4)=xyzzyaacm6*xyzzyaaav6
case(3)
xyzzyaacm6=c_prim(xyzzyaaal6)*xyzzyaacp6
xyzzyaacn6(1)=xyzzyaacm6*xyzzyaaat6
xyzzyaacn6(2)=xyzzyaacm6*xyzzyaaau6
xyzzyaacn6(3)=xyzzyaacm6*xyzzyaaav6
case(4)
xyzzyaacn6(1)=3*xyzzyaaay6-xyzzyaaaz6
xyzzyaacn6(2)=xyzzyaaat6*xyzzyaaav6
xyzzyaacn6(3)=xyzzyaaau6*xyzzyaaav6
xyzzyaacn6(4)=xyzzyaaaw6-xyzzyaaax6
xyzzyaacn6(5)=xyzzyaaat6*xyzzyaaau6
xyzzyaacm6=c_prim(xyzzyaaal6)*xyzzyaacp6
do xyzzyaaam6=1,5
xyzzyaacn6(xyzzyaaam6)=xyzzyaacn6(xyzzyaaam6)*xyzzyaacm6
enddo
case(5)
xyzzyaabd6=xyzzyaaaw6*xyzzyaaat6
xyzzyaabe6=xyzzyaaax6*xyzzyaaau6
xyzzyaabf6=xyzzyaaay6*xyzzyaaav6
xyzzyaaba6=xyzzyaaat6*xyzzyaaau6
xyzzyaabc6=xyzzyaaat6*xyzzyaaav6
xyzzyaabb6=xyzzyaaau6*xyzzyaaav6
xyzzyaabg6=xyzzyaaba6*xyzzyaaat6
xyzzyaabh6=xyzzyaaba6*xyzzyaaau6
xyzzyaabk6=xyzzyaabc6*xyzzyaaat6
xyzzyaabl6=xyzzyaabc6*xyzzyaaav6
xyzzyaabi6=xyzzyaabb6*xyzzyaaau6
xyzzyaabj6=xyzzyaabb6*xyzzyaaav6
xyzzyaacn6(1)=xyzzyaabf6-1.5d0*(xyzzyaabk6+xyzzyaabi6)
xyzzyaacn6(2)=6.d0*xyzzyaabl6-1.5d0*(xyzzyaabd6+xyzzyaabh6)
xyzzyaacn6(3)=6.d0*xyzzyaabj6-1.5d0*(xyzzyaabg6+xyzzyaabe6)
xyzzyaacn6(4)=15.d0*(xyzzyaabk6-xyzzyaabi6)
xyzzyaacn6(5)=30.d0*xyzzyaaba6*xyzzyaaav6
xyzzyaacn6(6)=15.d0*xyzzyaabd6-45.d0*xyzzyaabh6
xyzzyaacn6(7)=45.d0*xyzzyaabg6-15.d0*xyzzyaabe6
xyzzyaacm6=c_prim(xyzzyaaal6)*xyzzyaacp6
do xyzzyaaam6=1,7
xyzzyaacn6(xyzzyaaam6)=xyzzyaacn6(xyzzyaaam6)*xyzzyaacm6
enddo
case(6)
xyzzyaaba6=xyzzyaaat6*xyzzyaaau6
xyzzyaabc6=xyzzyaaat6*xyzzyaaav6
xyzzyaabb6=xyzzyaaau6*xyzzyaaav6
xyzzyaabm6=xyzzyaaaw6*xyzzyaaaw6
xyzzyaabn6=xyzzyaaax6*xyzzyaaax6
xyzzyaabo6=xyzzyaaay6*xyzzyaaay6
xyzzyaabp6=xyzzyaaaw6*xyzzyaaax6
xyzzyaabq6=xyzzyaaaw6*xyzzyaaay6
xyzzyaabr6=xyzzyaaax6*xyzzyaaay6
xyzzyaabs6=xyzzyaaaw6*xyzzyaabc6
xyzzyaabt6=xyzzyaaba6*xyzzyaabb6
xyzzyaabu6=xyzzyaabc6*xyzzyaaay6
xyzzyaabv6=xyzzyaaba6*xyzzyaabc6
xyzzyaabw6=xyzzyaaax6*xyzzyaabb6
xyzzyaabx6=xyzzyaabb6*xyzzyaaay6
xyzzyaaby6=xyzzyaaaw6*xyzzyaaba6
xyzzyaabz6=xyzzyaaba6*xyzzyaaax6
xyzzyaaca6=xyzzyaaba6*xyzzyaaay6
xyzzyaacb6=xyzzyaabm6+xyzzyaabn6
xyzzyaacc6=xyzzyaabo6-3.d0*(xyzzyaabq6+xyzzyaabr6)
xyzzyaacd6=0.375d0*xyzzyaacb6
xyzzyaace6=0.75d0*xyzzyaabp6
xyzzyaacn6(1)=(xyzzyaacc6+xyzzyaacd6+xyzzyaace6)
xyzzyaacf6=7.5d0*(xyzzyaabs6+xyzzyaabt6)
xyzzyaacn6(2)=10.d0*xyzzyaabu6-xyzzyaacf6
xyzzyaacg6=7.5d0*(xyzzyaabv6+xyzzyaabw6)
xyzzyaacn6(3)=10.d0*xyzzyaabx6-xyzzyaacg6
xyzzyaach6=45.d0*(xyzzyaabq6-xyzzyaabr6)
xyzzyaaci6=7.5d0*(xyzzyaabn6-xyzzyaabm6)
xyzzyaacn6(4)=xyzzyaach6+xyzzyaaci6
xyzzyaacj6=15.d0*(xyzzyaaby6+xyzzyaabz6)
xyzzyaacn6(5)=90.d0*xyzzyaaca6-xyzzyaacj6
xyzzyaack6=315.d0*xyzzyaabt6
xyzzyaacn6(6)=105.d0*xyzzyaabs6-xyzzyaack6
xyzzyaacl6=315.d0*xyzzyaabv6
xyzzyaacn6(7)=xyzzyaacl6-105.d0*xyzzyaabw6
xyzzyaacn6(8)=105.d0*xyzzyaacb6-630.d0*xyzzyaabp6
xyzzyaacn6(9)=420.d0*(xyzzyaaby6-xyzzyaabz6)
xyzzyaacm6=c_prim(xyzzyaaal6)*xyzzyaacp6
do xyzzyaaam6=1,9
xyzzyaacn6(xyzzyaaam6)=xyzzyaacn6(xyzzyaaam6)*xyzzyaacm6
enddo
end select
xyzzyaaan6=xyzzyaaai6+1
xyzzyaaao6=xyzzyaaai6+xyzzyaaah6
ao_m(xyzzyaaan6:xyzzyaaao6)=ao_m(xyzzyaaan6:xyzzyaaao6)+xyzzyaacn6(1:x&
&yzzyaaah6)
enddo
if(xyzzyaacu6)then
do xyzzyaaam6=1,xyzzyaaah6
xyzzyaaaq6(xyzzyaaap6+xyzzyaaam6)=xyzzyaaai6+xyzzyaaam6
enddo
xyzzyaaap6=xyzzyaaap6+xyzzyaaah6
endif
enddo
endif
enddo
if(use_gpcc)call cusp_wfdet_real(rvec,jspin,.true.,.false.,cusp_val_r,&
&cusp_grad_r,cusp_lap_r)
xyzzyaaar6=gauss_offset(jspin)
xyzzyaaas6=nuc_nele(jspin)
orbval(xyzzyaaar6:xyzzyaaar6-1+xyzzyaaas6,1)=multi_ddot_s(xyzzyaaas6,x&
&yzzyaaap6,xyzzyaaaq6,orbmask(xyzzyaaar6),rck(:,:,:,xyzzyaaac1),size_r&
&ck,maxb,ao_m,rnorm)
if(use_gpcc)then
do xyzzyaaam6=1,gauss_gs_norb
if(.not.orbmask(xyzzyaaam6))cycle
orbval(xyzzyaaam6,1)=orbval(xyzzyaaam6,1)+cusp_val_r(xyzzyaaam6)
enddo
endif
if(excite)then
do xyzzyaaam6=1,gauss_ex_norb
xyzzyaaad6=gauss_gs_norb+xyzzyaaam6
if(.not.orbmask(xyzzyaaad6))cycle
xyzzyaaac6=full2vrt(xyzzyaaam6,jspin)
psi(xyzzyaaam6)=sum(ao_m(:)*rck_ex(:,xyzzyaaac6,jspin))*rnorm
if(use_gpcc)psi(xyzzyaaam6)=psi(xyzzyaaam6)+cusp_val_r(xyzzyaaad6)
enddo
if(cusp_correction)then
do xyzzyaaab6=1,num_centres
if(is_ae(xyzzyaaab6))then
xyzzyaaat6=rion(1,xyzzyaaab6)
xyzzyaaau6=rion(2,xyzzyaaab6)
xyzzyaaav6=rion(3,xyzzyaaab6)
xyzzyaaat6=rvec(1)-xyzzyaaat6
xyzzyaaau6=rvec(2)-xyzzyaaau6
xyzzyaaav6=rvec(3)-xyzzyaaav6
xyzzyaaaz6=xyzzyaaat6*xyzzyaaat6+xyzzyaaau6*xyzzyaaau6+xyzzyaaav6*xyzz&
&yaaav6
do xyzzyaaam6=1,num_unique_orbitals(jspin)
xyzzyaacr6=rcusp_sq(xyzzyaaam6,xyzzyaaab6,xyzzyaaad1)
if(xyzzyaaaz6<xyzzyaacr6)then
xyzzyaacq6=sqrt(xyzzyaaaz6)
xyzzyaaah1=xyzzyaaam6>nuc_nele(jspin)
if(xyzzyaaah1)then
xyzzyaaab1=xyzzyaaam6-nuc_nele(jspin)
call wfdet_s(xyzzyaacq6,0,3.d0,xyzzyaaab1,xyzzyaaab6,jspin,1,1,1,.true&
&.,xyzzyaaac1,xyzzyaaae1,xyzzyaaag1,xyzzyaaaf1)
else
call wfdet_s(xyzzyaacq6,0,3.d0,xyzzyaaam6,xyzzyaaab6,jspin,1,1,1,.fals&
&e.,xyzzyaaac1,xyzzyaaae1,xyzzyaaag1,xyzzyaaaf1)
endif
xyzzyaacs6=acusp(1,xyzzyaaam6,xyzzyaaab6,xyzzyaaad1)
xyzzyaact6=1.d0
do xyzzyaaad6=2,5
xyzzyaact6=xyzzyaact6*xyzzyaacq6
xyzzyaacs6=xyzzyaacs6+acusp(xyzzyaaad6,xyzzyaaam6,xyzzyaaab6,xyzzyaaad&
&1)*xyzzyaact6
enddo
if(xyzzyaaah1)then
xyzzyaaac6=vrt2full(xyzzyaaab1,jspin)
psi(xyzzyaaac6)=psi(xyzzyaaac6)-xyzzyaaae1(1)+disign(xyzzyaaam6,xyzzya&
&aab6,xyzzyaaad1)*exp(xyzzyaacs6)+pshift(xyzzyaaam6,xyzzyaaab6,xyzzyaa&
&ad1)
else
xyzzyaaac6=xyzzyaaam6+gauss_offset(jspin)-1
orbval(xyzzyaaac6,1)=orbval(xyzzyaaac6,1)-xyzzyaaae1(1)+disign(xyzzyaa&
&am6,xyzzyaaab6,xyzzyaaad1)*exp(xyzzyaacs6)+pshift(xyzzyaaam6,xyzzyaaa&
&b6,xyzzyaaad1)
endif
endif
enddo
endif
enddo
endif
do xyzzyaaam6=1,gauss_ex_norb
xyzzyaaad6=gauss_gs_norb+xyzzyaaam6
if(.not.orbmask(xyzzyaaad6))cycle
orbval(xyzzyaaad6,1)=psi(xyzzyaaam6)
enddo
else
if(cusp_correction)then
do xyzzyaaab6=1,num_centres
if(is_ae(xyzzyaaab6))then
xyzzyaaat6=rion(1,xyzzyaaab6)
xyzzyaaau6=rion(2,xyzzyaaab6)
xyzzyaaav6=rion(3,xyzzyaaab6)
xyzzyaaat6=rvec(1)-xyzzyaaat6
xyzzyaaau6=rvec(2)-xyzzyaaau6
xyzzyaaav6=rvec(3)-xyzzyaaav6
xyzzyaaaz6=xyzzyaaat6*xyzzyaaat6+xyzzyaaau6*xyzzyaaau6+xyzzyaaav6*xyzz&
&yaaav6
do xyzzyaaam6=1,num_unique_orbitals(jspin)
xyzzyaacr6=rcusp_sq(xyzzyaaam6,xyzzyaaab6,xyzzyaaad1)
if(xyzzyaaaz6<xyzzyaacr6)then
xyzzyaacq6=sqrt(xyzzyaaaz6)
call wfdet_s(xyzzyaacq6,0,3.d0,xyzzyaaam6,xyzzyaaab6,jspin,1,1,1,.fals&
&e.,xyzzyaaac1,xyzzyaaae1,xyzzyaaag1,xyzzyaaaf1)
xyzzyaacs6=acusp(1,xyzzyaaam6,xyzzyaaab6,xyzzyaaad1)
xyzzyaact6=1.d0
do xyzzyaaad6=2,5
xyzzyaact6=xyzzyaact6*xyzzyaacq6
xyzzyaacs6=xyzzyaacs6+acusp(xyzzyaaad6,xyzzyaaam6,xyzzyaaab6,xyzzyaaad&
&1)*xyzzyaact6
enddo
xyzzyaaac6=xyzzyaaam6+gauss_offset(jspin)-1
orbval(xyzzyaaac6,1)=orbval(xyzzyaaac6,1)-xyzzyaaae1(1)+disign(xyzzyaa&
&am6,xyzzyaaab6,xyzzyaaad1)*exp(xyzzyaacs6)+pshift(xyzzyaaam6,xyzzyaaa&
&b6,xyzzyaaad1)
endif
enddo
endif
enddo
endif
endif
end subroutine xyzzyaaal1
subroutine xyzzyaaam1(rvec,jspin,norb,orbmask,orbgrad,orblap)
implicit none
integer,intent(in) :: jspin,norb
real(dp),intent(in) :: rvec(3)
real(dp),intent(inout) :: orbgrad(3,norb,real1_complex2),orblap(norb,r&
&eal1_complex2)
logical,intent(in) :: orbmask(norb)
integer xyzzyaaaa7,xyzzyaaab7,xyzzyaaac7,xyzzyaaad7,xyzzyaaae7,xyzzyaa&
&af7,xyzzyaaag7,xyzzyaaah7,xyzzyaaai7,xyzzyaaaj7,xyzzyaaak7,xyzzyaaal7&
&,xyzzyaaam7,xyzzyaaan7,xyzzyaaao7,xyzzyaaap7,xyzzyaaaq7,xyzzyaaar7(nu&
&m_ao),xyzzyaaas7,xyzzyaaat7,xyzzyaaau7
real(dp) xyzzyaaav7,xyzzyaaaw7,xyzzyaaax7,xyzzyaaay7,xyzzyaaaz7,xyzzya&
&aba7,xyzzyaabb7,xyzzyaabc7,xyzzyaabd7,xyzzyaabe7,xyzzyaabf7,xyzzyaabg&
&7,xyzzyaabh7,xyzzyaabi7,xyzzyaabj7,xyzzyaabk7,xyzzyaabl7,xyzzyaabm7,x&
&yzzyaabn7,xyzzyaabo7,xyzzyaabp7,xyzzyaabq7,xyzzyaabr7,xyzzyaabs7,xyzz&
&yaabt7,xyzzyaabu7,xyzzyaabv7,xyzzyaabw7,xyzzyaabx7,xyzzyaaby7,xyzzyaa&
&bz7,xyzzyaaca7,xyzzyaacb7,xyzzyaacc7,xyzzyaacd7,xyzzyaace7,xyzzyaacf7&
&,xyzzyaacg7,xyzzyaach7,xyzzyaaci7,xyzzyaacj7,xyzzyaack7,xyzzyaacl7,xy&
&zzyaacm7,xyzzyaacn7,xyzzyaaco7,xyzzyaacp7,xyzzyaacq7,xyzzyaacr7,xyzzy&
&aacs7,xyzzyaact7,xyzzyaacu7,xyzzyaacv7,xyzzyaacw7,xyzzyaacx7,xyzzyaac&
&y7,xyzzyaacz7,xyzzyaada7,xyzzyaadb7,xyzzyaadc7,xyzzyaadd7,xyzzyaade7,&
&xyzzyaadf7,xyzzyaadg7,xyzzyaadh7,xyzzyaadi7,xyzzyaadj7,xyzzyaadk7,xyz&
&zyaadl7,xyzzyaadm7,xyzzyaadn7,xyzzyaado7,xyzzyaadp7,xyzzyaadq7,xyzzya&
&adr7(9),xyzzyaads7(9),xyzzyaadt7(27),xyzzyaadu7,xyzzyaadv7,xyzzyaadw7&
&,xyzzyaadx7,xyzzyaady7,xyzzyaadz7,xyzzyaaea7,xyzzyaaeb7,xyzzyaaec7,xy&
&zzyaaed7,xyzzyaaee7,xyzzyaaef7,xyzzyaaeg7,xyzzyaaeh7,xyzzyaaei7,xyzzy&
&aaej7
logical xyzzyaaek7
xyzzyaaaa7=0
alap_m=0.d0
agra1_m=0.d0
agra2_m=0.d0
agra3_m=0.d0
xyzzyaaaq7=0
do xyzzyaaab7=1,num_centres
xyzzyaaac7=num_shells_on_centre(xyzzyaaab7,xyzzyaaaa1)
if(xyzzyaaac7>0)then
xyzzyaaaw7=rion(1,xyzzyaaab7)
xyzzyaaax7=rion(2,xyzzyaaab7)
xyzzyaaay7=rion(3,xyzzyaaab7)
xyzzyaaaw7=rvec(1)-xyzzyaaaw7
xyzzyaaax7=rvec(2)-xyzzyaaax7
xyzzyaaay7=rvec(3)-xyzzyaaay7
xyzzyaaaz7=xyzzyaaaw7*xyzzyaaaw7
xyzzyaaba7=xyzzyaaax7*xyzzyaaax7
xyzzyaabb7=xyzzyaaay7*xyzzyaaay7
xyzzyaaav7=xyzzyaaaz7+xyzzyaaba7+xyzzyaabb7
do xyzzyaaad7=1,xyzzyaaac7
xyzzyaaaa7=xyzzyaaaa7+1
xyzzyaaae7=shell_sequence_mol(xyzzyaaaa7,xyzzyaaaa1)
xyzzyaadm7=min_exponent(xyzzyaaae7)
xyzzyaacu7=xyzzyaadm7*xyzzyaaav7
if(xyzzyaacu7>screening_tolerance)cycle
xyzzyaaaf7=shell_am(xyzzyaaae7)
xyzzyaaag7=first_ao(xyzzyaaae7)-1
xyzzyaaah7=numao_in_shell(xyzzyaaae7)
xyzzyaaai7=xyzzyaaah7*3
xyzzyaaaj7=primitive(xyzzyaaae7)
xyzzyaaak7=primitive(xyzzyaaae7+1)-1
xyzzyaaek7=.false.
do xyzzyaaal7=xyzzyaaaj7,xyzzyaaak7
xyzzyaadm7=exponent(xyzzyaaal7)
xyzzyaacu7=xyzzyaadm7*xyzzyaaav7
if(xyzzyaacu7>30.d0)cycle
xyzzyaaek7=.true.
xyzzyaadn7=exp(-xyzzyaacu7)
xyzzyaach7=-xyzzyaadm7-xyzzyaadm7
select case (xyzzyaaaf7)
case(1)
xyzzyaado7=c_prim(xyzzyaaal7)*xyzzyaadn7*xyzzyaach7
xyzzyaadt7(1)=xyzzyaaaw7*xyzzyaado7
xyzzyaadt7(2)=xyzzyaaax7*xyzzyaado7
xyzzyaadt7(3)=xyzzyaaay7*xyzzyaado7
xyzzyaacu7=3.d0+xyzzyaach7*xyzzyaaav7
xyzzyaads7(1)=xyzzyaacu7*xyzzyaado7
case(2)
xyzzyaadt7(1)=xyzzyaach7*xyzzyaaaw7
xyzzyaadt7(2)=xyzzyaach7*xyzzyaaax7
xyzzyaadt7(3)=xyzzyaach7*xyzzyaaay7
xyzzyaadt7(4)=1.d0+xyzzyaadt7(1)*xyzzyaaaw7
xyzzyaadt7(5)=xyzzyaadt7(1)*xyzzyaaax7
xyzzyaadt7(6)=xyzzyaadt7(1)*xyzzyaaay7
xyzzyaadt7(8)=1.d0+xyzzyaadt7(2)*xyzzyaaax7
xyzzyaadt7(9)=xyzzyaadt7(2)*xyzzyaaay7
xyzzyaadt7(7)=xyzzyaadt7(5)
xyzzyaadt7(10)=xyzzyaadt7(6)
xyzzyaadt7(11)=xyzzyaadt7(9)
xyzzyaadt7(12)=1.d0+xyzzyaadt7(3)*xyzzyaaay7
xyzzyaado7=c_prim(xyzzyaaal7)*xyzzyaadn7
xyzzyaadp7=c_prim2(xyzzyaaal7)*xyzzyaadn7
xyzzyaadt7(1:3)=xyzzyaadt7(1:3)*xyzzyaado7
xyzzyaadt7(4:12)=xyzzyaadt7(4:12)*xyzzyaadp7
xyzzyaacu7=3.d0+xyzzyaach7*xyzzyaaav7
xyzzyaacv7=xyzzyaach7*xyzzyaacu7
xyzzyaacw7=(xyzzyaacv7+2.d0*xyzzyaach7)*xyzzyaadp7
xyzzyaads7(1)=xyzzyaacv7*xyzzyaado7
xyzzyaads7(2)=xyzzyaacw7*xyzzyaaaw7
xyzzyaads7(3)=xyzzyaacw7*xyzzyaaax7
xyzzyaads7(4)=xyzzyaacw7*xyzzyaaay7
case(3)
xyzzyaaci7=xyzzyaach7*xyzzyaaaw7
xyzzyaacj7=xyzzyaach7*xyzzyaaax7
xyzzyaack7=xyzzyaach7*xyzzyaaay7
xyzzyaacx7=xyzzyaach7*(5+xyzzyaach7*xyzzyaaav7)
xyzzyaadt7(1)=1.d0+xyzzyaaci7*xyzzyaaaw7
xyzzyaadt7(2)=xyzzyaaci7*xyzzyaaax7
xyzzyaadt7(3)=xyzzyaaci7*xyzzyaaay7
xyzzyaadt7(5)=1.d0+xyzzyaacj7*xyzzyaaax7
xyzzyaadt7(6)=xyzzyaacj7*xyzzyaaay7
xyzzyaadt7(9)=1.d0+xyzzyaack7*xyzzyaaay7
xyzzyaadt7(4)=xyzzyaadt7(2)
xyzzyaadt7(7)=xyzzyaadt7(3)
xyzzyaadt7(8)=xyzzyaadt7(6)
xyzzyaads7(1)=xyzzyaacx7*xyzzyaaaw7
xyzzyaads7(2)=xyzzyaacx7*xyzzyaaax7
xyzzyaads7(3)=xyzzyaacx7*xyzzyaaay7
xyzzyaadp7=c_prim(xyzzyaaal7)*xyzzyaadn7
xyzzyaadt7(1:9)=xyzzyaadt7(1:9)*xyzzyaadp7
xyzzyaads7(1:3)=xyzzyaads7(1:3)*xyzzyaadp7
case(4)
xyzzyaabc7=xyzzyaaaw7*xyzzyaaax7
xyzzyaabd7=xyzzyaaax7*xyzzyaaay7
xyzzyaabe7=xyzzyaaaw7*xyzzyaaay7
xyzzyaabz7=xyzzyaaaz7-xyzzyaaba7
xyzzyaabf7=3.d0*xyzzyaabb7-xyzzyaaav7
xyzzyaaci7=xyzzyaach7*xyzzyaaaw7
xyzzyaacj7=xyzzyaach7*xyzzyaaax7
xyzzyaack7=xyzzyaach7*xyzzyaaay7
xyzzyaacu7=1.d0+xyzzyaaci7*xyzzyaaaw7
xyzzyaacv7=1.d0+xyzzyaacj7*xyzzyaaax7
xyzzyaacw7=1.d0+xyzzyaack7*xyzzyaaay7
xyzzyaacx7=xyzzyaach7*xyzzyaabf7-2.d0
xyzzyaacy7=xyzzyaach7*xyzzyaabz7
xyzzyaadt7(1)=xyzzyaacx7*xyzzyaaaw7
xyzzyaadt7(2)=xyzzyaacx7*xyzzyaaax7
xyzzyaadt7(3)=(xyzzyaacx7+6.d0)*xyzzyaaay7
xyzzyaadt7(4)=xyzzyaacu7*xyzzyaaay7
xyzzyaadt7(5)=xyzzyaaci7*xyzzyaabd7
xyzzyaadt7(6)=xyzzyaacw7*xyzzyaaaw7
xyzzyaadt7(7)=xyzzyaadt7(5)
xyzzyaadt7(8)=xyzzyaacv7*xyzzyaaay7
xyzzyaadt7(9)=xyzzyaacw7*xyzzyaaax7
xyzzyaadt7(10)=(2.d0+xyzzyaach7*xyzzyaabz7)*xyzzyaaaw7
xyzzyaadt7(11)=(xyzzyaacy7-2.d0)*xyzzyaaax7
xyzzyaadt7(12)=xyzzyaacy7*xyzzyaaay7
xyzzyaadt7(13)=xyzzyaacu7*xyzzyaaax7
xyzzyaadt7(14)=xyzzyaacv7*xyzzyaaaw7
xyzzyaadt7(15)=xyzzyaadt7(5)
xyzzyaadq7=c_prim(xyzzyaaal7)*xyzzyaadn7
xyzzyaadt7(1:15)=xyzzyaadt7(1:15)*xyzzyaadq7
xyzzyaacu7=7.d0+xyzzyaach7*xyzzyaaav7
xyzzyaacu7=xyzzyaach7*xyzzyaacu7*xyzzyaadq7
xyzzyaads7(1)=xyzzyaacu7*xyzzyaabf7
xyzzyaads7(2)=xyzzyaacu7*xyzzyaabe7
xyzzyaads7(3)=xyzzyaacu7*xyzzyaabd7
xyzzyaads7(4)=xyzzyaacu7*xyzzyaabz7
xyzzyaads7(5)=xyzzyaacu7*xyzzyaabc7
case(5)
xyzzyaabc7=xyzzyaaaw7*xyzzyaaax7
xyzzyaabe7=xyzzyaaaw7*xyzzyaaay7
xyzzyaabd7=xyzzyaaax7*xyzzyaaay7
xyzzyaabt7=xyzzyaabc7*xyzzyaaay7
xyzzyaaby7=xyzzyaaaz7+xyzzyaaba7
xyzzyaaca7=xyzzyaaba7-xyzzyaaaz7
xyzzyaacb7=2.d0*xyzzyaadm7
xyzzyaacc7=3.d0*xyzzyaadm7
xyzzyaacd7=xyzzyaacb7*xyzzyaaaz7
xyzzyaace7=xyzzyaacb7*xyzzyaaba7
xyzzyaacf7=xyzzyaacb7*xyzzyaabb7
xyzzyaacg7=4.d0*xyzzyaabb7
xyzzyaadl7=2.d0*xyzzyaadm7*xyzzyaaav7-9.d0
xyzzyaabu7=3.d0*xyzzyaaaz7
xyzzyaabv7=3.d0*xyzzyaaba7
xyzzyaacw7=xyzzyaabu7+xyzzyaabv7-(2.d0*xyzzyaabb7)
xyzzyaacv7=xyzzyaadm7*xyzzyaacw7-3.d0
xyzzyaadt7(1)=xyzzyaabe7*xyzzyaacv7
xyzzyaadt7(2)=xyzzyaabd7*xyzzyaacv7
xyzzyaads7(1)=(-xyzzyaadm7)*xyzzyaaay7*xyzzyaacw7*xyzzyaadl7
xyzzyaacw7=6.d0*xyzzyaabb7
xyzzyaacx7=xyzzyaadm7*xyzzyaacw7-3.d0
xyzzyaacy7=2.d0*xyzzyaacf7*xyzzyaabb7
xyzzyaadt7(3)=0.5d0*(xyzzyaacw7-xyzzyaacy7+xyzzyaaby7*xyzzyaacx7)
xyzzyaacz7=xyzzyaacd7*xyzzyaaaz7-xyzzyaaba7+xyzzyaacg7
xyzzyaada7=xyzzyaacb7*(xyzzyaaba7-xyzzyaacg7)-3
xyzzyaadt7(4)=1.5d0*(xyzzyaacz7+xyzzyaaaz7*xyzzyaada7)
xyzzyaada7=xyzzyaacc7*(xyzzyaaby7-xyzzyaacg7)
xyzzyaadt7(5)=xyzzyaabc7*(xyzzyaada7-3.d0)
xyzzyaadt7(6)=xyzzyaabe7*(xyzzyaada7+12.d0)
xyzzyaads7(2)=(-xyzzyaaaw7)*xyzzyaada7*xyzzyaadl7
xyzzyaadt7(7)=xyzzyaadt7(5)
xyzzyaadt7(9)=xyzzyaabd7*(xyzzyaada7+12.d0)
xyzzyaadc7=xyzzyaace7*xyzzyaaba7+xyzzyaaaz7*(xyzzyaace7-1.d0)
xyzzyaadd7=xyzzyaaba7*(3.d0+8.d0*xyzzyaadm7*xyzzyaabb7)
xyzzyaadt7(8)=1.5d0*(xyzzyaadc7-xyzzyaadd7+xyzzyaacg7)
xyzzyaads7(3)=(-xyzzyaaax7)*xyzzyaada7*xyzzyaadl7
xyzzyaade7=xyzzyaadm7*xyzzyaaca7
xyzzyaadt7(10)=30.d0*xyzzyaabe7*(xyzzyaade7+1.d0)
xyzzyaadt7(11)=30.d0*xyzzyaabd7*(xyzzyaade7-1.d0)
xyzzyaadt7(12)=15.d0*xyzzyaaca7*(xyzzyaacf7-1.d0)
xyzzyaads7(4)=-30.d0*xyzzyaaay7*xyzzyaade7*xyzzyaadl7
xyzzyaadt7(13)=30.d0*(1.d0-xyzzyaacd7)*xyzzyaabd7
xyzzyaadt7(14)=30.d0*(1.d0-xyzzyaace7)*xyzzyaabe7
xyzzyaadt7(15)=30.d0*(1.d0-xyzzyaacf7)*xyzzyaabc7
xyzzyaads7(5)=30.d0*xyzzyaacb7*xyzzyaabt7*xyzzyaadl7
xyzzyaadf7=xyzzyaabu7*(1+xyzzyaace7)
xyzzyaadg7=xyzzyaacd7*xyzzyaaaz7+xyzzyaabv7
xyzzyaadt7(16)=-15.d0*(xyzzyaadg7-xyzzyaadf7)
xyzzyaadh7=(-30.d0)*xyzzyaadm7*(xyzzyaaaz7-xyzzyaabv7)
xyzzyaadt7(17)=xyzzyaabc7*(xyzzyaadh7-90.d0)
xyzzyaadt7(18)=xyzzyaabe7*xyzzyaadh7
xyzzyaads7(6)=(-xyzzyaaaw7)*xyzzyaadh7*xyzzyaadl7
xyzzyaadi7=30.d0*xyzzyaadm7*(xyzzyaaba7-xyzzyaabu7)
xyzzyaadj7=xyzzyaaaz7*(6.d0*xyzzyaadm7*xyzzyaaba7-3.d0)
xyzzyaadk7=xyzzyaaba7*(xyzzyaace7-3.d0)
xyzzyaadt7(19)=xyzzyaabc7*(90.d0+xyzzyaadi7)
xyzzyaadt7(20)=15.d0*(xyzzyaadk7-xyzzyaadj7)
xyzzyaadt7(21)=xyzzyaabd7*xyzzyaadi7
xyzzyaads7(7)=(-xyzzyaaax7)*xyzzyaadi7*xyzzyaadl7
xyzzyaadq7=c_prim(xyzzyaaal7)*xyzzyaadn7
do xyzzyaaam7=1,21
xyzzyaadt7(xyzzyaaam7)=xyzzyaadt7(xyzzyaaam7)*xyzzyaadq7
enddo
do xyzzyaaam7=1,7
xyzzyaads7(xyzzyaaam7)=xyzzyaads7(xyzzyaaam7)*xyzzyaadq7
enddo
case(6)
xyzzyaabc7=xyzzyaaaw7*xyzzyaaax7
xyzzyaabe7=xyzzyaaaw7*xyzzyaaay7
xyzzyaabd7=xyzzyaaax7*xyzzyaaay7
xyzzyaabt7=xyzzyaabc7*xyzzyaaay7
xyzzyaabg7=xyzzyaaaz7*xyzzyaaaz7
xyzzyaabh7=xyzzyaaba7*xyzzyaaba7
xyzzyaabi7=xyzzyaabb7*xyzzyaabb7
xyzzyaabj7=xyzzyaaaz7*xyzzyaaba7
xyzzyaabk7=xyzzyaaaz7*xyzzyaabb7
xyzzyaabl7=xyzzyaaba7*xyzzyaabb7
xyzzyaabm7=xyzzyaaaz7*xyzzyaabe7
xyzzyaabn7=xyzzyaabc7*xyzzyaabd7
xyzzyaabo7=xyzzyaabe7*xyzzyaabb7
xyzzyaabp7=xyzzyaabc7*xyzzyaabe7
xyzzyaabw7=xyzzyaaba7*xyzzyaabd7
xyzzyaabq7=xyzzyaabd7*xyzzyaabb7
xyzzyaabr7=xyzzyaaaz7*xyzzyaabc7
xyzzyaabx7=xyzzyaabc7*xyzzyaaba7
xyzzyaabs7=xyzzyaabc7*xyzzyaabb7
xyzzyaacl7=xyzzyaabg7+xyzzyaabh7
xyzzyaabz7=xyzzyaaaz7-xyzzyaaba7
xyzzyaaby7=xyzzyaaaz7+xyzzyaaba7
xyzzyaacb7=2.d0*xyzzyaadm7
xyzzyaacc7=3.d0*xyzzyaadm7
xyzzyaacm7=xyzzyaadm7*xyzzyaaaz7
xyzzyaacn7=xyzzyaadm7*xyzzyaaba7
xyzzyaaco7=xyzzyaadm7*xyzzyaabb7
xyzzyaace7=2.d0*xyzzyaacn7
xyzzyaacr7=4.d0*xyzzyaaco7
xyzzyaacs7=8.d0*xyzzyaaco7
xyzzyaact7=6.d0*xyzzyaacn7
xyzzyaacp7=xyzzyaadm7*xyzzyaabg7
xyzzyaacq7=xyzzyaadm7*xyzzyaabh7
xyzzyaacu7=xyzzyaabi7-3.d0*(xyzzyaabk7+xyzzyaabl7)
xyzzyaacv7=0.375d0*xyzzyaacl7
xyzzyaacw7=0.75d0*xyzzyaabj7
xyzzyaadr7(1)=(xyzzyaacu7+xyzzyaacv7+xyzzyaacw7)
xyzzyaacx7=7.5d0*(xyzzyaabm7+xyzzyaabn7)
xyzzyaadr7(2)=10.d0*xyzzyaabo7-xyzzyaacx7
xyzzyaacy7=7.5d0*(xyzzyaabp7+xyzzyaabw7)
xyzzyaadr7(3)=10.d0*xyzzyaabq7-xyzzyaacy7
xyzzyaacz7=45.d0*(xyzzyaabk7-xyzzyaabl7)
xyzzyaada7=7.5d0*(xyzzyaabh7-xyzzyaabg7)
xyzzyaadr7(4)=xyzzyaacz7+xyzzyaada7
xyzzyaadb7=15.d0*(xyzzyaabr7+xyzzyaabx7)
xyzzyaadr7(5)=90.d0*xyzzyaabs7-xyzzyaadb7
xyzzyaadc7=315.d0*xyzzyaabn7
xyzzyaadr7(6)=105.d0*xyzzyaabm7-xyzzyaadc7
xyzzyaadd7=315.d0*xyzzyaabp7
xyzzyaadr7(7)=xyzzyaadd7-105.d0*xyzzyaabw7
xyzzyaadr7(8)=105.d0*xyzzyaacl7-630.d0*xyzzyaabj7
xyzzyaadr7(9)=420.d0*(xyzzyaabr7-xyzzyaabx7)
xyzzyaadq7=c_prim(xyzzyaaal7)*xyzzyaadn7
do xyzzyaaam7=1,9
xyzzyaadr7(xyzzyaaam7)=xyzzyaadr7(xyzzyaaam7)*xyzzyaadq7
enddo
xyzzyaadl7=xyzzyaacb7*(xyzzyaacb7*xyzzyaaav7-11.d0)
do xyzzyaaam7=1,9
xyzzyaads7(xyzzyaaam7)=xyzzyaadr7(xyzzyaaam7)*xyzzyaadl7
enddo
xyzzyaade7=xyzzyaacc7*xyzzyaacl7
xyzzyaadf7=xyzzyaabb7*(24.d0+xyzzyaacs7)
xyzzyaadg7=6.d0*xyzzyaaba7*(1.d0+xyzzyaacr7)
xyzzyaadh7=6.d0*xyzzyaaaz7*(xyzzyaacn7+xyzzyaacr7-1.d0)
xyzzyaadi7=-0.25d0*(xyzzyaade7+xyzzyaadf7-xyzzyaadg7+xyzzyaadh7)
xyzzyaadt7(1)=xyzzyaaaw7*xyzzyaadi7
xyzzyaadt7(2)=xyzzyaaax7*xyzzyaadi7
xyzzyaadf7=8.d0*xyzzyaabb7*(xyzzyaaco7-2.d0)
xyzzyaadg7=24.d0*xyzzyaaba7*(xyzzyaaco7-1.d0)
xyzzyaadh7=xyzzyaadh7+30.d0*xyzzyaaaz7
xyzzyaadi7=xyzzyaade7+xyzzyaadf7-xyzzyaadg7+xyzzyaadh7
xyzzyaadt7(3)=-0.25d0*xyzzyaaay7*xyzzyaadi7
xyzzyaadf7=6.d0*xyzzyaacp7-3.d0*xyzzyaaba7+4.d0*xyzzyaabb7
xyzzyaadg7=9.d0-xyzzyaact7+xyzzyaacs7
xyzzyaadt7(4)=2.5d0*xyzzyaaay7*(xyzzyaadf7-xyzzyaaaz7*xyzzyaadg7)
xyzzyaadg7=3.d0*xyzzyaaby7-4.d0*xyzzyaabb7
xyzzyaadt7(5)=5.d0*xyzzyaabt7*(xyzzyaadm7*xyzzyaadg7-3.d0)
xyzzyaadh7=xyzzyaabb7*(12.d0-xyzzyaacs7)
xyzzyaadi7=xyzzyaaby7*(6.d0*xyzzyaaco7-3.d0)
xyzzyaadi7=2.5d0*(xyzzyaadi7+xyzzyaadh7)
xyzzyaadt7(6)=xyzzyaaaw7*xyzzyaadi7
xyzzyaadt7(7)=xyzzyaadt7(5)
xyzzyaadt7(9)=xyzzyaaax7*xyzzyaadi7
xyzzyaadf7=6.d0*xyzzyaacq7-xyzzyaaaz7*(3.d0-xyzzyaact7)
xyzzyaadg7=4.d0*xyzzyaabb7-xyzzyaaba7*(9.d0+xyzzyaacs7)
xyzzyaadt7(8)=2.5d0*xyzzyaaay7*(xyzzyaadf7+xyzzyaadg7)
xyzzyaadh7=xyzzyaacp7-xyzzyaacq7
xyzzyaadi7=6.d0*(xyzzyaabb7+xyzzyaadm7*xyzzyaabl7)
xyzzyaadj7=2.d0*xyzzyaaaz7*(1.d0+3.d0*xyzzyaaco7)
xyzzyaadt7(10)=15.d0*xyzzyaaaw7*(xyzzyaadh7+xyzzyaadi7-xyzzyaadj7)
xyzzyaade7=6.d0*xyzzyaabb7
xyzzyaadf7=xyzzyaadm7*(xyzzyaaby7-xyzzyaade7)
xyzzyaadg7=2.d0*xyzzyaaba7-xyzzyaade7
xyzzyaadt7(11)=15.d0*xyzzyaaax7*(xyzzyaadf7*xyzzyaabz7+xyzzyaadg7)
xyzzyaadf7=xyzzyaadf7+6.d0
xyzzyaadt7(12)=15.d0*xyzzyaaay7*xyzzyaabz7*xyzzyaadf7
xyzzyaadt7(15)=30.d0*xyzzyaabt7*xyzzyaadf7
xyzzyaadg7=2.d0*xyzzyaacp7-xyzzyaaba7+xyzzyaade7
xyzzyaadh7=xyzzyaacb7*(xyzzyaaba7-xyzzyaade7)-3.d0
xyzzyaadt7(13)=15.d0*xyzzyaaax7*(xyzzyaadg7+xyzzyaaaz7*xyzzyaadh7)
xyzzyaadi7=2.d0*xyzzyaacq7+xyzzyaaaz7*(2.d0*xyzzyaacn7-1.d0)
xyzzyaadj7=xyzzyaade7-3.d0*xyzzyaaba7*(1.d0+4.d0*xyzzyaaco7)
xyzzyaadt7(14)=15.d0*xyzzyaaaw7*(xyzzyaadi7+xyzzyaadj7)
xyzzyaade7=105.d0*xyzzyaaay7
xyzzyaadf7=3.d0*xyzzyaaaz7*(1.d0+xyzzyaace7)
xyzzyaadf7=xyzzyaadf7-2.d0*xyzzyaacp7-3.d0*xyzzyaaba7
xyzzyaadt7(16)=xyzzyaade7*xyzzyaadf7
xyzzyaadg7=xyzzyaaaz7-3.d0*xyzzyaaba7
xyzzyaadh7=1.d0-2.d0*xyzzyaaco7
xyzzyaadi7=210.d0*xyzzyaabt7
xyzzyaadt7(17)=(-xyzzyaadi7)*(3.d0+xyzzyaadm7*xyzzyaadg7)
xyzzyaadt7(18)=105.d0*xyzzyaaaw7*xyzzyaadg7*xyzzyaadh7
xyzzyaadt7(19)=xyzzyaadi7*(3.d0-3.d0*xyzzyaacm7+xyzzyaacn7)
xyzzyaadj7=xyzzyaaaz7*(xyzzyaact7-3.d0)
xyzzyaadt7(20)=xyzzyaade7*(2.d0*xyzzyaacq7-3.d0*xyzzyaaba7-xyzzyaadj7)
xyzzyaadg7=xyzzyaaba7-3.d0*xyzzyaaaz7
xyzzyaadh7=2.d0*xyzzyaaco7-1.d0
xyzzyaadt7(21)=105.d0*xyzzyaaax7*xyzzyaadg7*xyzzyaadh7
xyzzyaade7=2.d0*xyzzyaaaz7*(1+3.d0*xyzzyaacn7)
xyzzyaadf7=xyzzyaacp7+xyzzyaaba7*(6.d0+xyzzyaacn7)
xyzzyaadt7(22)=210.d0*xyzzyaaaw7*(xyzzyaade7-xyzzyaadf7)
xyzzyaadg7=xyzzyaaba7*(xyzzyaacn7-2.d0)
xyzzyaadh7=xyzzyaacp7+6.d0*xyzzyaaaz7*(1.d0-xyzzyaacn7)
xyzzyaadt7(23)=-210.d0*xyzzyaaax7*(xyzzyaadg7+xyzzyaadh7)
xyzzyaadi7=6.d0*xyzzyaabj7-xyzzyaacl7
xyzzyaadt7(24)=210.d0*xyzzyaadm7*xyzzyaaay7*xyzzyaadi7
xyzzyaadj7=xyzzyaaaz7*(3.d0+xyzzyaace7)
xyzzyaadk7=2.d0*xyzzyaacp7+xyzzyaaba7
xyzzyaadt7(25)=420.d0*xyzzyaaax7*(xyzzyaadj7-xyzzyaadk7)
xyzzyaadh7=2.d0*xyzzyaacq7-3.d0*xyzzyaaba7
xyzzyaadi7=xyzzyaaaz7*(xyzzyaace7-1.d0)
xyzzyaadt7(26)=420.d0*xyzzyaaaw7*(xyzzyaadh7-xyzzyaadi7)
xyzzyaadt7(27)=840.d0*xyzzyaadm7*xyzzyaabt7*(xyzzyaaaz7-xyzzyaaba7)
do xyzzyaaam7=1,27
xyzzyaadt7(xyzzyaaam7)=xyzzyaadt7(xyzzyaaam7)*xyzzyaadq7
enddo
end select
xyzzyaaao7=xyzzyaaag7+1
xyzzyaaap7=xyzzyaaag7+xyzzyaaah7
alap_m(xyzzyaaao7:xyzzyaaap7)=alap_m(xyzzyaaao7:xyzzyaaap7)+xyzzyaads7&
&(1:xyzzyaaah7)
agra1_m(xyzzyaaao7:xyzzyaaap7)=agra1_m(xyzzyaaao7:xyzzyaaap7)+xyzzyaad&
&t7(1:xyzzyaaai7:3)
agra2_m(xyzzyaaao7:xyzzyaaap7)=agra2_m(xyzzyaaao7:xyzzyaaap7)+xyzzyaad&
&t7(2:xyzzyaaai7:3)
agra3_m(xyzzyaaao7:xyzzyaaap7)=agra3_m(xyzzyaaao7:xyzzyaaap7)+xyzzyaad&
&t7(3:xyzzyaaai7:3)
enddo
if(xyzzyaaek7)then
do xyzzyaaam7=1,xyzzyaaah7
xyzzyaaar7(xyzzyaaaq7+xyzzyaaam7)=xyzzyaaag7+xyzzyaaam7
enddo
xyzzyaaaq7=xyzzyaaaq7+xyzzyaaah7
endif
enddo
endif
enddo
if(use_gpcc)call cusp_wfdet_real(rvec,jspin,.false.,.true.,cusp_val_r,&
&cusp_grad_r,cusp_lap_r)
xyzzyaaas7=gauss_offset(jspin)
xyzzyaaau7=nuc_nele(jspin)
xyzzyaaat7=xyzzyaaas7-1+xyzzyaaau7
orbgrad(1,xyzzyaaas7:xyzzyaaat7,1)=multi_ddot_s(xyzzyaaau7,xyzzyaaaq7,&
&xyzzyaaar7,orbmask(xyzzyaaas7),rck(:,:,:,xyzzyaaac1),size_rck,maxb,ag&
&ra1_m,rnorm)
orbgrad(2,xyzzyaaas7:xyzzyaaat7,1)=multi_ddot_s(xyzzyaaau7,xyzzyaaaq7,&
&xyzzyaaar7,orbmask(xyzzyaaas7),rck(:,:,:,xyzzyaaac1),size_rck,maxb,ag&
&ra2_m,rnorm)
orbgrad(3,xyzzyaaas7:xyzzyaaat7,1)=multi_ddot_s(xyzzyaaau7,xyzzyaaaq7,&
&xyzzyaaar7,orbmask(xyzzyaaas7),rck(:,:,:,xyzzyaaac1),size_rck,maxb,ag&
&ra3_m,rnorm)
orblap(xyzzyaaas7:xyzzyaaat7,1)=multi_ddot_s(xyzzyaaau7,xyzzyaaaq7,xyz&
&zyaaar7,orbmask(xyzzyaaas7),rck(:,:,:,xyzzyaaac1),size_rck,maxb,alap_&
&m,rnorm)
if(use_gpcc)then
do xyzzyaaam7=1,gauss_gs_norb
if(.not.orbmask(xyzzyaaam7))cycle
orbgrad(:,xyzzyaaam7,1)=orbgrad(:,xyzzyaaam7,1)+cusp_grad_r(:,xyzzyaaa&
&m7)
orblap(xyzzyaaam7,1)=orblap(xyzzyaaam7,1)+cusp_lap_r(xyzzyaaam7)
enddo
endif
if(excite)then
do xyzzyaaam7=1,gauss_ex_norb
xyzzyaaan7=gauss_gs_norb+xyzzyaaam7
if(.not.orbmask(xyzzyaaan7))cycle
xyzzyaaac7=full2vrt(xyzzyaaam7,jspin)
flap(xyzzyaaam7)=sum(alap_m(:)*rck_ex(:,xyzzyaaac7,jspin))*rnorm
fgra1(xyzzyaaam7)=sum(agra1_m(:)*rck_ex(:,xyzzyaaac7,jspin))*rnorm
fgra2(xyzzyaaam7)=sum(agra2_m(:)*rck_ex(:,xyzzyaaac7,jspin))*rnorm
fgra3(xyzzyaaam7)=sum(agra3_m(:)*rck_ex(:,xyzzyaaac7,jspin))*rnorm
if(use_gpcc)then
flap(xyzzyaaam7)=flap(xyzzyaaam7)+cusp_lap_r(xyzzyaaan7)
fgra1(xyzzyaaam7)=fgra1(xyzzyaaam7)+cusp_grad_r(1,xyzzyaaan7)
fgra2(xyzzyaaam7)=fgra2(xyzzyaaam7)+cusp_grad_r(2,xyzzyaaan7)
fgra3(xyzzyaaam7)=fgra3(xyzzyaaam7)+cusp_grad_r(3,xyzzyaaan7)
endif
enddo
if(cusp_correction)then
do xyzzyaaab7=1,num_centres
if(is_ae(xyzzyaaab7))then
xyzzyaaaw7=rion(1,xyzzyaaab7)
xyzzyaaax7=rion(2,xyzzyaaab7)
xyzzyaaay7=rion(3,xyzzyaaab7)
xyzzyaaaw7=rvec(1)-xyzzyaaaw7
xyzzyaaax7=rvec(2)-xyzzyaaax7
xyzzyaaay7=rvec(3)-xyzzyaaay7
xyzzyaaav7=xyzzyaaaw7*xyzzyaaaw7+xyzzyaaax7*xyzzyaaax7+xyzzyaaay7*xyzz&
&yaaay7
do xyzzyaaam7=1,num_unique_orbitals(jspin)
xyzzyaadu7=rcusp_sq(xyzzyaaam7,xyzzyaaab7,xyzzyaaad1)
if(xyzzyaaav7<xyzzyaadu7)then
if(xyzzyaaav7/=0.d0)then
xyzzyaadv7=sqrt(xyzzyaaav7)
xyzzyaadz7=1.d0/xyzzyaadv7
xyzzyaaea7=2.d0*xyzzyaadz7
xyzzyaaeb7=xyzzyaaaw7*xyzzyaadz7
xyzzyaaec7=xyzzyaaax7*xyzzyaadz7
xyzzyaaed7=xyzzyaaay7*xyzzyaadz7
else
xyzzyaadv7=0.d0
xyzzyaaea7=2.d0
xyzzyaaeb7=1.d0
xyzzyaaec7=1.d0
xyzzyaaed7=1.d0
endif
xyzzyaaah1=xyzzyaaam7>nuc_nele(jspin)
if(xyzzyaaah1)then
xyzzyaaab1=xyzzyaaam7-nuc_nele(jspin)
call wfdet_s(xyzzyaadv7,1,3.d0,xyzzyaaab1,xyzzyaaab7,jspin,1,1,1,.true&
&.,xyzzyaaac1,xyzzyaaae1,xyzzyaaag1,xyzzyaaaf1)
else
call wfdet_s(xyzzyaadv7,1,3.d0,xyzzyaaam7,xyzzyaaab7,jspin,1,1,1,.fals&
&e.,xyzzyaaac1,xyzzyaaae1,xyzzyaaag1,xyzzyaaaf1)
endif
xyzzyaaef7=acusp(1,xyzzyaaam7,xyzzyaaab7,xyzzyaaad1)
xyzzyaaeg7=acusp(2,xyzzyaaam7,xyzzyaaab7,xyzzyaaad1)
xyzzyaaeh7=acusp(3,xyzzyaaam7,xyzzyaaab7,xyzzyaaad1)
xyzzyaaei7=acusp(4,xyzzyaaam7,xyzzyaaab7,xyzzyaaad1)
xyzzyaaej7=acusp(5,xyzzyaaam7,xyzzyaaab7,xyzzyaaad1)
xyzzyaadw7=xyzzyaaef7+xyzzyaaeg7*xyzzyaadv7
xyzzyaadx7=xyzzyaaeg7+2.d0*xyzzyaaeh7*xyzzyaadv7
xyzzyaady7=2.d0*xyzzyaaeh7+6.d0*xyzzyaaei7*xyzzyaadv7
xyzzyaaee7=xyzzyaadv7*xyzzyaadv7
xyzzyaadw7=xyzzyaadw7+xyzzyaaeh7*xyzzyaaee7
xyzzyaadx7=xyzzyaadx7+3.d0*xyzzyaaei7*xyzzyaaee7
xyzzyaady7=xyzzyaady7+12.d0*xyzzyaaej7*xyzzyaaee7
xyzzyaaee7=xyzzyaaee7*xyzzyaadv7
xyzzyaadw7=xyzzyaadw7+xyzzyaaei7*xyzzyaaee7
xyzzyaadx7=xyzzyaadx7+4.d0*xyzzyaaej7*xyzzyaaee7
xyzzyaaee7=xyzzyaaee7*xyzzyaadv7
xyzzyaadw7=xyzzyaadw7+xyzzyaaej7*xyzzyaaee7
xyzzyaacu7=disign(xyzzyaaam7,xyzzyaaab7,xyzzyaaad1)*exp(xyzzyaadw7)+ps&
&hift(xyzzyaaam7,xyzzyaaab7,xyzzyaaad1)
xyzzyaacv7=xyzzyaacu7*xyzzyaadx7
xyzzyaacw7=(xyzzyaaea7+xyzzyaadx7)*xyzzyaadx7+xyzzyaady7
if(xyzzyaaah1)then
xyzzyaaac7=vrt2full(xyzzyaaab1,jspin)
fgra1(xyzzyaaac7)=fgra1(xyzzyaaac7)+(xyzzyaacv7-xyzzyaaag1(1))*xyzzyaa&
&eb7
fgra2(xyzzyaaac7)=fgra2(xyzzyaaac7)+(xyzzyaacv7-xyzzyaaag1(1))*xyzzyaa&
&ec7
fgra3(xyzzyaaac7)=fgra3(xyzzyaaac7)+(xyzzyaacv7-xyzzyaaag1(1))*xyzzyaa&
&ed7
flap(xyzzyaaac7)=flap(xyzzyaaac7)-xyzzyaaaf1(1)+xyzzyaacu7*xyzzyaacw7
else
xyzzyaaac7=xyzzyaaam7+gauss_offset(jspin)-1
orbgrad(1,xyzzyaaac7,1)=orbgrad(1,xyzzyaaac7,1)+(xyzzyaacv7-xyzzyaaag1&
&(1))*xyzzyaaeb7
orbgrad(2,xyzzyaaac7,1)=orbgrad(2,xyzzyaaac7,1)+(xyzzyaacv7-xyzzyaaag1&
&(1))*xyzzyaaec7
orbgrad(3,xyzzyaaac7,1)=orbgrad(3,xyzzyaaac7,1)+(xyzzyaacv7-xyzzyaaag1&
&(1))*xyzzyaaed7
orblap(xyzzyaaac7,1)=orblap(xyzzyaaac7,1)-xyzzyaaaf1(1)+xyzzyaacu7*xyz&
&zyaacw7
endif
endif
enddo
endif
enddo
endif
do xyzzyaaam7=1,gauss_ex_norb
xyzzyaaan7=gauss_gs_norb+xyzzyaaam7
if(.not.orbmask(xyzzyaaan7))cycle
orbgrad(1,xyzzyaaan7,1)=fgra1(xyzzyaaam7)
orbgrad(2,xyzzyaaan7,1)=fgra2(xyzzyaaam7)
orbgrad(3,xyzzyaaan7,1)=fgra3(xyzzyaaam7)
orblap(xyzzyaaan7,1)=flap(xyzzyaaam7)
enddo
else
if(cusp_correction)then
do xyzzyaaab7=1,num_centres
if(is_ae(xyzzyaaab7))then
xyzzyaaaw7=rion(1,xyzzyaaab7)
xyzzyaaax7=rion(2,xyzzyaaab7)
xyzzyaaay7=rion(3,xyzzyaaab7)
xyzzyaaaw7=rvec(1)-xyzzyaaaw7
xyzzyaaax7=rvec(2)-xyzzyaaax7
xyzzyaaay7=rvec(3)-xyzzyaaay7
xyzzyaaav7=xyzzyaaaw7*xyzzyaaaw7+xyzzyaaax7*xyzzyaaax7+xyzzyaaay7*xyzz&
&yaaay7
do xyzzyaaam7=1,num_unique_orbitals(jspin)
xyzzyaadu7=rcusp_sq(xyzzyaaam7,xyzzyaaab7,xyzzyaaad1)
if(xyzzyaaav7<xyzzyaadu7)then
if(xyzzyaaav7/=0.d0)then
xyzzyaadv7=sqrt(xyzzyaaav7)
xyzzyaadz7=1.d0/xyzzyaadv7
xyzzyaaea7=2.d0*xyzzyaadz7
xyzzyaaeb7=xyzzyaaaw7*xyzzyaadz7
xyzzyaaec7=xyzzyaaax7*xyzzyaadz7
xyzzyaaed7=xyzzyaaay7*xyzzyaadz7
else
xyzzyaadv7=0.d0
xyzzyaaea7=2.d0
xyzzyaaeb7=1.d0
xyzzyaaec7=1.d0
xyzzyaaed7=1.d0
endif
call wfdet_s(xyzzyaadv7,1,3.d0,xyzzyaaam7,xyzzyaaab7,jspin,1,1,1,.fals&
&e.,xyzzyaaac1,xyzzyaaae1,xyzzyaaag1,xyzzyaaaf1)
xyzzyaaef7=acusp(1,xyzzyaaam7,xyzzyaaab7,xyzzyaaad1)
xyzzyaaeg7=acusp(2,xyzzyaaam7,xyzzyaaab7,xyzzyaaad1)
xyzzyaaeh7=acusp(3,xyzzyaaam7,xyzzyaaab7,xyzzyaaad1)
xyzzyaaei7=acusp(4,xyzzyaaam7,xyzzyaaab7,xyzzyaaad1)
xyzzyaaej7=acusp(5,xyzzyaaam7,xyzzyaaab7,xyzzyaaad1)
xyzzyaadw7=xyzzyaaef7+xyzzyaaeg7*xyzzyaadv7
xyzzyaadx7=xyzzyaaeg7+2.d0*xyzzyaaeh7*xyzzyaadv7
xyzzyaady7=2.d0*xyzzyaaeh7+6.d0*xyzzyaaei7*xyzzyaadv7
xyzzyaaee7=xyzzyaadv7*xyzzyaadv7
xyzzyaadw7=xyzzyaadw7+xyzzyaaeh7*xyzzyaaee7
xyzzyaadx7=xyzzyaadx7+3.d0*xyzzyaaei7*xyzzyaaee7
xyzzyaady7=xyzzyaady7+12.d0*xyzzyaaej7*xyzzyaaee7
xyzzyaaee7=xyzzyaaee7*xyzzyaadv7
xyzzyaadw7=xyzzyaadw7+xyzzyaaei7*xyzzyaaee7
xyzzyaadx7=xyzzyaadx7+4.d0*xyzzyaaej7*xyzzyaaee7
xyzzyaaee7=xyzzyaaee7*xyzzyaadv7
xyzzyaadw7=xyzzyaadw7+xyzzyaaej7*xyzzyaaee7
xyzzyaacu7=disign(xyzzyaaam7,xyzzyaaab7,xyzzyaaad1)*exp(xyzzyaadw7)+ps&
&hift(xyzzyaaam7,xyzzyaaab7,xyzzyaaad1)
xyzzyaacv7=xyzzyaacu7*xyzzyaadx7
xyzzyaacw7=(xyzzyaaea7+xyzzyaadx7)*xyzzyaadx7+xyzzyaady7
xyzzyaaac7=xyzzyaaam7+gauss_offset(jspin)-1
orbgrad(1,xyzzyaaac7,1)=orbgrad(1,xyzzyaaac7,1)+(xyzzyaacv7-xyzzyaaag1&
&(1))*xyzzyaaeb7
orbgrad(2,xyzzyaaac7,1)=orbgrad(2,xyzzyaaac7,1)+(xyzzyaacv7-xyzzyaaag1&
&(1))*xyzzyaaec7
orbgrad(3,xyzzyaaac7,1)=orbgrad(3,xyzzyaaac7,1)+(xyzzyaacv7-xyzzyaaag1&
&(1))*xyzzyaaed7
orblap(xyzzyaaac7,1)=orblap(xyzzyaaac7,1)-xyzzyaaaf1(1)+xyzzyaacu7*xyz&
&zyaacw7
endif
enddo
endif
enddo
endif
endif
end subroutine xyzzyaaam1
subroutine xyzzyaaan1(rvec,jspin,norb,orbmask,orbval,orbgrad,orblap)
implicit none
integer,intent(in) :: jspin,norb
real(dp),intent(in) :: rvec(3)
real(dp),intent(inout) :: orbval(norb,real1_complex2),orbgrad(3,norb,r&
&eal1_complex2),orblap(norb,real1_complex2)
logical,intent(in) :: orbmask(norb)
integer xyzzyaaaa8,xyzzyaaab8,xyzzyaaac8,xyzzyaaad8,xyzzyaaae8,xyzzyaa&
&af8,xyzzyaaag8,xyzzyaaah8,xyzzyaaai8,xyzzyaaaj8,xyzzyaaak8,xyzzyaaal8&
&,xyzzyaaam8,xyzzyaaan8,xyzzyaaao8,xyzzyaaap8,xyzzyaaaq8,xyzzyaaar8(nu&
&m_ao),xyzzyaaas8,xyzzyaaat8,xyzzyaaau8
real(dp) xyzzyaaav8,xyzzyaaaw8,xyzzyaaax8,xyzzyaaay8,xyzzyaaaz8,xyzzya&
&aba8,xyzzyaabb8,xyzzyaabc8,xyzzyaabd8,xyzzyaabe8,xyzzyaabf8,xyzzyaabg&
&8,xyzzyaabh8,xyzzyaabi8,xyzzyaabj8,xyzzyaabk8,xyzzyaabl8,xyzzyaabm8,x&
&yzzyaabn8,xyzzyaabo8,xyzzyaabp8,xyzzyaabq8,xyzzyaabr8,xyzzyaabs8,xyzz&
&yaabt8,xyzzyaabu8,xyzzyaabv8,xyzzyaabw8,xyzzyaabx8,xyzzyaaby8,xyzzyaa&
&bz8,xyzzyaaca8,xyzzyaacb8,xyzzyaacc8,xyzzyaacd8,xyzzyaace8,xyzzyaacf8&
&,xyzzyaacg8,xyzzyaach8,xyzzyaaci8,xyzzyaacj8,xyzzyaack8,xyzzyaacl8,xy&
&zzyaacm8,xyzzyaacn8,xyzzyaaco8,xyzzyaacp8,xyzzyaacq8,xyzzyaacr8,xyzzy&
&aacs8,xyzzyaact8,xyzzyaacu8,xyzzyaacv8,xyzzyaacw8,xyzzyaacx8,xyzzyaac&
&y8,xyzzyaacz8,xyzzyaada8,xyzzyaadb8,xyzzyaadc8,xyzzyaadd8,xyzzyaade8,&
&xyzzyaadf8,xyzzyaadg8,xyzzyaadh8,xyzzyaadi8,xyzzyaadj8,xyzzyaadk8,xyz&
&zyaadl8,xyzzyaadm8,xyzzyaadn8,xyzzyaado8,xyzzyaadp8,xyzzyaadq8,xyzzya&
&adr8,xyzzyaads8,xyzzyaadt8,xyzzyaadu8,xyzzyaadv8,xyzzyaadw8,xyzzyaadx&
&8,xyzzyaady8,xyzzyaadz8,xyzzyaaea8(9),xyzzyaaeb8(9),xyzzyaaec8(27),xy&
&zzyaaed8,xyzzyaaee8,xyzzyaaef8,xyzzyaaeg8,xyzzyaaeh8,xyzzyaaei8,xyzzy&
&aaej8,xyzzyaaek8,xyzzyaael8,xyzzyaaem8,xyzzyaaen8,xyzzyaaeo8,xyzzyaae&
&p8,xyzzyaaeq8,xyzzyaaer8,xyzzyaaes8
logical xyzzyaaet8
xyzzyaaaa8=0
ao_m=0.d0
alap_m=0.d0
agra1_m=0.d0
agra2_m=0.d0
agra3_m=0.d0
xyzzyaaaq8=0
do xyzzyaaab8=1,num_centres
xyzzyaaac8=num_shells_on_centre(xyzzyaaab8,xyzzyaaaa1)
if(xyzzyaaac8>0)then
xyzzyaaaw8=rion(1,xyzzyaaab8)
xyzzyaaax8=rion(2,xyzzyaaab8)
xyzzyaaay8=rion(3,xyzzyaaab8)
xyzzyaaaw8=rvec(1)-xyzzyaaaw8
xyzzyaaax8=rvec(2)-xyzzyaaax8
xyzzyaaay8=rvec(3)-xyzzyaaay8
xyzzyaaaz8=xyzzyaaaw8*xyzzyaaaw8
xyzzyaaba8=xyzzyaaax8*xyzzyaaax8
xyzzyaabb8=xyzzyaaay8*xyzzyaaay8
xyzzyaaav8=xyzzyaaaz8+xyzzyaaba8+xyzzyaabb8
do xyzzyaaad8=1,xyzzyaaac8
xyzzyaaaa8=xyzzyaaaa8+1
xyzzyaaae8=shell_sequence_mol(xyzzyaaaa8,xyzzyaaaa1)
xyzzyaadv8=min_exponent(xyzzyaaae8)
xyzzyaadd8=xyzzyaadv8*xyzzyaaav8
if(xyzzyaadd8>screening_tolerance)cycle
xyzzyaaaf8=shell_am(xyzzyaaae8)
xyzzyaaag8=first_ao(xyzzyaaae8)-1
xyzzyaaah8=numao_in_shell(xyzzyaaae8)
xyzzyaaai8=xyzzyaaah8*3
xyzzyaaaj8=primitive(xyzzyaaae8)
xyzzyaaak8=primitive(xyzzyaaae8+1)-1
xyzzyaaet8=.false.
do xyzzyaaal8=xyzzyaaaj8,xyzzyaaak8
xyzzyaadv8=exponent(xyzzyaaal8)
xyzzyaadd8=xyzzyaadv8*xyzzyaaav8
if(xyzzyaadd8>30.d0)cycle
xyzzyaaet8=.true.
xyzzyaadw8=exp(-xyzzyaadd8)
xyzzyaacq8=-xyzzyaadv8-xyzzyaadv8
select case (xyzzyaaaf8)
case(1)
xyzzyaaea8(1)=c_prim(xyzzyaaal8)*xyzzyaadw8
xyzzyaadx8=xyzzyaaea8(1)*xyzzyaacq8
xyzzyaaec8(1)=xyzzyaaaw8*xyzzyaadx8
xyzzyaaec8(2)=xyzzyaaax8*xyzzyaadx8
xyzzyaaec8(3)=xyzzyaaay8*xyzzyaadx8
xyzzyaadd8=3.d0+xyzzyaacq8*xyzzyaaav8
xyzzyaaeb8(1)=xyzzyaadd8*xyzzyaadx8
case(2)
xyzzyaadx8=c_prim(xyzzyaaal8)*xyzzyaadw8
xyzzyaady8=c_prim2(xyzzyaaal8)*xyzzyaadw8
xyzzyaaea8(1)=xyzzyaadx8
xyzzyaaea8(2)=xyzzyaady8*xyzzyaaaw8
xyzzyaaea8(3)=xyzzyaady8*xyzzyaaax8
xyzzyaaea8(4)=xyzzyaady8*xyzzyaaay8
xyzzyaaec8(1)=xyzzyaacq8*xyzzyaaaw8
xyzzyaaec8(2)=xyzzyaacq8*xyzzyaaax8
xyzzyaaec8(3)=xyzzyaacq8*xyzzyaaay8
xyzzyaaec8(4)=1.d0+xyzzyaaec8(1)*xyzzyaaaw8
xyzzyaaec8(5)=xyzzyaaec8(1)*xyzzyaaax8
xyzzyaaec8(6)=xyzzyaaec8(1)*xyzzyaaay8
xyzzyaaec8(8)=1.d0+xyzzyaaec8(2)*xyzzyaaax8
xyzzyaaec8(9)=xyzzyaaec8(2)*xyzzyaaay8
xyzzyaaec8(7)=xyzzyaaec8(5)
xyzzyaaec8(10)=xyzzyaaec8(6)
xyzzyaaec8(11)=xyzzyaaec8(9)
xyzzyaaec8(12)=1.d0+xyzzyaaec8(3)*xyzzyaaay8
xyzzyaaec8(1:3)=xyzzyaaec8(1:3)*xyzzyaadx8
xyzzyaaec8(4:12)=xyzzyaaec8(4:12)*xyzzyaady8
xyzzyaadd8=3.d0+xyzzyaacq8*xyzzyaaav8
xyzzyaade8=xyzzyaacq8*xyzzyaadd8
xyzzyaadf8=(xyzzyaade8+2.d0*xyzzyaacq8)*xyzzyaady8
xyzzyaaeb8(1)=xyzzyaade8*xyzzyaadx8
xyzzyaaeb8(2)=xyzzyaadf8*xyzzyaaaw8
xyzzyaaeb8(3)=xyzzyaadf8*xyzzyaaax8
xyzzyaaeb8(4)=xyzzyaadf8*xyzzyaaay8
case(3)
xyzzyaady8=c_prim(xyzzyaaal8)*xyzzyaadw8
xyzzyaaea8(1)=xyzzyaady8*xyzzyaaaw8
xyzzyaaea8(2)=xyzzyaady8*xyzzyaaax8
xyzzyaaea8(3)=xyzzyaady8*xyzzyaaay8
xyzzyaacr8=xyzzyaacq8*xyzzyaaaw8
xyzzyaacs8=xyzzyaacq8*xyzzyaaax8
xyzzyaact8=xyzzyaacq8*xyzzyaaay8
xyzzyaadg8=xyzzyaacq8*(5+xyzzyaacq8*xyzzyaaav8)
xyzzyaaec8(1)=1.d0+xyzzyaacr8*xyzzyaaaw8
xyzzyaaec8(2)=xyzzyaacr8*xyzzyaaax8
xyzzyaaec8(3)=xyzzyaacr8*xyzzyaaay8
xyzzyaaec8(5)=1.d0+xyzzyaacs8*xyzzyaaax8
xyzzyaaec8(6)=xyzzyaacs8*xyzzyaaay8
xyzzyaaec8(9)=1.d0+xyzzyaact8*xyzzyaaay8
xyzzyaaec8(4)=xyzzyaaec8(2)
xyzzyaaec8(7)=xyzzyaaec8(3)
xyzzyaaec8(8)=xyzzyaaec8(6)
xyzzyaaeb8(1)=xyzzyaadg8*xyzzyaaaw8
xyzzyaaeb8(2)=xyzzyaadg8*xyzzyaaax8
xyzzyaaeb8(3)=xyzzyaadg8*xyzzyaaay8
do xyzzyaaam8=1,9
xyzzyaaec8(xyzzyaaam8)=xyzzyaaec8(xyzzyaaam8)*xyzzyaady8
enddo
do xyzzyaaam8=1,3
xyzzyaaeb8(xyzzyaaam8)=xyzzyaaeb8(xyzzyaaam8)*xyzzyaady8
enddo
case(4)
xyzzyaabc8=xyzzyaaaw8*xyzzyaaax8
xyzzyaabd8=xyzzyaaax8*xyzzyaaay8
xyzzyaabe8=xyzzyaaaw8*xyzzyaaay8
xyzzyaaci8=xyzzyaaaz8-xyzzyaaba8
xyzzyaabf8=3.d0*xyzzyaabb8-xyzzyaaav8
xyzzyaaea8(1)=xyzzyaabf8
xyzzyaaea8(2)=xyzzyaabe8
xyzzyaaea8(3)=xyzzyaabd8
xyzzyaaea8(4)=xyzzyaaci8
xyzzyaaea8(5)=xyzzyaabc8
xyzzyaadz8=c_prim(xyzzyaaal8)*xyzzyaadw8
xyzzyaaea8(1:5)=xyzzyaaea8(1:5)*xyzzyaadz8
xyzzyaadu8=7.d0+xyzzyaacq8*xyzzyaaav8
xyzzyaadu8=xyzzyaacq8*xyzzyaadu8
xyzzyaaeb8(1:5)=xyzzyaaea8(1:5)*xyzzyaadu8
xyzzyaacr8=xyzzyaacq8*xyzzyaaaw8
xyzzyaacs8=xyzzyaacq8*xyzzyaaax8
xyzzyaact8=xyzzyaacq8*xyzzyaaay8
xyzzyaadd8=1.d0+xyzzyaacr8*xyzzyaaaw8
xyzzyaade8=1.d0+xyzzyaacs8*xyzzyaaax8
xyzzyaadf8=1.d0+xyzzyaact8*xyzzyaaay8
xyzzyaadg8=xyzzyaacq8*xyzzyaabf8-2.d0
xyzzyaadh8=xyzzyaacq8*xyzzyaaci8
xyzzyaaec8(1)=xyzzyaadg8*xyzzyaaaw8
xyzzyaaec8(2)=xyzzyaadg8*xyzzyaaax8
xyzzyaaec8(3)=(xyzzyaadg8+6.d0)*xyzzyaaay8
xyzzyaaec8(4)=xyzzyaadd8*xyzzyaaay8
xyzzyaaec8(5)=xyzzyaacr8*xyzzyaabd8
xyzzyaaec8(6)=xyzzyaadf8*xyzzyaaaw8
xyzzyaaec8(7)=xyzzyaaec8(5)
xyzzyaaec8(8)=xyzzyaade8*xyzzyaaay8
xyzzyaaec8(9)=xyzzyaadf8*xyzzyaaax8
xyzzyaaec8(10)=(2.d0+xyzzyaacq8*xyzzyaaci8)*xyzzyaaaw8
xyzzyaaec8(11)=(xyzzyaadh8-2.d0)*xyzzyaaax8
xyzzyaaec8(12)=xyzzyaadh8*xyzzyaaay8
xyzzyaaec8(13)=xyzzyaadd8*xyzzyaaax8
xyzzyaaec8(14)=xyzzyaade8*xyzzyaaaw8
xyzzyaaec8(15)=xyzzyaaec8(5)
do xyzzyaaam8=1,15
xyzzyaaec8(xyzzyaaam8)=xyzzyaaec8(xyzzyaaam8)*xyzzyaadz8
enddo
case(5)
xyzzyaabg8=xyzzyaaaz8*xyzzyaaaw8
xyzzyaabh8=xyzzyaaba8*xyzzyaaax8
xyzzyaabi8=xyzzyaabb8*xyzzyaaay8
xyzzyaabc8=xyzzyaaaw8*xyzzyaaax8
xyzzyaabe8=xyzzyaaaw8*xyzzyaaay8
xyzzyaabd8=xyzzyaaax8*xyzzyaaay8
xyzzyaabj8=xyzzyaabc8*xyzzyaaaw8
xyzzyaabk8=xyzzyaabc8*xyzzyaaax8
xyzzyaabn8=xyzzyaabe8*xyzzyaaaw8
xyzzyaabo8=xyzzyaabe8*xyzzyaaay8
xyzzyaabl8=xyzzyaabd8*xyzzyaaax8
xyzzyaabm8=xyzzyaabd8*xyzzyaaay8
xyzzyaace8=xyzzyaabc8*xyzzyaaay8
xyzzyaach8=xyzzyaaaz8+xyzzyaaba8
xyzzyaacj8=xyzzyaaba8-xyzzyaaaz8
xyzzyaacf8=3.d0*xyzzyaaaz8
xyzzyaacg8=3.d0*xyzzyaaba8
xyzzyaack8=2.d0*xyzzyaadv8
xyzzyaacl8=3.d0*xyzzyaadv8
xyzzyaacm8=xyzzyaack8*xyzzyaaaz8
xyzzyaacn8=xyzzyaack8*xyzzyaaba8
xyzzyaaco8=xyzzyaack8*xyzzyaabb8
xyzzyaacp8=4.d0*xyzzyaabb8
xyzzyaaea8(1)=xyzzyaabi8-1.5d0*(xyzzyaabn8+xyzzyaabl8)
xyzzyaaea8(2)=6.d0*xyzzyaabo8-1.5d0*(xyzzyaabg8+xyzzyaabk8)
xyzzyaaea8(3)=6.d0*xyzzyaabm8-1.5d0*(xyzzyaabj8+xyzzyaabh8)
xyzzyaaea8(4)=15.d0*(xyzzyaabn8-xyzzyaabl8)
xyzzyaaea8(5)=30.d0*xyzzyaace8
xyzzyaaea8(6)=15.d0*xyzzyaabg8-45.d0*xyzzyaabk8
xyzzyaaea8(7)=45.d0*xyzzyaabj8-15.d0*xyzzyaabh8
xyzzyaadz8=c_prim(xyzzyaaal8)*xyzzyaadw8
xyzzyaaea8(1:7)=xyzzyaaea8(1:7)*xyzzyaadz8
xyzzyaadu8=xyzzyaack8*(xyzzyaack8*xyzzyaaav8-9.d0)
xyzzyaaeb8(1:7)=xyzzyaaea8(1:7)*xyzzyaadu8
xyzzyaade8=xyzzyaacf8+xyzzyaacg8-(2.d0*xyzzyaabb8)
xyzzyaade8=xyzzyaadv8*xyzzyaade8-3.d0
xyzzyaaec8(1)=xyzzyaabe8*xyzzyaade8
xyzzyaaec8(2)=xyzzyaabd8*xyzzyaade8
xyzzyaadf8=6.d0*xyzzyaabb8
xyzzyaadg8=xyzzyaadv8*xyzzyaadf8-3.d0
xyzzyaadh8=2.d0*xyzzyaaco8*xyzzyaabb8
xyzzyaaec8(3)=0.5d0*(xyzzyaadf8-xyzzyaadh8+xyzzyaach8*xyzzyaadg8)
xyzzyaadi8=xyzzyaacm8*xyzzyaaaz8-xyzzyaaba8+xyzzyaacp8
xyzzyaadj8=xyzzyaack8*(xyzzyaaba8-xyzzyaacp8)-3
xyzzyaaec8(4)=1.5d0*(xyzzyaadi8+xyzzyaaaz8*xyzzyaadj8)
xyzzyaadj8=xyzzyaacl8*(xyzzyaach8-xyzzyaacp8)
xyzzyaaec8(5)=xyzzyaabc8*(xyzzyaadj8-3.d0)
xyzzyaaec8(6)=xyzzyaabe8*(xyzzyaadj8+12.d0)
xyzzyaaec8(7)=xyzzyaaec8(5)
xyzzyaaec8(9)=xyzzyaabd8*(xyzzyaadj8+12.d0)
xyzzyaadl8=xyzzyaacn8*xyzzyaaba8+xyzzyaaaz8*(xyzzyaacn8-1.d0)
xyzzyaadm8=xyzzyaaba8*(3.d0+8.d0*xyzzyaadv8*xyzzyaabb8)
xyzzyaaec8(8)=1.5d0*(xyzzyaadl8-xyzzyaadm8+xyzzyaacp8)
xyzzyaadn8=xyzzyaadv8*xyzzyaacj8
xyzzyaaec8(10)=30.d0*xyzzyaabe8*(xyzzyaadn8+1.d0)
xyzzyaaec8(11)=30.d0*xyzzyaabd8*(xyzzyaadn8-1.d0)
xyzzyaaec8(12)=15.d0*xyzzyaacj8*(xyzzyaaco8-1.d0)
xyzzyaaec8(13)=30.d0*(1.d0-xyzzyaacm8)*xyzzyaabd8
xyzzyaaec8(14)=30.d0*(1.d0-xyzzyaacn8)*xyzzyaabe8
xyzzyaaec8(15)=30.d0*(1.d0-xyzzyaaco8)*xyzzyaabc8
xyzzyaado8=xyzzyaacf8*(1+xyzzyaacn8)
xyzzyaadp8=xyzzyaacm8*xyzzyaaaz8+xyzzyaacg8
xyzzyaaec8(16)=-15.d0*(xyzzyaadp8-xyzzyaado8)
xyzzyaadq8=(-30.d0)*xyzzyaadv8*(xyzzyaaaz8-xyzzyaacg8)
xyzzyaaec8(17)=xyzzyaabc8*(xyzzyaadq8-90.d0)
xyzzyaaec8(18)=xyzzyaabe8*xyzzyaadq8
xyzzyaadr8=30.d0*xyzzyaadv8*(xyzzyaaba8-xyzzyaacf8)
xyzzyaads8=xyzzyaaaz8*(6.d0*xyzzyaadv8*xyzzyaaba8-3.d0)
xyzzyaadt8=xyzzyaaba8*(xyzzyaacn8-3.d0)
xyzzyaaec8(19)=xyzzyaabc8*(90.d0+xyzzyaadr8)
xyzzyaaec8(20)=15.d0*(xyzzyaadt8-xyzzyaads8)
xyzzyaaec8(21)=xyzzyaabd8*xyzzyaadr8
xyzzyaaec8(1:21)=xyzzyaaec8(1:21)*xyzzyaadz8
case(6)
xyzzyaabc8=xyzzyaaaw8*xyzzyaaax8
xyzzyaabe8=xyzzyaaaw8*xyzzyaaay8
xyzzyaabd8=xyzzyaaax8*xyzzyaaay8
xyzzyaace8=xyzzyaabc8*xyzzyaaay8
xyzzyaabp8=xyzzyaaaz8*xyzzyaaaz8
xyzzyaabq8=xyzzyaaba8*xyzzyaaba8
xyzzyaabr8=xyzzyaabb8*xyzzyaabb8
xyzzyaabs8=xyzzyaaaz8*xyzzyaaba8
xyzzyaabt8=xyzzyaaaz8*xyzzyaabb8
xyzzyaabu8=xyzzyaaba8*xyzzyaabb8
xyzzyaabv8=xyzzyaaaz8*xyzzyaabe8
xyzzyaabw8=xyzzyaabc8*xyzzyaabd8
xyzzyaabx8=xyzzyaabe8*xyzzyaabb8
xyzzyaaby8=xyzzyaabc8*xyzzyaabe8
xyzzyaabz8=xyzzyaaba8*xyzzyaabd8
xyzzyaaca8=xyzzyaabd8*xyzzyaabb8
xyzzyaacb8=xyzzyaaaz8*xyzzyaabc8
xyzzyaacc8=xyzzyaabc8*xyzzyaaba8
xyzzyaacd8=xyzzyaabc8*xyzzyaabb8
xyzzyaacu8=xyzzyaabp8+xyzzyaabq8
xyzzyaaci8=xyzzyaaaz8-xyzzyaaba8
xyzzyaach8=xyzzyaaaz8+xyzzyaaba8
xyzzyaack8=2.d0*xyzzyaadv8
xyzzyaacl8=3.d0*xyzzyaadv8
xyzzyaacv8=xyzzyaadv8*xyzzyaaaz8
xyzzyaacw8=xyzzyaadv8*xyzzyaaba8
xyzzyaacx8=xyzzyaadv8*xyzzyaabb8
xyzzyaacn8=2.d0*xyzzyaacw8
xyzzyaada8=4.d0*xyzzyaacx8
xyzzyaadb8=8.d0*xyzzyaacx8
xyzzyaadc8=6.d0*xyzzyaacw8
xyzzyaacy8=xyzzyaadv8*xyzzyaabp8
xyzzyaacz8=xyzzyaadv8*xyzzyaabq8
xyzzyaadd8=xyzzyaabr8-3.d0*(xyzzyaabt8+xyzzyaabu8)
xyzzyaade8=0.375d0*xyzzyaacu8
xyzzyaadf8=0.75d0*xyzzyaabs8
xyzzyaaea8(1)=(xyzzyaadd8+xyzzyaade8+xyzzyaadf8)
xyzzyaadg8=7.5d0*(xyzzyaabv8+xyzzyaabw8)
xyzzyaaea8(2)=10.d0*xyzzyaabx8-xyzzyaadg8
xyzzyaadh8=7.5d0*(xyzzyaaby8+xyzzyaabz8)
xyzzyaaea8(3)=10.d0*xyzzyaaca8-xyzzyaadh8
xyzzyaadi8=45.d0*(xyzzyaabt8-xyzzyaabu8)
xyzzyaadj8=7.5d0*(xyzzyaabq8-xyzzyaabp8)
xyzzyaaea8(4)=xyzzyaadi8+xyzzyaadj8
xyzzyaadk8=15.d0*(xyzzyaacb8+xyzzyaacc8)
xyzzyaaea8(5)=90.d0*xyzzyaacd8-xyzzyaadk8
xyzzyaadl8=315.d0*xyzzyaabw8
xyzzyaaea8(6)=105.d0*xyzzyaabv8-xyzzyaadl8
xyzzyaadm8=315.d0*xyzzyaaby8
xyzzyaaea8(7)=xyzzyaadm8-105.d0*xyzzyaabz8
xyzzyaaea8(8)=105.d0*xyzzyaacu8-630.d0*xyzzyaabs8
xyzzyaaea8(9)=420.d0*(xyzzyaacb8-xyzzyaacc8)
xyzzyaadz8=c_prim(xyzzyaaal8)*xyzzyaadw8
do xyzzyaaam8=1,9
xyzzyaaea8(xyzzyaaam8)=xyzzyaaea8(xyzzyaaam8)*xyzzyaadz8
enddo
xyzzyaadu8=xyzzyaack8*(xyzzyaack8*xyzzyaaav8-11.d0)
do xyzzyaaam8=1,9
xyzzyaaeb8(xyzzyaaam8)=xyzzyaaea8(xyzzyaaam8)*xyzzyaadu8
enddo
xyzzyaadn8=xyzzyaacl8*xyzzyaacu8
xyzzyaado8=xyzzyaabb8*(24.d0+xyzzyaadb8)
xyzzyaadp8=6.d0*xyzzyaaba8*(1.d0+xyzzyaada8)
xyzzyaadq8=6.d0*xyzzyaaaz8*(xyzzyaacw8+xyzzyaada8-1.d0)
xyzzyaadr8=-0.25d0*(xyzzyaadn8+xyzzyaado8-xyzzyaadp8+xyzzyaadq8)
xyzzyaaec8(1)=xyzzyaaaw8*xyzzyaadr8
xyzzyaaec8(2)=xyzzyaaax8*xyzzyaadr8
xyzzyaado8=8.d0*xyzzyaabb8*(xyzzyaacx8-2.d0)
xyzzyaadp8=24.d0*xyzzyaaba8*(xyzzyaacx8-1.d0)
xyzzyaadq8=xyzzyaadq8+30.d0*xyzzyaaaz8
xyzzyaadr8=xyzzyaadn8+xyzzyaado8-xyzzyaadp8+xyzzyaadq8
xyzzyaaec8(3)=-0.25d0*xyzzyaaay8*xyzzyaadr8
xyzzyaado8=6.d0*xyzzyaacy8-3.d0*xyzzyaaba8+4.d0*xyzzyaabb8
xyzzyaadp8=9.d0-xyzzyaadc8+xyzzyaadb8
xyzzyaaec8(4)=2.5d0*xyzzyaaay8*(xyzzyaado8-xyzzyaaaz8*xyzzyaadp8)
xyzzyaadp8=3.d0*xyzzyaach8-4.d0*xyzzyaabb8
xyzzyaaec8(5)=5.d0*xyzzyaace8*(xyzzyaadv8*xyzzyaadp8-3.d0)
xyzzyaadq8=xyzzyaabb8*(12.d0-xyzzyaadb8)
xyzzyaadr8=xyzzyaach8*(6.d0*xyzzyaacx8-3.d0)
xyzzyaadr8=2.5d0*(xyzzyaadr8+xyzzyaadq8)
xyzzyaaec8(6)=xyzzyaaaw8*xyzzyaadr8
xyzzyaaec8(7)=xyzzyaaec8(5)
xyzzyaaec8(9)=xyzzyaaax8*xyzzyaadr8
xyzzyaado8=6.d0*xyzzyaacz8-xyzzyaaaz8*(3.d0-xyzzyaadc8)
xyzzyaadp8=4.d0*xyzzyaabb8-xyzzyaaba8*(9.d0+xyzzyaadb8)
xyzzyaaec8(8)=2.5d0*xyzzyaaay8*(xyzzyaado8+xyzzyaadp8)
xyzzyaadq8=xyzzyaacy8-xyzzyaacz8
xyzzyaadr8=6.d0*(xyzzyaabb8+xyzzyaadv8*xyzzyaabu8)
xyzzyaads8=2.d0*xyzzyaaaz8*(1.d0+3.d0*xyzzyaacx8)
xyzzyaaec8(10)=15.d0*xyzzyaaaw8*(xyzzyaadq8+xyzzyaadr8-xyzzyaads8)
xyzzyaadn8=6.d0*xyzzyaabb8
xyzzyaado8=xyzzyaadv8*(xyzzyaach8-xyzzyaadn8)
xyzzyaadp8=2.d0*xyzzyaaba8-xyzzyaadn8
xyzzyaaec8(11)=15.d0*xyzzyaaax8*(xyzzyaado8*xyzzyaaci8+xyzzyaadp8)
xyzzyaado8=xyzzyaado8+6.d0
xyzzyaaec8(12)=15.d0*xyzzyaaay8*xyzzyaaci8*xyzzyaado8
xyzzyaaec8(15)=30.d0*xyzzyaace8*xyzzyaado8
xyzzyaadp8=2.d0*xyzzyaacy8-xyzzyaaba8+xyzzyaadn8
xyzzyaadq8=xyzzyaack8*(xyzzyaaba8-xyzzyaadn8)-3.d0
xyzzyaaec8(13)=15.d0*xyzzyaaax8*(xyzzyaadp8+xyzzyaaaz8*xyzzyaadq8)
xyzzyaadr8=2.d0*xyzzyaacz8+xyzzyaaaz8*(2.d0*xyzzyaacw8-1.d0)
xyzzyaads8=xyzzyaadn8-3.d0*xyzzyaaba8*(1.d0+4.d0*xyzzyaacx8)
xyzzyaaec8(14)=15.d0*xyzzyaaaw8*(xyzzyaadr8+xyzzyaads8)
xyzzyaadn8=105.d0*xyzzyaaay8
xyzzyaado8=3.d0*xyzzyaaaz8*(1.d0+xyzzyaacn8)
xyzzyaado8=xyzzyaado8-2.d0*xyzzyaacy8-3.d0*xyzzyaaba8
xyzzyaaec8(16)=xyzzyaadn8*xyzzyaado8
xyzzyaadp8=xyzzyaaaz8-3.d0*xyzzyaaba8
xyzzyaadq8=1.d0-2.d0*xyzzyaacx8
xyzzyaadr8=210.d0*xyzzyaace8
xyzzyaaec8(17)=(-xyzzyaadr8)*(3.d0+xyzzyaadv8*xyzzyaadp8)
xyzzyaaec8(18)=105.d0*xyzzyaaaw8*xyzzyaadp8*xyzzyaadq8
xyzzyaaec8(19)=xyzzyaadr8*(3.d0-3.d0*xyzzyaacv8+xyzzyaacw8)
xyzzyaads8=xyzzyaaaz8*(xyzzyaadc8-3.d0)
xyzzyaaec8(20)=xyzzyaadn8*(2.d0*xyzzyaacz8-3.d0*xyzzyaaba8-xyzzyaads8)
xyzzyaadp8=xyzzyaaba8-3.d0*xyzzyaaaz8
xyzzyaadq8=2.d0*xyzzyaacx8-1.d0
xyzzyaaec8(21)=105.d0*xyzzyaaax8*xyzzyaadp8*xyzzyaadq8
xyzzyaadn8=2.d0*xyzzyaaaz8*(1+3.d0*xyzzyaacw8)
xyzzyaado8=xyzzyaacy8+xyzzyaaba8*(6.d0+xyzzyaacw8)
xyzzyaaec8(22)=210.d0*xyzzyaaaw8*(xyzzyaadn8-xyzzyaado8)
xyzzyaadp8=xyzzyaaba8*(xyzzyaacw8-2.d0)
xyzzyaadq8=xyzzyaacy8+6.d0*xyzzyaaaz8*(1.d0-xyzzyaacw8)
xyzzyaaec8(23)=-210.d0*xyzzyaaax8*(xyzzyaadp8+xyzzyaadq8)
xyzzyaadr8=6.d0*xyzzyaabs8-xyzzyaacu8
xyzzyaaec8(24)=210.d0*xyzzyaadv8*xyzzyaaay8*xyzzyaadr8
xyzzyaads8=xyzzyaaaz8*(3.d0+xyzzyaacn8)
xyzzyaadt8=2.d0*xyzzyaacy8+xyzzyaaba8
xyzzyaaec8(25)=420.d0*xyzzyaaax8*(xyzzyaads8-xyzzyaadt8)
xyzzyaadq8=2.d0*xyzzyaacz8-3.d0*xyzzyaaba8
xyzzyaadr8=xyzzyaaaz8*(xyzzyaacn8-1.d0)
xyzzyaaec8(26)=420.d0*xyzzyaaaw8*(xyzzyaadq8-xyzzyaadr8)
xyzzyaaec8(27)=840.d0*xyzzyaadv8*xyzzyaace8*(xyzzyaaaz8-xyzzyaaba8)
do xyzzyaaam8=1,27
xyzzyaaec8(xyzzyaaam8)=xyzzyaaec8(xyzzyaaam8)*xyzzyaadz8
enddo
end select
xyzzyaaao8=xyzzyaaag8+1
xyzzyaaap8=xyzzyaaag8+xyzzyaaah8
ao_m(xyzzyaaao8:xyzzyaaap8)=ao_m(xyzzyaaao8:xyzzyaaap8)+xyzzyaaea8(1:x&
&yzzyaaah8)
alap_m(xyzzyaaao8:xyzzyaaap8)=alap_m(xyzzyaaao8:xyzzyaaap8)+xyzzyaaeb8&
&(1:xyzzyaaah8)
agra1_m(xyzzyaaao8:xyzzyaaap8)=agra1_m(xyzzyaaao8:xyzzyaaap8)+xyzzyaae&
&c8(1:xyzzyaaai8:3)
agra2_m(xyzzyaaao8:xyzzyaaap8)=agra2_m(xyzzyaaao8:xyzzyaaap8)+xyzzyaae&
&c8(2:xyzzyaaai8:3)
agra3_m(xyzzyaaao8:xyzzyaaap8)=agra3_m(xyzzyaaao8:xyzzyaaap8)+xyzzyaae&
&c8(3:xyzzyaaai8:3)
enddo
if(xyzzyaaet8)then
do xyzzyaaam8=1,xyzzyaaah8
xyzzyaaar8(xyzzyaaaq8+xyzzyaaam8)=xyzzyaaag8+xyzzyaaam8
enddo
xyzzyaaaq8=xyzzyaaaq8+xyzzyaaah8
endif
enddo
endif
enddo
if(use_gpcc)call cusp_wfdet_real(rvec,jspin,.true.,.true.,cusp_val_r,c&
&usp_grad_r,cusp_lap_r)
xyzzyaaas8=gauss_offset(jspin)
xyzzyaaau8=nuc_nele(jspin)
xyzzyaaat8=xyzzyaaas8-1+xyzzyaaau8
orbval(xyzzyaaas8:xyzzyaaat8,1)=multi_ddot_s(xyzzyaaau8,xyzzyaaaq8,xyz&
&zyaaar8,orbmask(xyzzyaaas8),rck(:,:,:,xyzzyaaac1),size_rck,maxb,ao_m,&
&rnorm)
orbgrad(1,xyzzyaaas8:xyzzyaaat8,1)=multi_ddot_s(xyzzyaaau8,xyzzyaaaq8,&
&xyzzyaaar8,orbmask(xyzzyaaas8),rck(:,:,:,xyzzyaaac1),size_rck,maxb,ag&
&ra1_m,rnorm)
orbgrad(2,xyzzyaaas8:xyzzyaaat8,1)=multi_ddot_s(xyzzyaaau8,xyzzyaaaq8,&
&xyzzyaaar8,orbmask(xyzzyaaas8),rck(:,:,:,xyzzyaaac1),size_rck,maxb,ag&
&ra2_m,rnorm)
orbgrad(3,xyzzyaaas8:xyzzyaaat8,1)=multi_ddot_s(xyzzyaaau8,xyzzyaaaq8,&
&xyzzyaaar8,orbmask(xyzzyaaas8),rck(:,:,:,xyzzyaaac1),size_rck,maxb,ag&
&ra3_m,rnorm)
orblap(xyzzyaaas8:xyzzyaaat8,1)=multi_ddot_s(xyzzyaaau8,xyzzyaaaq8,xyz&
&zyaaar8,orbmask(xyzzyaaas8),rck(:,:,:,xyzzyaaac1),size_rck,maxb,alap_&
&m,rnorm)
if(use_gpcc)then
do xyzzyaaam8=1,gauss_gs_norb
if(.not.orbmask(xyzzyaaam8))cycle
orbval(xyzzyaaam8,1)=orbval(xyzzyaaam8,1)+cusp_val_r(xyzzyaaam8)
orbgrad(:,xyzzyaaam8,1)=orbgrad(:,xyzzyaaam8,1)+cusp_grad_r(:,xyzzyaaa&
&m8)
orblap(xyzzyaaam8,1)=orblap(xyzzyaaam8,1)+cusp_lap_r(xyzzyaaam8)
enddo
endif
if(excite)then
do xyzzyaaam8=1,gauss_ex_norb
xyzzyaaan8=gauss_gs_norb+xyzzyaaam8
if(.not.orbmask(xyzzyaaan8))cycle
xyzzyaaac8=full2vrt(xyzzyaaam8,jspin)
psi(xyzzyaaam8)=sum(ao_m(:)*rck_ex(:,xyzzyaaac8,jspin))*rnorm
flap(xyzzyaaam8)=sum(alap_m(:)*rck_ex(:,xyzzyaaac8,jspin))*rnorm
fgra1(xyzzyaaam8)=sum(agra1_m(:)*rck_ex(:,xyzzyaaac8,jspin))*rnorm
fgra2(xyzzyaaam8)=sum(agra2_m(:)*rck_ex(:,xyzzyaaac8,jspin))*rnorm
fgra3(xyzzyaaam8)=sum(agra3_m(:)*rck_ex(:,xyzzyaaac8,jspin))*rnorm
if(use_gpcc)then
psi(xyzzyaaam8)=psi(xyzzyaaam8)+cusp_val_r(xyzzyaaan8)
flap(xyzzyaaam8)=flap(xyzzyaaam8)+cusp_lap_r(xyzzyaaan8)
fgra1(xyzzyaaam8)=fgra1(xyzzyaaam8)+cusp_grad_r(1,xyzzyaaan8)
fgra2(xyzzyaaam8)=fgra2(xyzzyaaam8)+cusp_grad_r(2,xyzzyaaan8)
fgra3(xyzzyaaam8)=fgra3(xyzzyaaam8)+cusp_grad_r(3,xyzzyaaan8)
endif
enddo
if(cusp_correction)then
do xyzzyaaab8=1,num_centres
if(is_ae(xyzzyaaab8))then
xyzzyaaaw8=rion(1,xyzzyaaab8)
xyzzyaaax8=rion(2,xyzzyaaab8)
xyzzyaaay8=rion(3,xyzzyaaab8)
xyzzyaaaw8=rvec(1)-xyzzyaaaw8
xyzzyaaax8=rvec(2)-xyzzyaaax8
xyzzyaaay8=rvec(3)-xyzzyaaay8
xyzzyaaav8=xyzzyaaaw8*xyzzyaaaw8+xyzzyaaax8*xyzzyaaax8+xyzzyaaay8*xyzz&
&yaaay8
do xyzzyaaam8=1,num_unique_orbitals(jspin)
xyzzyaaed8=rcusp_sq(xyzzyaaam8,xyzzyaaab8,xyzzyaaad1)
if(xyzzyaaav8<xyzzyaaed8)then
if(xyzzyaaav8/=0.d0)then
xyzzyaaee8=sqrt(xyzzyaaav8)
xyzzyaael8=1.d0/xyzzyaaee8
xyzzyaaem8=2.d0*xyzzyaael8
xyzzyaaei8=xyzzyaaaw8*xyzzyaael8
xyzzyaaej8=xyzzyaaax8*xyzzyaael8
xyzzyaaek8=xyzzyaaay8*xyzzyaael8
else
xyzzyaaee8=0.d0
xyzzyaaem8=2.d0
xyzzyaaei8=1.d0
xyzzyaaej8=1.d0
xyzzyaaek8=1.d0
endif
xyzzyaaah1=xyzzyaaam8>nuc_nele(jspin)
if(xyzzyaaah1)then
xyzzyaaab1=xyzzyaaam8-nuc_nele(jspin)
call wfdet_s(xyzzyaaee8,1,3.d0,xyzzyaaab1,xyzzyaaab8,jspin,1,1,1,.true&
&.,xyzzyaaac1,xyzzyaaae1,xyzzyaaag1,xyzzyaaaf1)
else
call wfdet_s(xyzzyaaee8,1,3.d0,xyzzyaaam8,xyzzyaaab8,jspin,1,1,1,.fals&
&e.,xyzzyaaac1,xyzzyaaae1,xyzzyaaag1,xyzzyaaaf1)
endif
xyzzyaaeo8=acusp(1,xyzzyaaam8,xyzzyaaab8,xyzzyaaad1)
xyzzyaaep8=acusp(2,xyzzyaaam8,xyzzyaaab8,xyzzyaaad1)
xyzzyaaeq8=acusp(3,xyzzyaaam8,xyzzyaaab8,xyzzyaaad1)
xyzzyaaer8=acusp(4,xyzzyaaam8,xyzzyaaab8,xyzzyaaad1)
xyzzyaaes8=acusp(5,xyzzyaaam8,xyzzyaaab8,xyzzyaaad1)
xyzzyaaef8=xyzzyaaeo8+xyzzyaaep8*xyzzyaaee8
xyzzyaaeg8=xyzzyaaep8+2.d0*xyzzyaaeq8*xyzzyaaee8
xyzzyaaeh8=2.d0*xyzzyaaeq8+6.d0*xyzzyaaer8*xyzzyaaee8
xyzzyaaen8=xyzzyaaee8*xyzzyaaee8
xyzzyaaef8=xyzzyaaef8+xyzzyaaeq8*xyzzyaaen8
xyzzyaaeg8=xyzzyaaeg8+3.d0*xyzzyaaer8*xyzzyaaen8
xyzzyaaeh8=xyzzyaaeh8+12.d0*xyzzyaaes8*xyzzyaaen8
xyzzyaaen8=xyzzyaaen8*xyzzyaaee8
xyzzyaaef8=xyzzyaaef8+xyzzyaaer8*xyzzyaaen8
xyzzyaaeg8=xyzzyaaeg8+4.d0*xyzzyaaes8*xyzzyaaen8
xyzzyaaen8=xyzzyaaen8*xyzzyaaee8
xyzzyaaef8=xyzzyaaef8+xyzzyaaes8*xyzzyaaen8
xyzzyaadd8=disign(xyzzyaaam8,xyzzyaaab8,xyzzyaaad1)*exp(xyzzyaaef8)+ps&
&hift(xyzzyaaam8,xyzzyaaab8,xyzzyaaad1)
xyzzyaade8=xyzzyaadd8*xyzzyaaeg8
xyzzyaadf8=(xyzzyaaem8+xyzzyaaeg8)*xyzzyaaeg8+xyzzyaaeh8
if(xyzzyaaah1)then
xyzzyaaac8=vrt2full(xyzzyaaab1,jspin)
psi(xyzzyaaac8)=psi(xyzzyaaac8)-xyzzyaaae1(1)+xyzzyaadd8
fgra1(xyzzyaaac8)=fgra1(xyzzyaaac8)+(xyzzyaade8-xyzzyaaag1(1))*xyzzyaa&
&ei8
fgra2(xyzzyaaac8)=fgra2(xyzzyaaac8)+(xyzzyaade8-xyzzyaaag1(1))*xyzzyaa&
&ej8
fgra3(xyzzyaaac8)=fgra3(xyzzyaaac8)+(xyzzyaade8-xyzzyaaag1(1))*xyzzyaa&
&ek8
flap(xyzzyaaac8)=flap(xyzzyaaac8)-xyzzyaaaf1(1)+xyzzyaadd8*xyzzyaadf8
else
xyzzyaaac8=xyzzyaaam8+gauss_offset(jspin)-1
orbval(xyzzyaaac8,1)=orbval(xyzzyaaac8,1)-xyzzyaaae1(1)+xyzzyaadd8
orbgrad(1,xyzzyaaac8,1)=orbgrad(1,xyzzyaaac8,1)+(xyzzyaade8-xyzzyaaag1&
&(1))*xyzzyaaei8
orbgrad(2,xyzzyaaac8,1)=orbgrad(2,xyzzyaaac8,1)+(xyzzyaade8-xyzzyaaag1&
&(1))*xyzzyaaej8
orbgrad(3,xyzzyaaac8,1)=orbgrad(3,xyzzyaaac8,1)+(xyzzyaade8-xyzzyaaag1&
&(1))*xyzzyaaek8
orblap(xyzzyaaac8,1)=orblap(xyzzyaaac8,1)-xyzzyaaaf1(1)+xyzzyaadd8*xyz&
&zyaadf8
endif
endif
enddo
endif
enddo
endif
do xyzzyaaam8=1,gauss_ex_norb
xyzzyaaan8=gauss_gs_norb+xyzzyaaam8
if(.not.orbmask(xyzzyaaan8))cycle
orbval(xyzzyaaan8,1)=psi(xyzzyaaam8)
orbgrad(1,xyzzyaaan8,1)=fgra1(xyzzyaaam8)
orbgrad(2,xyzzyaaan8,1)=fgra2(xyzzyaaam8)
orbgrad(3,xyzzyaaan8,1)=fgra3(xyzzyaaam8)
orblap(xyzzyaaan8,1)=flap(xyzzyaaam8)
enddo
else
if(cusp_correction)then
do xyzzyaaab8=1,num_centres
if(is_ae(xyzzyaaab8))then
xyzzyaaaw8=rion(1,xyzzyaaab8)
xyzzyaaax8=rion(2,xyzzyaaab8)
xyzzyaaay8=rion(3,xyzzyaaab8)
xyzzyaaaw8=rvec(1)-xyzzyaaaw8
xyzzyaaax8=rvec(2)-xyzzyaaax8
xyzzyaaay8=rvec(3)-xyzzyaaay8
xyzzyaaav8=xyzzyaaaw8*xyzzyaaaw8+xyzzyaaax8*xyzzyaaax8+xyzzyaaay8*xyzz&
&yaaay8
do xyzzyaaam8=1,num_unique_orbitals(jspin)
xyzzyaaed8=rcusp_sq(xyzzyaaam8,xyzzyaaab8,xyzzyaaad1)
if(xyzzyaaav8<xyzzyaaed8)then
if(xyzzyaaav8/=0.d0)then
xyzzyaaee8=sqrt(xyzzyaaav8)
xyzzyaael8=1.d0/xyzzyaaee8
xyzzyaaem8=2.d0*xyzzyaael8
xyzzyaaei8=xyzzyaaaw8*xyzzyaael8
xyzzyaaej8=xyzzyaaax8*xyzzyaael8
xyzzyaaek8=xyzzyaaay8*xyzzyaael8
else
xyzzyaaee8=0.d0
xyzzyaaem8=2.d0
xyzzyaaei8=1.d0
xyzzyaaej8=1.d0
xyzzyaaek8=1.d0
endif
call wfdet_s(xyzzyaaee8,1,3.d0,xyzzyaaam8,xyzzyaaab8,jspin,1,1,1,.fals&
&e.,xyzzyaaac1,xyzzyaaae1,xyzzyaaag1,xyzzyaaaf1)
xyzzyaaeo8=acusp(1,xyzzyaaam8,xyzzyaaab8,xyzzyaaad1)
xyzzyaaep8=acusp(2,xyzzyaaam8,xyzzyaaab8,xyzzyaaad1)
xyzzyaaeq8=acusp(3,xyzzyaaam8,xyzzyaaab8,xyzzyaaad1)
xyzzyaaer8=acusp(4,xyzzyaaam8,xyzzyaaab8,xyzzyaaad1)
xyzzyaaes8=acusp(5,xyzzyaaam8,xyzzyaaab8,xyzzyaaad1)
xyzzyaaef8=xyzzyaaeo8+xyzzyaaep8*xyzzyaaee8
xyzzyaaeg8=xyzzyaaep8+2.d0*xyzzyaaeq8*xyzzyaaee8
xyzzyaaeh8=2.d0*xyzzyaaeq8+6.d0*xyzzyaaer8*xyzzyaaee8
xyzzyaaen8=xyzzyaaee8*xyzzyaaee8
xyzzyaaef8=xyzzyaaef8+xyzzyaaeq8*xyzzyaaen8
xyzzyaaeg8=xyzzyaaeg8+3.d0*xyzzyaaer8*xyzzyaaen8
xyzzyaaeh8=xyzzyaaeh8+12.d0*xyzzyaaes8*xyzzyaaen8
xyzzyaaen8=xyzzyaaen8*xyzzyaaee8
xyzzyaaef8=xyzzyaaef8+xyzzyaaer8*xyzzyaaen8
xyzzyaaeg8=xyzzyaaeg8+4.d0*xyzzyaaes8*xyzzyaaen8
xyzzyaaen8=xyzzyaaen8*xyzzyaaee8
xyzzyaaef8=xyzzyaaef8+xyzzyaaes8*xyzzyaaen8
xyzzyaadd8=disign(xyzzyaaam8,xyzzyaaab8,xyzzyaaad1)*exp(xyzzyaaef8)+ps&
&hift(xyzzyaaam8,xyzzyaaab8,xyzzyaaad1)
xyzzyaade8=xyzzyaadd8*xyzzyaaeg8
xyzzyaadf8=(xyzzyaaem8+xyzzyaaeg8)*xyzzyaaeg8+xyzzyaaeh8
xyzzyaaac8=xyzzyaaam8+gauss_offset(jspin)-1
orbval(xyzzyaaac8,1)=orbval(xyzzyaaac8,1)-xyzzyaaae1(1)+xyzzyaadd8
orbgrad(1,xyzzyaaac8,1)=orbgrad(1,xyzzyaaac8,1)+(xyzzyaade8-xyzzyaaag1&
&(1))*xyzzyaaei8
orbgrad(2,xyzzyaaac8,1)=orbgrad(2,xyzzyaaac8,1)+(xyzzyaade8-xyzzyaaag1&
&(1))*xyzzyaaej8
orbgrad(3,xyzzyaaac8,1)=orbgrad(3,xyzzyaaac8,1)+(xyzzyaade8-xyzzyaaag1&
&(1))*xyzzyaaek8
orblap(xyzzyaaac8,1)=orblap(xyzzyaaac8,1)-xyzzyaaaf1(1)+xyzzyaadd8*xyz&
&zyaadf8
endif
enddo
endif
enddo
endif
endif
end subroutine xyzzyaaan1
end module slaarnaaw
