module slaarnaax
use dsp
use slaarnaat
use slaarnabg
use slaarnabp
use store
use slaarnaag,  only : czero,zi
use slaarnabi,       only : use_gpcc,cusp_wfdet_cmplx
use slaarnabt,  only : gmult,g3mult,g6mult,dcopy,multi_ddot_s,multi_zd&
&otu_s
implicit none
private
public gauss_per_bf_orb_eval
integer xyzzyaaaa1,xyzzyaaab1
contains
subroutine gauss_per_bf_orb_eval(rvec,jspin,norb,orbmask,norbc,corbmas&
&k,val,orbval,orbgrad,orblap,orbsderivs)
implicit none
integer,intent(in) :: jspin,norb,norbc
real(dp),intent(in) :: rvec(3)
real(dp),intent(inout) :: orbval(norb,real1_complex2),orbgrad(3,norb,r&
&eal1_complex2),orblap(norb,real1_complex2)
real(dp),intent(inout) :: orbsderivs(6,nemax,real1_complex2)
logical,intent(in) :: val,orbmask(norb),corbmask(norbc)
integer xyzzyaaaa2
real(dp) xyzzyaaab2,xyzzyaaac2,xyzzyaaad2,xyzzyaaae2,xyzzyaaaf2,xyzzya&
&aag2,xyzzyaaah2,xyzzyaaai2(3)
select case (periodicity)
case(3)
xyzzyaaai2=anint(matmul(rvec,painv))
new_origin=matmul(xyzzyaaai2,pamat)
case(2)
xyzzyaaai2(1:2)=anint(matmul(rvec(1:2),painv(1:2,1:2)))
new_origin(1:2)=matmul(xyzzyaaai2(1:2),pamat(1:2,1:2))
new_origin(3)=0.d0
case(1)
xyzzyaaai2(1)=anint(rvec(1)*painv(1,1))
new_origin(1)=xyzzyaaai2(1)*pamat(1,1)
new_origin(2:3)=0.d0
end select
new_origin_to_rvec=rvec-new_origin
xyzzyaaab2=new_origin(1)
xyzzyaaac2=new_origin(2)
xyzzyaaad2=new_origin(3)
do xyzzyaaaa2=1,num_real_k
xyzzyaaae2=kvec(1,xyzzyaaaa2)
xyzzyaaaf2=kvec(2,xyzzyaaaa2)
xyzzyaaag2=kvec(3,xyzzyaaaa2)
xyzzyaaah2=xyzzyaaae2*xyzzyaaab2+xyzzyaaaf2*xyzzyaaac2+xyzzyaaag2*xyzz&
&yaaad2
coskdotg_shift(xyzzyaaaa2)=cos(xyzzyaaah2)
enddo
do xyzzyaaaa2=num_real_k_plus_1,num_k
xyzzyaaae2=kvec(1,xyzzyaaaa2)
xyzzyaaaf2=kvec(2,xyzzyaaaa2)
xyzzyaaag2=kvec(3,xyzzyaaaa2)
xyzzyaaah2=xyzzyaaae2*xyzzyaaab2+xyzzyaaaf2*xyzzyaaac2+xyzzyaaag2*xyzz&
&yaaad2
expikdotg_shift(xyzzyaaaa2)=exp(xyzzyaaah2*zi)
enddo
xyzzyaaaa1=which_ssingle(jspin,spin_dep_gs)
xyzzyaaab1=which_ssingle(jspin,spin_dep_in)
if(.not.val)then
call xyzzyaaac1(rvec,jspin,norb,orbmask,norbc,corbmask,orbgrad,orblap,&
&orbsderivs)
else
call xyzzyaaad1(rvec,jspin,norb,orbmask,norbc,corbmask,orbval,orbgrad,&
&orblap,orbsderivs)
endif
if(complex_wf)then
if(val)orbval(:,2)=0.d0
orbgrad(:,:,2)=0.d0
orblap(:,2)=0.d0
orbsderivs(:,:,2)=0.d0
endif
end subroutine gauss_per_bf_orb_eval
subroutine xyzzyaaac1(rvec,jspin,norb,orbmask,norbc,corbmask,orbgrad,o&
&rblap,orbsderivs)
implicit none
integer,intent(in) :: jspin,norb,norbc
real(dp),intent(in) :: rvec(3)
real(dp),intent(inout) :: orbgrad(3,norb,real1_complex2),orblap(norb,r&
&eal1_complex2),orbsderivs(6,nemax,real1_complex2)
logical,intent(in) :: orbmask(norb),corbmask(norbc)
integer xyzzyaaaa3,xyzzyaaab3,xyzzyaaac3,xyzzyaaad3,xyzzyaaae3,xyzzyaa&
&af3,xyzzyaaag3,xyzzyaaah3,xyzzyaaai3,xyzzyaaaj3,xyzzyaaak3,xyzzyaaal3&
&,xyzzyaaam3,xyzzyaaan3,xyzzyaaao3,xyzzyaaap3,xyzzyaaaq3,xyzzyaaar3,xy&
&zzyaaas3,xyzzyaaat3,xyzzyaaau3,xyzzyaaav3,xyzzyaaaw3,xyzzyaaax3(num_a&
&o)
real(dp) xyzzyaaay3,xyzzyaaaz3,xyzzyaaba3,xyzzyaabb3,xyzzyaabc3,xyzzya&
&abd3,xyzzyaabe3,xyzzyaabf3,xyzzyaabg3,xyzzyaabh3,xyzzyaabi3,xyzzyaabj&
&3,xyzzyaabk3,xyzzyaabl3,xyzzyaabm3,xyzzyaabn3,xyzzyaabo3,xyzzyaabp3,x&
&yzzyaabq3,xyzzyaabr3,xyzzyaabs3,xyzzyaabt3,xyzzyaabu3,xyzzyaabv3,xyzz&
&yaabw3,xyzzyaabx3,xyzzyaaby3,xyzzyaabz3,xyzzyaaca3,xyzzyaacb3,xyzzyaa&
&cc3,xyzzyaacd3,xyzzyaace3(7),xyzzyaacf3(21),xyzzyaacg3(42),xyzzyaach3&
&(7),xyzzyaaci3(21),xyzzyaacj3(42),xyzzyaack3,xyzzyaacl3,xyzzyaacm3,xy&
&zzyaacn3,xyzzyaaco3,xyzzyaacp3,xyzzyaacq3,xyzzyaacr3,xyzzyaacs3,xyzzy&
&aact3,xyzzyaacu3,xyzzyaacv3
real(dp) xyzzyaacw3,xyzzyaacx3,xyzzyaacy3,xyzzyaacz3,xyzzyaada3,xyzzya&
&adb3,xyzzyaadc3,xyzzyaadd3,xyzzyaade3,xyzzyaadf3,xyzzyaadg3,xyzzyaadh&
&3,xyzzyaadi3,xyzzyaadj3,xyzzyaadk3,xyzzyaadl3,xyzzyaadm3,xyzzyaadn3,x&
&yzzyaado3,xyzzyaadp3,xyzzyaadq3,xyzzyaadr3,xyzzyaads3,xyzzyaadt3,xyzz&
&yaadu3,xyzzyaadv3,xyzzyaadw3,xyzzyaadx3,xyzzyaady3,xyzzyaadz3,xyzzyaa&
&ea3,xyzzyaaeb3,xyzzyaaec3,xyzzyaaed3,xyzzyaaee3,xyzzyaaef3,xyzzyaaeg3&
&,xyzzyaaeh3,xyzzyaaei3,xyzzyaaej3,xyzzyaaek3,xyzzyaael3,xyzzyaaem3,xy&
&zzyaaen3,xyzzyaaeo3,xyzzyaaep3,xyzzyaaeq3,xyzzyaaer3,xyzzyaaes3,xyzzy&
&aaet3,xyzzyaaeu3,xyzzyaaev3,xyzzyaaew3,xyzzyaaex3,xyzzyaaey3,xyzzyaae&
&z3,xyzzyaafa3,xyzzyaafb3,xyzzyaafc3,xyzzyaafd3,xyzzyaafe3,xyzzyaaff3,&
&xyzzyaafg3,xyzzyaafh3,xyzzyaafi3,xyzzyaafj3,xyzzyaafk3,xyzzyaafl3,xyz&
&zyaafm3,xyzzyaafn3,xyzzyaafo3,xyzzyaafp3,xyzzyaafq3,xyzzyaafr3,xyzzya&
&afs3,xyzzyaaft3,xyzzyaafu3,xyzzyaafv3,xyzzyaafw3,xyzzyaafx3,xyzzyaafy&
&3,xyzzyaafz3,xyzzyaaga3,xyzzyaagb3,xyzzyaagc3,xyzzyaagd3,xyzzyaage3,x&
&yzzyaagf3,xyzzyaagg3,xyzzyaagh3,xyzzyaagi3,xyzzyaagj3,xyzzyaagk3,xyzz&
&yaagl3,xyzzyaagm3,xyzzyaagn3,xyzzyaago3,xyzzyaagp3,xyzzyaagq3,xyzzyaa&
&gr3,xyzzyaags3,xyzzyaagt3,xyzzyaagu3,xyzzyaagv3,xyzzyaagw3,xyzzyaagx3&
&,xyzzyaagy3,xyzzyaagz3,xyzzyaaha3,xyzzyaahb3,xyzzyaahc3,xyzzyaahd3,xy&
&zzyaahe3,xyzzyaahf3,xyzzyaahg3,xyzzyaahh3,xyzzyaahi3,xyzzyaahj3,xyzzy&
&aahk3,xyzzyaahl3,xyzzyaahm3,xyzzyaahn3,xyzzyaaho3,xyzzyaahp3
real(dp) xyzzyaahq3,xyzzyaahr3,xyzzyaahs3,xyzzyaaht3,xyzzyaahu3,xyzzya&
&ahv3,xyzzyaahw3,xyzzyaahx3,xyzzyaahy3,xyzzyaahz3,xyzzyaaia3,xyzzyaaib&
&3,xyzzyaaic3,xyzzyaaid3,xyzzyaaie3,xyzzyaaif3,xyzzyaaig3,xyzzyaaih3,x&
&yzzyaaii3,xyzzyaaij3,xyzzyaaik3,xyzzyaail3,xyzzyaaim3,xyzzyaain3,xyzz&
&yaaio3,xyzzyaaip3,xyzzyaaiq3,xyzzyaair3,xyzzyaais3,xyzzyaait3,xyzzyaa&
&iu3,xyzzyaaiv3,xyzzyaaiw3,xyzzyaaix3,xyzzyaaiy3,xyzzyaaiz3,xyzzyaaja3&
&,xyzzyaajb3,xyzzyaajc3,xyzzyaajd3,xyzzyaaje3,xyzzyaajf3,xyzzyaajg3,xy&
&zzyaajh3,xyzzyaaji3,xyzzyaajj3,xyzzyaajk3,xyzzyaajl3
complex(dp) xyzzyaajm3
logical xyzzyaajn3,xyzzyaajo3(num_shells)
xyzzyaaat3=0
rblap=0.d0
rbgra1=0.d0
rbgra2=0.d0
rbgra3=0.d0
rbsderiv1=0.d0
rbsderiv2=0.d0
rbsderiv3=0.d0
rbsderiv4=0.d0
rbsderiv5=0.d0
rbsderiv6=0.d0
xyzzyaajo3=.false.
if(complex_states)then
cblap=czero
cbgra1=czero
cbgra2=czero
cbgra3=czero
cbsderiv1=czero
cbsderiv2=czero
cbsderiv3=czero
cbsderiv4=czero
cbsderiv5=czero
cbsderiv6=czero
endif
do xyzzyaaaa3=1,num_cell
do xyzzyaaab3=1,num_real_k
phase(xyzzyaaab3)=coskdotg(xyzzyaaab3,xyzzyaaaa3)*coskdotg_shift(xyzzy&
&aaab3)
enddo
do xyzzyaaab3=num_real_k_plus_1,num_k
cphase(xyzzyaaab3)=expikdotg(xyzzyaaab3,xyzzyaaaa3)*expikdotg_shift(xy&
&zzyaaab3)
enddo
do xyzzyaaac3=1,num_centres_in_cell(xyzzyaaaa3)
xyzzyaaaz3=xpos_in_cell(xyzzyaaac3,xyzzyaaaa3)
xyzzyaaba3=ypos_in_cell(xyzzyaaac3,xyzzyaaaa3)
xyzzyaabb3=zpos_in_cell(xyzzyaaac3,xyzzyaaaa3)
xyzzyaaaz3=new_origin_to_rvec(1)-xyzzyaaaz3
xyzzyaaba3=new_origin_to_rvec(2)-xyzzyaaba3
xyzzyaabb3=new_origin_to_rvec(3)-xyzzyaabb3
xyzzyaabc3=xyzzyaaaz3*xyzzyaaaz3
xyzzyaabd3=xyzzyaaba3*xyzzyaaba3
xyzzyaabe3=xyzzyaabb3*xyzzyaabb3
xyzzyaaay3=xyzzyaabc3+xyzzyaabd3+xyzzyaabe3
xyzzyaaad3=num_shells_on_centre(xyzzyaaac3,xyzzyaaaa3)
do xyzzyaaae3=1,xyzzyaaad3
xyzzyaaat3=xyzzyaaat3+1
xyzzyaaaf3=shell_sequence_number(xyzzyaaat3)
xyzzyaabz3=min_exponent(xyzzyaaaf3)
xyzzyaabo3=xyzzyaabz3*xyzzyaaay3
if(xyzzyaabo3>screening_tolerance)cycle
xyzzyaaag3=shell_am(xyzzyaaaf3)
xyzzyaaah3=numao_in_shell(xyzzyaaaf3)
xyzzyaaai3=xyzzyaaah3*3
xyzzyaaaj3=xyzzyaaah3*6
do xyzzyaaao3=1,xyzzyaaah3
xyzzyaach3(xyzzyaaao3)=0.d0
enddo
do xyzzyaaao3=1,xyzzyaaai3
xyzzyaaci3(xyzzyaaao3)=0.d0
enddo
do xyzzyaaao3=1,xyzzyaaaj3
xyzzyaacj3(xyzzyaaao3)=0.d0
enddo
xyzzyaaar3=primitive(xyzzyaaaf3)
xyzzyaaas3=primitive(xyzzyaaaf3+1)-1
xyzzyaajn3=.false.
do xyzzyaaaq3=xyzzyaaar3,xyzzyaaas3
xyzzyaabz3=exponent(xyzzyaaaq3)
xyzzyaabo3=xyzzyaabz3*xyzzyaaay3
if(xyzzyaabo3>30.d0)cycle
xyzzyaajn3=.true.
xyzzyaajo3(xyzzyaaaf3)=.true.
xyzzyaaca3=exp(-xyzzyaabo3)
xyzzyaabk3=-xyzzyaabz3-xyzzyaabz3
select case (xyzzyaaag3)
case(1)
xyzzyaacb3=c_prim(xyzzyaaaq3)*xyzzyaaca3*xyzzyaabk3
xyzzyaacf3(1)=xyzzyaaaz3*xyzzyaacb3
xyzzyaacf3(2)=xyzzyaaba3*xyzzyaacb3
xyzzyaacf3(3)=xyzzyaabb3*xyzzyaacb3
xyzzyaacg3(1)=(1.d0+xyzzyaabk3*xyzzyaabc3)*xyzzyaacb3
xyzzyaacg3(2)=(1.d0+xyzzyaabk3*xyzzyaabd3)*xyzzyaacb3
xyzzyaacg3(3)=(1.d0+xyzzyaabk3*xyzzyaabe3)*xyzzyaacb3
xyzzyaace3(1)=xyzzyaacg3(1)+xyzzyaacg3(2)+xyzzyaacg3(3)
xyzzyaacg3(4)=xyzzyaabk3*xyzzyaaba3*xyzzyaacf3(1)
xyzzyaacg3(5)=xyzzyaabk3*xyzzyaabb3*xyzzyaacf3(1)
xyzzyaacg3(6)=xyzzyaabk3*xyzzyaabb3*xyzzyaacf3(2)
case(2)
xyzzyaacf3(1)=xyzzyaabk3*xyzzyaaaz3
xyzzyaacf3(2)=xyzzyaabk3*xyzzyaaba3
xyzzyaacf3(3)=xyzzyaabk3*xyzzyaabb3
xyzzyaacf3(4)=1.d0+xyzzyaacf3(1)*xyzzyaaaz3
xyzzyaacf3(5)=xyzzyaacf3(1)*xyzzyaaba3
xyzzyaacf3(6)=xyzzyaacf3(1)*xyzzyaabb3
xyzzyaacf3(8)=1.d0+xyzzyaacf3(2)*xyzzyaaba3
xyzzyaacf3(9)=xyzzyaacf3(2)*xyzzyaabb3
xyzzyaacf3(7)=xyzzyaacf3(5)
xyzzyaacf3(10)=xyzzyaacf3(6)
xyzzyaacf3(11)=xyzzyaacf3(9)
xyzzyaacf3(12)=1.d0+xyzzyaacf3(3)*xyzzyaabb3
xyzzyaacg3(1)=xyzzyaabk3*xyzzyaacf3(4)
xyzzyaacg3(2)=xyzzyaabk3*xyzzyaacf3(8)
xyzzyaacg3(3)=xyzzyaabk3*xyzzyaacf3(12)
xyzzyaacg3(4)=xyzzyaacf3(1)*xyzzyaacf3(2)
xyzzyaacg3(5)=xyzzyaacf3(1)*xyzzyaacf3(3)
xyzzyaacg3(6)=xyzzyaacf3(2)*xyzzyaacf3(3)
xyzzyaacg3(7)=xyzzyaacf3(1)*(xyzzyaacf3(4)+2.d0)
xyzzyaacg3(10)=xyzzyaacf3(2)*xyzzyaacf3(4)
xyzzyaacg3(13)=xyzzyaacg3(10)
xyzzyaacg3(11)=xyzzyaacf3(3)*xyzzyaacf3(4)
xyzzyaacg3(19)=xyzzyaacg3(11)
xyzzyaacg3(8)=xyzzyaacf3(1)*xyzzyaacf3(8)
xyzzyaacg3(16)=xyzzyaacg3(8)
xyzzyaacg3(14)=xyzzyaacf3(2)*(xyzzyaacf3(8)+2.d0)
xyzzyaacg3(18)=xyzzyaacf3(3)*xyzzyaacf3(8)
xyzzyaacg3(20)=xyzzyaacg3(18)
xyzzyaacg3(9)=xyzzyaacf3(1)*xyzzyaacf3(12)
xyzzyaacg3(23)=xyzzyaacg3(9)
xyzzyaacg3(15)=xyzzyaacf3(2)*xyzzyaacf3(12)
xyzzyaacg3(24)=xyzzyaacg3(15)
xyzzyaacg3(21)=xyzzyaacf3(3)*(xyzzyaacf3(12)+2.d0)
xyzzyaacg3(12)=xyzzyaacf3(1)*xyzzyaacf3(9)
xyzzyaacg3(17)=xyzzyaacg3(12)
xyzzyaacg3(22)=xyzzyaacg3(12)
xyzzyaacb3=c_prim(xyzzyaaaq3)*xyzzyaaca3
xyzzyaacc3=c_prim2(xyzzyaaaq3)*xyzzyaaca3
xyzzyaacf3(1:3)=xyzzyaacf3(1:3)*xyzzyaacb3
xyzzyaacf3(4:12)=xyzzyaacf3(4:12)*xyzzyaacc3
xyzzyaacg3(1:6)=xyzzyaacg3(1:6)*xyzzyaacb3
xyzzyaacg3(7:24)=xyzzyaacg3(7:24)*xyzzyaacc3
xyzzyaace3(1)=xyzzyaacg3(1)+xyzzyaacg3(2)+xyzzyaacg3(3)
xyzzyaace3(2)=xyzzyaacg3(7)+xyzzyaacg3(8)+xyzzyaacg3(9)
xyzzyaace3(3)=xyzzyaacg3(13)+xyzzyaacg3(14)+xyzzyaacg3(15)
xyzzyaace3(4)=xyzzyaacg3(19)+xyzzyaacg3(20)+xyzzyaacg3(21)
case(3)
xyzzyaabl3=xyzzyaabk3*xyzzyaaaz3
xyzzyaabm3=xyzzyaabk3*xyzzyaaba3
xyzzyaabn3=xyzzyaabk3*xyzzyaabb3
xyzzyaacf3(1)=1.d0+xyzzyaabl3*xyzzyaaaz3
xyzzyaacf3(2)=xyzzyaabl3*xyzzyaaba3
xyzzyaacf3(3)=xyzzyaabl3*xyzzyaabb3
xyzzyaacf3(5)=1.d0+xyzzyaabm3*xyzzyaaba3
xyzzyaacf3(6)=xyzzyaabm3*xyzzyaabb3
xyzzyaacf3(9)=1.d0+xyzzyaabn3*xyzzyaabb3
xyzzyaacf3(4)=xyzzyaacf3(2)
xyzzyaacf3(7)=xyzzyaacf3(3)
xyzzyaacf3(8)=xyzzyaacf3(6)
xyzzyaacg3(1)=xyzzyaabl3*(xyzzyaacf3(1)+2.d0)
xyzzyaacg3(4)=xyzzyaabm3*xyzzyaacf3(1)
xyzzyaacg3(7)=xyzzyaacg3(4)
xyzzyaacg3(5)=xyzzyaabn3*xyzzyaacf3(1)
xyzzyaacg3(13)=xyzzyaacg3(5)
xyzzyaacg3(2)=xyzzyaabl3*xyzzyaacf3(5)
xyzzyaacg3(10)=xyzzyaacg3(2)
xyzzyaacg3(8)=xyzzyaabm3*(xyzzyaacf3(5)+2.d0)
xyzzyaacg3(12)=xyzzyaabn3*xyzzyaacf3(5)
xyzzyaacg3(14)=xyzzyaacg3(12)
xyzzyaacg3(3)=xyzzyaabl3*xyzzyaacf3(9)
xyzzyaacg3(17)=xyzzyaacg3(3)
xyzzyaacg3(9)=xyzzyaabm3*xyzzyaacf3(9)
xyzzyaacg3(18)=xyzzyaacg3(9)
xyzzyaacg3(15)=xyzzyaabn3*(xyzzyaacf3(9)+2.d0)
xyzzyaacg3(6)=xyzzyaabl3*xyzzyaacf3(6)
xyzzyaacg3(11)=xyzzyaacg3(6)
xyzzyaacg3(16)=xyzzyaacg3(6)
xyzzyaacc3=c_prim(xyzzyaaaq3)*xyzzyaaca3
xyzzyaacf3(1:9)=xyzzyaacf3(1:9)*xyzzyaacc3
xyzzyaacg3(1:18)=xyzzyaacg3(1:18)*xyzzyaacc3
xyzzyaace3(1)=xyzzyaacg3(1)+xyzzyaacg3(2)+xyzzyaacg3(3)
xyzzyaace3(2)=xyzzyaacg3(7)+xyzzyaacg3(8)+xyzzyaacg3(9)
xyzzyaace3(3)=xyzzyaacg3(13)+xyzzyaacg3(14)+xyzzyaacg3(15)
case(4)
xyzzyaabf3=xyzzyaaaz3*xyzzyaaba3
xyzzyaabg3=xyzzyaaba3*xyzzyaabb3
xyzzyaabh3=xyzzyaaaz3*xyzzyaabb3
xyzzyaabi3=xyzzyaabc3-xyzzyaabd3
xyzzyaabj3=3.d0*xyzzyaabe3-xyzzyaaay3
xyzzyaabl3=xyzzyaabk3*xyzzyaaaz3
xyzzyaacl3=xyzzyaabl3*xyzzyaabb3
xyzzyaabm3=xyzzyaabk3*xyzzyaaba3
xyzzyaacm3=xyzzyaabm3*xyzzyaabb3
xyzzyaabn3=xyzzyaabk3*xyzzyaabb3
xyzzyaack3=xyzzyaabl3*xyzzyaaba3
xyzzyaabo3=1.d0+xyzzyaabl3*xyzzyaaaz3
xyzzyaabv3=xyzzyaabo3+2.d0
xyzzyaabp3=1.d0+xyzzyaabm3*xyzzyaaba3
xyzzyaabw3=xyzzyaabp3+2.d0
xyzzyaabq3=1.d0+xyzzyaabn3*xyzzyaabb3
xyzzyaabx3=xyzzyaabq3+2.d0
xyzzyaabr3=xyzzyaabk3*xyzzyaabj3-2.d0
xyzzyaabs3=xyzzyaabk3*xyzzyaabi3
xyzzyaacf3(1)=xyzzyaabr3*xyzzyaaaz3
xyzzyaacf3(2)=xyzzyaabr3*xyzzyaaba3
xyzzyaacf3(3)=(xyzzyaabr3+6.d0)*xyzzyaabb3
xyzzyaacf3(4)=xyzzyaabo3*xyzzyaabb3
xyzzyaacf3(5)=xyzzyaabl3*xyzzyaabg3
xyzzyaacf3(6)=xyzzyaabq3*xyzzyaaaz3
xyzzyaacf3(7)=xyzzyaacf3(5)
xyzzyaacf3(8)=xyzzyaabp3*xyzzyaabb3
xyzzyaacf3(9)=xyzzyaabq3*xyzzyaaba3
xyzzyaacf3(10)=(2.d0+xyzzyaabk3*xyzzyaabi3)*xyzzyaaaz3
xyzzyaacf3(11)=(xyzzyaabs3-2.d0)*xyzzyaaba3
xyzzyaacf3(12)=xyzzyaabs3*xyzzyaabb3
xyzzyaacf3(13)=xyzzyaabo3*xyzzyaaba3
xyzzyaacf3(14)=xyzzyaabp3*xyzzyaaaz3
xyzzyaacf3(15)=xyzzyaacf3(5)
xyzzyaacd3=c_prim(xyzzyaaaq3)*xyzzyaaca3
xyzzyaacf3(1:15)=xyzzyaacf3(1:15)*xyzzyaacd3
xyzzyaabt3=7.d0+xyzzyaabk3*xyzzyaaay3
xyzzyaabt3=xyzzyaabk3*xyzzyaabt3*xyzzyaacd3
xyzzyaace3(1)=xyzzyaabt3*xyzzyaabj3
xyzzyaace3(2)=xyzzyaabt3*xyzzyaabh3
xyzzyaace3(3)=xyzzyaabt3*xyzzyaabg3
xyzzyaace3(4)=xyzzyaabt3*xyzzyaabi3
xyzzyaace3(5)=xyzzyaabt3*xyzzyaabf3
xyzzyaabu3=xyzzyaabc3+xyzzyaabd3-2.d0*xyzzyaabe3
xyzzyaacg3(1)=-xyzzyaabl3*xyzzyaabl3*xyzzyaabu3-xyzzyaabk3*(xyzzyaabu3&
&+4.d0*xyzzyaabc3)-2.d0
xyzzyaacg3(2)=-xyzzyaabm3*xyzzyaabm3*xyzzyaabu3-xyzzyaabk3*(xyzzyaabu3&
&+4.d0*xyzzyaabd3)-2.d0
xyzzyaacg3(3)=-xyzzyaabn3*xyzzyaabn3*xyzzyaabu3-xyzzyaabk3*(xyzzyaabu3&
&-8.d0*xyzzyaabe3)+4.d0
xyzzyaaby3=2.d0*(1.d0+xyzzyaabz3*xyzzyaabu3)
xyzzyaacg3(4)=xyzzyaack3*(xyzzyaaby3-6.d0)
xyzzyaacg3(5)=xyzzyaacl3*xyzzyaaby3
xyzzyaacg3(6)=xyzzyaacm3*xyzzyaaby3
xyzzyaacg3(7)=xyzzyaacl3*xyzzyaabv3
xyzzyaacg3(8)=xyzzyaacl3*xyzzyaabp3
xyzzyaacg3(9)=xyzzyaacl3*xyzzyaabx3
xyzzyaacg3(10)=xyzzyaacm3*xyzzyaabo3
xyzzyaacg3(11)=(-xyzzyaabo3)*(-xyzzyaabq3)
xyzzyaacg3(12)=xyzzyaack3*xyzzyaabq3
xyzzyaacg3(13)=xyzzyaacg3(10)
xyzzyaacg3(14)=xyzzyaacm3*xyzzyaabw3
xyzzyaacg3(15)=xyzzyaacm3*xyzzyaabx3
xyzzyaacg3(16)=xyzzyaacg3(8)
xyzzyaacg3(17)=xyzzyaack3*xyzzyaabq3
xyzzyaacg3(18)=(-xyzzyaabp3)*(-xyzzyaabq3)
xyzzyaacg3(19)=2.d0+xyzzyaabk3*(xyzzyaabo3*xyzzyaabi3+4.d0*xyzzyaabc3)
xyzzyaacg3(20)=xyzzyaabk3*(xyzzyaabp3*xyzzyaabi3-4.d0*xyzzyaabd3)-2.d0
xyzzyaacg3(21)=xyzzyaabk3*xyzzyaabi3*xyzzyaabq3
xyzzyaacg3(22)=xyzzyaabk3*xyzzyaabk3*xyzzyaabf3*xyzzyaabi3
xyzzyaacg3(23)=-2.d0*xyzzyaacl3*(xyzzyaabz3*xyzzyaabi3-1.d0)
xyzzyaacg3(24)=-2.d0*xyzzyaacm3*(xyzzyaabz3*xyzzyaabi3+1.d0)
xyzzyaacg3(25)=xyzzyaack3*xyzzyaabv3
xyzzyaacg3(26)=xyzzyaack3*xyzzyaabw3
xyzzyaacg3(27)=xyzzyaacg3(12)
xyzzyaacg3(28)=(-xyzzyaabo3)*(-xyzzyaabp3)
xyzzyaacg3(29)=xyzzyaacg3(10)
xyzzyaacg3(30)=xyzzyaacg3(8)
xyzzyaacg3(1:30)=xyzzyaacg3(1:30)*xyzzyaacd3
case(5)
xyzzyaacd3=c_prim(xyzzyaaaq3)*xyzzyaaca3
xyzzyaacn3=xyzzyaabc3*xyzzyaaaz3
xyzzyaaco3=xyzzyaabd3*xyzzyaaba3
xyzzyaacp3=xyzzyaabc3*xyzzyaabc3
xyzzyaacq3=xyzzyaabd3*xyzzyaabd3
xyzzyaacr3=xyzzyaabe3*xyzzyaabe3
xyzzyaacs3=xyzzyaabf3*xyzzyaabb3
xyzzyaais3=xyzzyaabc3*xyzzyaabd3
xyzzyaait3=xyzzyaabc3*xyzzyaabe3
xyzzyaaiu3=xyzzyaabd3*xyzzyaabe3
xyzzyaact3=xyzzyaabz3*xyzzyaabc3
xyzzyaacu3=xyzzyaabz3*xyzzyaabd3
xyzzyaacv3=xyzzyaabz3*xyzzyaabe3
xyzzyaaiv3=xyzzyaabz3*xyzzyaabz3
xyzzyaaiw3=xyzzyaabz3*xyzzyaacd3
xyzzyaaix3=xyzzyaaaz3*xyzzyaacd3
xyzzyaaiy3=xyzzyaaba3*xyzzyaacd3
xyzzyaaiz3=xyzzyaabb3*xyzzyaacd3
xyzzyaaja3=3.d0*xyzzyaabc3
xyzzyaajb3=3.d0*xyzzyaabd3
xyzzyaajc3=-2.d0*xyzzyaabe3
xyzzyaabo3=xyzzyaaja3+xyzzyaajb3+xyzzyaajc3
xyzzyaabp3=xyzzyaabz3*xyzzyaabo3
xyzzyaabq3=-3.d0+xyzzyaabp3
xyzzyaabr3=3.d0*xyzzyaacv3
xyzzyaabs3=-1.5d0+xyzzyaabr3
xyzzyaabt3=-12.d0*xyzzyaabe3
xyzzyaabu3=xyzzyaabt3+xyzzyaaja3+xyzzyaajb3
xyzzyaabv3=xyzzyaabz3*xyzzyaabu3
xyzzyaabw3=-3.d0+xyzzyaabv3
xyzzyaacw3=xyzzyaabf3*xyzzyaabw3*xyzzyaacd3
xyzzyaacx3=3.d0*xyzzyaacu3
xyzzyaajd3=6.d0*xyzzyaabe3
xyzzyaacy3=-12.d0*xyzzyaacv3
xyzzyaacz3=12.d0+xyzzyaabv3
xyzzyaada3=-30.d0*xyzzyaact3
xyzzyaadb3=30.d0*xyzzyaacu3
xyzzyaadc3=90.d0*xyzzyaacu3
xyzzyaadd3=-45.d0*xyzzyaabd3
xyzzyaaje3=-6.d0*xyzzyaabc3
xyzzyaajf3=-6.d0*xyzzyaabd3
xyzzyaade3=xyzzyaaje3+xyzzyaajf3+4.d0*xyzzyaabe3
xyzzyaadf3=-6.d0*xyzzyaacv3
xyzzyaadg3=3.d0+xyzzyaadf3
xyzzyaajg3=4.d0*xyzzyaacr3
xyzzyaajh3=15.d0*xyzzyaabc3
xyzzyaadh3=xyzzyaajh3+xyzzyaajb3+xyzzyaajc3
xyzzyaadi3=xyzzyaabz3*xyzzyaadh3
xyzzyaadj3=xyzzyaaiv3*xyzzyaade3*xyzzyaabc3
xyzzyaadk3=-3.d0+xyzzyaadi3+xyzzyaadj3
xyzzyaadl3=xyzzyaadk3*xyzzyaaiz3
xyzzyaaji3=15.d0*xyzzyaabd3
xyzzyaadm3=xyzzyaaji3+xyzzyaaja3+xyzzyaajc3
xyzzyaadn3=xyzzyaabz3*xyzzyaadm3
xyzzyaado3=xyzzyaaiv3*xyzzyaade3*xyzzyaabd3
xyzzyaadp3=-3.d0+xyzzyaadn3+xyzzyaado3
xyzzyaadq3=xyzzyaadp3*xyzzyaaiz3
xyzzyaajj3=9.d0*xyzzyaabc3
xyzzyaahq3=9.d0*xyzzyaabd3
xyzzyaahr3=-14.d0*xyzzyaabe3
xyzzyaadr3=xyzzyaajj3+xyzzyaahq3+xyzzyaahr3
xyzzyaads3=xyzzyaabz3*xyzzyaadr3
xyzzyaadt3=xyzzyaaiv3*xyzzyaade3*xyzzyaabe3
xyzzyaadu3=6.d0+xyzzyaads3+xyzzyaadt3
xyzzyaadv3=xyzzyaadu3*xyzzyaaiz3
xyzzyaahs3=24.d0*xyzzyaabe3
xyzzyaadw3=xyzzyaaje3+xyzzyaajf3+xyzzyaahs3
xyzzyaadx3=xyzzyaaiv3*xyzzyaadw3*xyzzyaabc3
xyzzyaaht3=21.d0*xyzzyaabc3
xyzzyaahu3=-36.d0*xyzzyaabe3
xyzzyaady3=xyzzyaahq3+xyzzyaaht3+xyzzyaahu3
xyzzyaadz3=xyzzyaabz3*xyzzyaady3
xyzzyaaea3=-9.d0+xyzzyaadz3+xyzzyaadx3
xyzzyaaeb3=xyzzyaaea3*xyzzyaaix3
xyzzyaaec3=xyzzyaabt3+xyzzyaaji3+xyzzyaaja3
xyzzyaaed3=xyzzyaabz3*xyzzyaaec3
xyzzyaaee3=xyzzyaaiv3*xyzzyaadw3*xyzzyaabd3
xyzzyaaef3=-3.d0+xyzzyaaed3+xyzzyaaee3
xyzzyaaeg3=xyzzyaaef3*xyzzyaaix3
xyzzyaahv3=-60.d0*xyzzyaabe3
xyzzyaaeh3=xyzzyaahv3+xyzzyaaja3+xyzzyaajb3
xyzzyaaei3=xyzzyaabz3*xyzzyaaeh3
xyzzyaaej3=xyzzyaaiv3*xyzzyaadw3*xyzzyaabe3
xyzzyaaek3=12.d0+xyzzyaaei3+xyzzyaaej3
xyzzyaael3=xyzzyaaek3*xyzzyaaix3
xyzzyaaem3=xyzzyaabt3+xyzzyaajh3+xyzzyaajb3
xyzzyaaen3=xyzzyaabz3*xyzzyaaem3
xyzzyaaeo3=-3.d0+xyzzyaadx3+xyzzyaaen3
xyzzyaaep3=xyzzyaaeo3*xyzzyaaiy3
xyzzyaaeq3=xyzzyaabz3*xyzzyaadw3
xyzzyaaer3=-18.d0+xyzzyaaeq3
xyzzyaaes3=xyzzyaacs3*xyzzyaaer3*xyzzyaaiw3
xyzzyaahw3=21.d0*xyzzyaabd3
xyzzyaaet3=xyzzyaajj3+xyzzyaahu3+xyzzyaahw3
xyzzyaaeu3=xyzzyaabz3*xyzzyaaet3
xyzzyaaev3=-9.d0+xyzzyaaee3+xyzzyaaeu3
xyzzyaaew3=xyzzyaaev3*xyzzyaaiy3
xyzzyaaex3=xyzzyaaek3*xyzzyaaiy3
xyzzyaahx3=30.d0*xyzzyaabd3
xyzzyaahy3=-30.d0*xyzzyaabc3
xyzzyaaey3=-60.d0*xyzzyaacv3
xyzzyaajk3=60.d0*xyzzyaabc3
xyzzyaajl3=-60.d0*xyzzyaabd3
xyzzyaaez3=xyzzyaajk3+xyzzyaajl3
xyzzyaafa3=xyzzyaaiv3*xyzzyaaez3*xyzzyaabe3
xyzzyaahz3=-150.d0*xyzzyaabc3
xyzzyaafb3=xyzzyaahx3+xyzzyaahz3
xyzzyaafc3=xyzzyaabz3*xyzzyaafb3
xyzzyaaia3=60.d0*xyzzyaacp3
xyzzyaafd3=-60.d0*xyzzyaais3
xyzzyaafe3=xyzzyaaia3+xyzzyaafd3
xyzzyaaff3=xyzzyaaiv3*xyzzyaafe3
xyzzyaafg3=30.d0+xyzzyaafc3+xyzzyaaff3
xyzzyaafh3=xyzzyaafg3*xyzzyaaiz3
xyzzyaaib3=150.d0*xyzzyaabd3
xyzzyaafi3=xyzzyaahy3+xyzzyaaib3
xyzzyaafj3=xyzzyaabz3*xyzzyaafi3
xyzzyaafk3=60.d0*xyzzyaais3
xyzzyaaic3=-60.d0*xyzzyaacq3
xyzzyaafl3=xyzzyaafk3+xyzzyaaic3
xyzzyaafm3=xyzzyaaiv3*xyzzyaafl3
xyzzyaafn3=-30.d0+xyzzyaafj3+xyzzyaafm3
xyzzyaafo3=xyzzyaafn3*xyzzyaaiz3
xyzzyaafp3=90.d0+xyzzyaaey3
xyzzyaafq3=xyzzyaafp3*xyzzyaabd3
xyzzyaafr3=-90.d0-xyzzyaaey3
xyzzyaafs3=xyzzyaafr3*xyzzyaabc3
xyzzyaaft3=xyzzyaafq3+xyzzyaafs3
xyzzyaafu3=xyzzyaabb3*xyzzyaaft3*xyzzyaaiw3
xyzzyaaid3=-60.d0*xyzzyaact3
xyzzyaaie3=-60.d0*xyzzyaacu3
xyzzyaaif3=120.d0*xyzzyaact3
xyzzyaafv3=-180.d0+xyzzyaaif3
xyzzyaafw3=xyzzyaacs3*xyzzyaafv3*xyzzyaaiw3
xyzzyaaig3=120.d0*xyzzyaacu3
xyzzyaafx3=-180.d0+xyzzyaaig3
xyzzyaafy3=xyzzyaacs3*xyzzyaafx3*xyzzyaaiw3
xyzzyaaih3=120.d0*xyzzyaacv3
xyzzyaafz3=-180.d0+xyzzyaaih3
xyzzyaaga3=xyzzyaacs3*xyzzyaafz3*xyzzyaaiw3
xyzzyaaii3=90.d0*xyzzyaabd3
xyzzyaagb3=-180.d0*xyzzyaais3
xyzzyaagc3=xyzzyaaia3+xyzzyaagb3
xyzzyaagd3=xyzzyaaiv3*xyzzyaagc3
xyzzyaage3=-180.d0*xyzzyaacu3
xyzzyaaij3=-210.d0*xyzzyaabc3
xyzzyaaik3=270.d0*xyzzyaabd3
xyzzyaagf3=xyzzyaaij3+xyzzyaaik3
xyzzyaagg3=xyzzyaabz3*xyzzyaagf3
xyzzyaagh3=90.d0+xyzzyaagg3+xyzzyaagd3
xyzzyaagi3=xyzzyaagh3*xyzzyaaix3
xyzzyaail3=450.d0*xyzzyaabd3
xyzzyaagj3=xyzzyaahy3+xyzzyaail3
xyzzyaagk3=xyzzyaabz3*xyzzyaagj3
xyzzyaaim3=-180.d0*xyzzyaacq3
xyzzyaagl3=xyzzyaafk3+xyzzyaaim3
xyzzyaagm3=xyzzyaaiv3*xyzzyaagl3
xyzzyaagn3=-90.d0+xyzzyaagk3+xyzzyaagm3
xyzzyaago3=xyzzyaagn3*xyzzyaaix3
xyzzyaagp3=-180.d0*xyzzyaacv3
xyzzyaagq3=90.d0+xyzzyaagp3
xyzzyaagr3=xyzzyaagq3*xyzzyaabd3
xyzzyaags3=-30.d0-xyzzyaaey3
xyzzyaagt3=xyzzyaags3*xyzzyaabc3
xyzzyaagu3=xyzzyaagr3+xyzzyaagt3
xyzzyaagv3=xyzzyaaaz3*xyzzyaagu3*xyzzyaaiw3
xyzzyaagw3=30.d0+xyzzyaaey3
xyzzyaain3=-90.d0*xyzzyaabc3
xyzzyaagx3=180.d0*xyzzyaais3
xyzzyaagy3=xyzzyaaic3+xyzzyaagx3
xyzzyaagz3=xyzzyaaiv3*xyzzyaagy3
xyzzyaaio3=-450.d0*xyzzyaabc3
xyzzyaaha3=xyzzyaahx3+xyzzyaaio3
xyzzyaahb3=xyzzyaabz3*xyzzyaaha3
xyzzyaaip3=180.d0*xyzzyaacp3
xyzzyaahc3=xyzzyaafd3+xyzzyaaip3
xyzzyaahd3=xyzzyaaiv3*xyzzyaahc3
xyzzyaahe3=90.d0+xyzzyaahb3+xyzzyaahd3
xyzzyaahf3=xyzzyaahe3*xyzzyaaiy3
xyzzyaaiq3=-270.d0*xyzzyaabc3
xyzzyaair3=210.d0*xyzzyaabd3
xyzzyaahg3=xyzzyaaiq3+xyzzyaair3
xyzzyaahh3=xyzzyaabz3*xyzzyaahg3
xyzzyaahi3=-9.d1+xyzzyaahh3+xyzzyaagz3
xyzzyaahj3=xyzzyaahi3*xyzzyaaiy3
xyzzyaahk3=xyzzyaagw3*xyzzyaabd3
xyzzyaahl3=180.d0*xyzzyaacv3
xyzzyaahm3=-90.d0+xyzzyaahl3
xyzzyaahn3=xyzzyaahm3*xyzzyaabc3
xyzzyaaho3=xyzzyaahk3+xyzzyaahn3
xyzzyaahp3=xyzzyaaba3*xyzzyaaho3*xyzzyaaiw3
xyzzyaacf3(1)=xyzzyaabh3*xyzzyaacd3*xyzzyaabq3
xyzzyaacf3(2)=xyzzyaabg3*xyzzyaacd3*xyzzyaabq3
xyzzyaacf3(3)=xyzzyaacd3*(3.d0*xyzzyaabe3-2.d0*xyzzyaabz3*xyzzyaacr3+x&
&yzzyaabs3*(xyzzyaabc3+xyzzyaabd3))
xyzzyaacf3(4)=xyzzyaacd3*((-4.5d0+xyzzyaacx3+xyzzyaacy3)*xyzzyaabc3-1.&
&5d0*xyzzyaabd3+3.d0*xyzzyaabz3*xyzzyaacp3+xyzzyaajd3)
xyzzyaacf3(5)=xyzzyaacw3
xyzzyaacf3(6)=xyzzyaabh3*xyzzyaacz3*xyzzyaacd3
xyzzyaacf3(7)=xyzzyaacw3
xyzzyaacf3(8)=xyzzyaacd3*(3.d0*xyzzyaabz3*xyzzyaacq3+(-1.5d0+xyzzyaacx&
&3)*xyzzyaabc3+(-4.5d0+xyzzyaacy3)*xyzzyaabd3+xyzzyaajd3)
xyzzyaacf3(9)=xyzzyaabg3*xyzzyaacz3*xyzzyaacd3
xyzzyaacf3(10)=xyzzyaabh3*(30.d0+xyzzyaada3+xyzzyaadb3)*xyzzyaacd3
xyzzyaacf3(11)=xyzzyaabg3*(-30.d0+xyzzyaada3+xyzzyaadb3)*xyzzyaacd3
xyzzyaacf3(12)=(xyzzyaabc3*(15.d0-30.d0*xyzzyaacv3)+xyzzyaabd3*(-15.d0&
&+30.d0*xyzzyaacv3))*xyzzyaacd3
xyzzyaacf3(13)=xyzzyaabg3*(30.d0+xyzzyaaid3)*xyzzyaacd3
xyzzyaacf3(14)=xyzzyaabh3*(30.d0+xyzzyaaie3)*xyzzyaacd3
xyzzyaacf3(15)=xyzzyaabf3*xyzzyaagw3*xyzzyaacd3
xyzzyaacf3(16)=xyzzyaacd3*(xyzzyaadd3+(45.d0+xyzzyaadc3)*xyzzyaabc3-30&
&.d0*xyzzyaabz3*xyzzyaacp3)
xyzzyaacf3(17)=xyzzyaabf3*(-90.d0+xyzzyaada3+xyzzyaadc3)*xyzzyaacd3
xyzzyaacf3(18)=xyzzyaabz3*xyzzyaabh3*(xyzzyaahy3+xyzzyaaii3)*xyzzyaacd&
&3
xyzzyaacf3(19)=xyzzyaabf3*(90.d0+xyzzyaadb3-90.d0*xyzzyaact3)*xyzzyaac&
&d3
xyzzyaacf3(20)=(30.d0*xyzzyaabz3*xyzzyaacq3+xyzzyaadd3+xyzzyaabc3*(45.&
&d0-90.d0*xyzzyaacu3))*xyzzyaacd3
xyzzyaacf3(21)=xyzzyaabg3*(xyzzyaain3+xyzzyaahx3)*xyzzyaaiw3
xyzzyaacg3(1)=xyzzyaadl3
xyzzyaacg3(2)=xyzzyaadq3
xyzzyaacg3(3)=xyzzyaadv3
xyzzyaacg3(4)=(12.d0+xyzzyaabz3*xyzzyaade3)*xyzzyaacs3*xyzzyaaiw3
xyzzyaacg3(5)=xyzzyaacd3*(xyzzyaabz3*xyzzyaadg3*xyzzyaacn3+xyzzyaaaz3*&
&(-3.d0+xyzzyaaiv3*(xyzzyaajg3-6.d0*xyzzyaaiu3)+xyzzyaabz3*xyzzyaajb3)&
&)
xyzzyaacg3(6)=xyzzyaacd3*(xyzzyaabz3*xyzzyaadg3*xyzzyaaco3+xyzzyaaba3*&
&(-3.d0+xyzzyaaiv3*(xyzzyaajg3-6.d0*xyzzyaait3)+xyzzyaabz3*xyzzyaaja3)&
&)
xyzzyaacg3(7)=xyzzyaaeb3
xyzzyaacg3(8)=xyzzyaaeg3
xyzzyaacg3(9)=xyzzyaael3
xyzzyaacg3(10)=xyzzyaaep3
xyzzyaacg3(11)=xyzzyaaiz3*(12.d0+xyzzyaadx3+xyzzyaabz3*(xyzzyaabt3-15.&
&d0*xyzzyaabc3+xyzzyaajb3))
xyzzyaacg3(12)=xyzzyaaes3
xyzzyaacg3(13)=xyzzyaaep3
xyzzyaacg3(14)=xyzzyaaew3
xyzzyaacg3(15)=xyzzyaaex3
xyzzyaacg3(16)=xyzzyaaeg3
xyzzyaacg3(17)=xyzzyaaes3
xyzzyaacg3(18)=xyzzyaaiz3*(12.d0+xyzzyaaee3+xyzzyaabz3*(xyzzyaabt3-15.&
&d0*xyzzyaabd3+xyzzyaaja3))
xyzzyaacg3(19)=xyzzyaafh3
xyzzyaacg3(20)=xyzzyaafo3
xyzzyaacg3(21)=xyzzyaafu3
xyzzyaacg3(22)=60.d0*xyzzyaacs3*xyzzyaaiv3*(xyzzyaabc3-xyzzyaabd3)*xyz&
&zyaacd3
xyzzyaacg3(23)=(30.d0+xyzzyaabz3*(xyzzyaahy3+xyzzyaahx3+xyzzyaahv3)+xy&
&zzyaafa3)*xyzzyaaix3
xyzzyaacg3(24)=(-30.d0+xyzzyaafa3+xyzzyaabz3*(xyzzyaahy3+xyzzyaahx3+60&
&.d0*xyzzyaabe3))*xyzzyaaiy3
xyzzyaacg3(25)=xyzzyaafw3
xyzzyaacg3(26)=xyzzyaafy3
xyzzyaacg3(27)=xyzzyaaga3
xyzzyaacg3(28)=(30.d0+xyzzyaaid3+xyzzyaaie3+120.d0*xyzzyaaiv3*xyzzyaai&
&s3)*xyzzyaaiz3
xyzzyaacg3(29)=(30.d0+xyzzyaaid3+xyzzyaaey3+120.d0*xyzzyaaiv3*xyzzyaai&
&t3)*xyzzyaaiy3
xyzzyaacg3(30)=(30.d0+xyzzyaaie3+xyzzyaaey3+120.d0*xyzzyaaiv3*xyzzyaai&
&u3)*xyzzyaaix3
xyzzyaacg3(31)=xyzzyaagi3
xyzzyaacg3(32)=xyzzyaago3
xyzzyaacg3(33)=xyzzyaagv3
xyzzyaacg3(34)=(-90.d0+xyzzyaagd3+xyzzyaabz3*(xyzzyaaii3+90.d0*xyzzyaa&
&bc3))*xyzzyaaiy3
xyzzyaacg3(35)=(xyzzyaaii3+(-90.d0+xyzzyaage3)*xyzzyaabc3+60.d0*xyzzya&
&abz3*xyzzyaacp3)*xyzzyaabb3*xyzzyaaiw3
xyzzyaacg3(36)=(180.d0+xyzzyaage3+60.d0*xyzzyaact3)*xyzzyaacs3*xyzzyaa&
&iw3
xyzzyaacg3(37)=xyzzyaahf3
xyzzyaacg3(38)=xyzzyaahj3
xyzzyaacg3(39)=xyzzyaahp3
xyzzyaacg3(40)=(90.d0+xyzzyaagz3+xyzzyaabz3*(xyzzyaain3-90.d0*xyzzyaab&
&d3))*xyzzyaaix3
xyzzyaacg3(41)=(xyzzyaaie3+180.d0*(xyzzyaact3-1.d0))*xyzzyaacs3*xyzzya&
&aiw3
xyzzyaacg3(42)=(-60.d0*xyzzyaabz3*xyzzyaacq3+xyzzyaaii3+xyzzyaabc3*(-9&
&0.d0+180.d0*xyzzyaacu3))*xyzzyaabb3*xyzzyaaiw3
end select
do xyzzyaaao3=1,xyzzyaaah3
xyzzyaach3(xyzzyaaao3)=xyzzyaach3(xyzzyaaao3)+xyzzyaace3(xyzzyaaao3)
enddo
do xyzzyaaao3=1,xyzzyaaai3
xyzzyaaci3(xyzzyaaao3)=xyzzyaaci3(xyzzyaaao3)+xyzzyaacf3(xyzzyaaao3)
enddo
do xyzzyaaao3=1,xyzzyaaaj3
xyzzyaacj3(xyzzyaaao3)=xyzzyaacj3(xyzzyaaao3)+xyzzyaacg3(xyzzyaaao3)
enddo
enddo
if(xyzzyaajn3)then
xyzzyaaau3=first_ao(xyzzyaaaf3)
call gmult(rblap(xyzzyaaau3,1),num_ao,num_real_k,xyzzyaach3,phase,xyzz&
&yaaah3)
call g3mult(rbgra1(xyzzyaaau3,1),rbgra2(xyzzyaaau3,1),rbgra3(xyzzyaaau&
&3,1),num_ao,num_real_k,xyzzyaaci3,phase,xyzzyaaah3)
call g6mult(rbsderiv1(xyzzyaaau3,1),rbsderiv2(xyzzyaaau3,1),rbsderiv3(&
&xyzzyaaau3,1),rbsderiv4(xyzzyaaau3,1),rbsderiv5(xyzzyaaau3,1),rbsderi&
&v6(xyzzyaaau3,1),num_ao,num_real_k,xyzzyaacj3,phase,xyzzyaaah3)
xyzzyaaav3=xyzzyaaau3+xyzzyaaah3-1
do xyzzyaaab3=num_real_k_plus_1,num_k
xyzzyaajm3=cphase(xyzzyaaab3)
cblap(xyzzyaaau3:xyzzyaaav3,xyzzyaaab3)=cblap(xyzzyaaau3:xyzzyaaav3,xy&
&zzyaaab3)+cmplx(xyzzyaach3(1:xyzzyaaah3),0.d0,kind=dp)*xyzzyaajm3
cbgra1(xyzzyaaau3:xyzzyaaav3,xyzzyaaab3)=cbgra1(xyzzyaaau3:xyzzyaaav3,&
&xyzzyaaab3)+cmplx(xyzzyaaci3(1:xyzzyaaai3:3),0.d0,kind=dp)*xyzzyaajm3
cbgra2(xyzzyaaau3:xyzzyaaav3,xyzzyaaab3)=cbgra2(xyzzyaaau3:xyzzyaaav3,&
&xyzzyaaab3)+cmplx(xyzzyaaci3(2:xyzzyaaai3:3),0.d0,kind=dp)*xyzzyaajm3
cbgra3(xyzzyaaau3:xyzzyaaav3,xyzzyaaab3)=cbgra3(xyzzyaaau3:xyzzyaaav3,&
&xyzzyaaab3)+cmplx(xyzzyaaci3(3:xyzzyaaai3:3),0.d0,kind=dp)*xyzzyaajm3
cbsderiv1(xyzzyaaau3:xyzzyaaav3,xyzzyaaab3)=cbsderiv1(xyzzyaaau3:xyzzy&
&aaav3,xyzzyaaab3)+cmplx(xyzzyaacj3(1:xyzzyaaaj3:6),0.d0,kind=dp)*xyzz&
&yaajm3
cbsderiv2(xyzzyaaau3:xyzzyaaav3,xyzzyaaab3)=cbsderiv2(xyzzyaaau3:xyzzy&
&aaav3,xyzzyaaab3)+cmplx(xyzzyaacj3(2:xyzzyaaaj3:6),0.d0,kind=dp)*xyzz&
&yaajm3
cbsderiv3(xyzzyaaau3:xyzzyaaav3,xyzzyaaab3)=cbsderiv3(xyzzyaaau3:xyzzy&
&aaav3,xyzzyaaab3)+cmplx(xyzzyaacj3(3:xyzzyaaaj3:6),0.d0,kind=dp)*xyzz&
&yaajm3
cbsderiv4(xyzzyaaau3:xyzzyaaav3,xyzzyaaab3)=cbsderiv4(xyzzyaaau3:xyzzy&
&aaav3,xyzzyaaab3)+cmplx(xyzzyaacj3(4:xyzzyaaaj3:6),0.d0,kind=dp)*xyzz&
&yaajm3
cbsderiv5(xyzzyaaau3:xyzzyaaav3,xyzzyaaab3)=cbsderiv5(xyzzyaaau3:xyzzy&
&aaav3,xyzzyaaab3)+cmplx(xyzzyaacj3(5:xyzzyaaaj3:6),0.d0,kind=dp)*xyzz&
&yaajm3
cbsderiv6(xyzzyaaau3:xyzzyaaav3,xyzzyaaab3)=cbsderiv6(xyzzyaaau3:xyzzy&
&aaav3,xyzzyaaab3)+cmplx(xyzzyaacj3(6:xyzzyaaaj3:6),0.d0,kind=dp)*xyzz&
&yaajm3
enddo
endif
enddo
enddo
enddo
xyzzyaaaw3=0
do xyzzyaaaf3=1,num_shells
if(.not.xyzzyaajo3(xyzzyaaaf3))cycle
xyzzyaaau3=first_ao(xyzzyaaaf3)-1
do xyzzyaaao3=1,numao_in_shell(xyzzyaaaf3)
xyzzyaaaw3=xyzzyaaaw3+1
xyzzyaaax3(xyzzyaaaw3)=xyzzyaaau3+xyzzyaaao3
enddo
enddo
if(use_gpcc)call cusp_wfdet_cmplx(rvec,jspin,.false.,.true.,cusp_val_c&
&,cusp_grad_c,cusp_lap_c,cusp_sderivs_c)
xyzzyaaam3=0
xyzzyaaan3=0
xyzzyaaak3=gauss_offset(jspin)
xyzzyaaal3=gauss_offsetc(jspin)
do xyzzyaaab3=1,num_real_k
xyzzyaaad3=nband(xyzzyaaab3,xyzzyaaaa1)
orb2(xyzzyaaam3+1:xyzzyaaam3+xyzzyaaad3)=multi_ddot_s(xyzzyaaad3,xyzzy&
&aaaw3,xyzzyaaax3,corbmask(xyzzyaaan3+xyzzyaaal3),rck(:,:,xyzzyaaab3,x&
&yzzyaaab1),maxb*num_ao,maxb,rblap(1,xyzzyaaab3),rnorm)
orb3(xyzzyaaam3+1:xyzzyaaam3+xyzzyaaad3)=multi_ddot_s(xyzzyaaad3,xyzzy&
&aaaw3,xyzzyaaax3,corbmask(xyzzyaaan3+xyzzyaaal3),rck(:,:,xyzzyaaab3,x&
&yzzyaaab1),maxb*num_ao,maxb,rbgra1(1,xyzzyaaab3),rnorm)
orb4(xyzzyaaam3+1:xyzzyaaam3+xyzzyaaad3)=multi_ddot_s(xyzzyaaad3,xyzzy&
&aaaw3,xyzzyaaax3,corbmask(xyzzyaaan3+xyzzyaaal3),rck(:,:,xyzzyaaab3,x&
&yzzyaaab1),maxb*num_ao,maxb,rbgra2(1,xyzzyaaab3),rnorm)
orb5(xyzzyaaam3+1:xyzzyaaam3+xyzzyaaad3)=multi_ddot_s(xyzzyaaad3,xyzzy&
&aaaw3,xyzzyaaax3,corbmask(xyzzyaaan3+xyzzyaaal3),rck(:,:,xyzzyaaab3,x&
&yzzyaaab1),maxb*num_ao,maxb,rbgra3(1,xyzzyaaab3),rnorm)
orb6(xyzzyaaam3+1:xyzzyaaam3+xyzzyaaad3)=multi_ddot_s(xyzzyaaad3,xyzzy&
&aaaw3,xyzzyaaax3,corbmask(xyzzyaaan3+xyzzyaaal3),rck(:,:,xyzzyaaab3,x&
&yzzyaaab1),maxb*num_ao,maxb,rbsderiv1(1,xyzzyaaab3),rnorm)
orb7(xyzzyaaam3+1:xyzzyaaam3+xyzzyaaad3)=multi_ddot_s(xyzzyaaad3,xyzzy&
&aaaw3,xyzzyaaax3,corbmask(xyzzyaaan3+xyzzyaaal3),rck(:,:,xyzzyaaab3,x&
&yzzyaaab1),maxb*num_ao,maxb,rbsderiv2(1,xyzzyaaab3),rnorm)
orb8(xyzzyaaam3+1:xyzzyaaam3+xyzzyaaad3)=multi_ddot_s(xyzzyaaad3,xyzzy&
&aaaw3,xyzzyaaax3,corbmask(xyzzyaaan3+xyzzyaaal3),rck(:,:,xyzzyaaab3,x&
&yzzyaaab1),maxb*num_ao,maxb,rbsderiv3(1,xyzzyaaab3),rnorm)
orb9(xyzzyaaam3+1:xyzzyaaam3+xyzzyaaad3)=multi_ddot_s(xyzzyaaad3,xyzzy&
&aaaw3,xyzzyaaax3,corbmask(xyzzyaaan3+xyzzyaaal3),rck(:,:,xyzzyaaab3,x&
&yzzyaaab1),maxb*num_ao,maxb,rbsderiv4(1,xyzzyaaab3),rnorm)
orb10(xyzzyaaam3+1:xyzzyaaam3+xyzzyaaad3)=multi_ddot_s(xyzzyaaad3,xyzz&
&yaaaw3,xyzzyaaax3,corbmask(xyzzyaaan3+xyzzyaaal3),rck(:,:,xyzzyaaab3,&
&xyzzyaaab1),maxb*num_ao,maxb,rbsderiv5(1,xyzzyaaab3),rnorm)
orb11(xyzzyaaam3+1:xyzzyaaam3+xyzzyaaad3)=multi_ddot_s(xyzzyaaad3,xyzz&
&yaaaw3,xyzzyaaax3,corbmask(xyzzyaaan3+xyzzyaaal3),rck(:,:,xyzzyaaab3,&
&xyzzyaaab1),maxb*num_ao,maxb,rbsderiv6(1,xyzzyaaab3),rnorm)
xyzzyaaam3=xyzzyaaam3+xyzzyaaad3
xyzzyaaan3=xyzzyaaan3+xyzzyaaad3
enddo
if(use_gpcc)then
do xyzzyaaao3=1,xyzzyaaam3
if(.not.corbmask(xyzzyaaao3+xyzzyaaal3-1))cycle
orb2(xyzzyaaao3)=orb2(xyzzyaaao3)+dble(cusp_lap_c(xyzzyaaao3+xyzzyaaal&
&3-1))
orb3(xyzzyaaao3)=orb3(xyzzyaaao3)+dble(cusp_grad_c(1,xyzzyaaao3+xyzzya&
&aal3-1))
orb4(xyzzyaaao3)=orb4(xyzzyaaao3)+dble(cusp_grad_c(2,xyzzyaaao3+xyzzya&
&aal3-1))
orb5(xyzzyaaao3)=orb5(xyzzyaaao3)+dble(cusp_grad_c(3,xyzzyaaao3+xyzzya&
&aal3-1))
orb6(xyzzyaaao3)=orb6(xyzzyaaao3)+dble(cusp_sderivs_c(1,xyzzyaaao3+xyz&
&zyaaal3-1))
orb7(xyzzyaaao3)=orb7(xyzzyaaao3)+dble(cusp_sderivs_c(2,xyzzyaaao3+xyz&
&zyaaal3-1))
orb8(xyzzyaaao3)=orb8(xyzzyaaao3)+dble(cusp_sderivs_c(3,xyzzyaaao3+xyz&
&zyaaal3-1))
orb9(xyzzyaaao3)=orb9(xyzzyaaao3)+dble(cusp_sderivs_c(4,xyzzyaaao3+xyz&
&zyaaal3-1))
orb10(xyzzyaaao3)=orb10(xyzzyaaao3)+dble(cusp_sderivs_c(5,xyzzyaaao3+x&
&yzzyaaal3-1))
orb11(xyzzyaaao3)=orb11(xyzzyaaao3)+dble(cusp_sderivs_c(6,xyzzyaaao3+x&
&yzzyaaal3-1))
enddo
endif
if(complex_states)then
do xyzzyaaab3=num_real_k_plus_1,num_k
xyzzyaaad3=nband(xyzzyaaab3,xyzzyaaaa1)
corb2(1:xyzzyaaad3)=multi_zdotu_s(xyzzyaaad3,xyzzyaaaw3,xyzzyaaax3,cor&
&bmask(xyzzyaaan3+xyzzyaaal3),cck(:,:,xyzzyaaab3,xyzzyaaab1),maxb*num_&
&ao,maxb,cblap(1,xyzzyaaab3),two_rnorm)
corb3(1:xyzzyaaad3)=multi_zdotu_s(xyzzyaaad3,xyzzyaaaw3,xyzzyaaax3,cor&
&bmask(xyzzyaaan3+xyzzyaaal3),cck(:,:,xyzzyaaab3,xyzzyaaab1),maxb*num_&
&ao,maxb,cbgra1(1,xyzzyaaab3),two_rnorm)
corb4(1:xyzzyaaad3)=multi_zdotu_s(xyzzyaaad3,xyzzyaaaw3,xyzzyaaax3,cor&
&bmask(xyzzyaaan3+xyzzyaaal3),cck(:,:,xyzzyaaab3,xyzzyaaab1),maxb*num_&
&ao,maxb,cbgra2(1,xyzzyaaab3),two_rnorm)
corb5(1:xyzzyaaad3)=multi_zdotu_s(xyzzyaaad3,xyzzyaaaw3,xyzzyaaax3,cor&
&bmask(xyzzyaaan3+xyzzyaaal3),cck(:,:,xyzzyaaab3,xyzzyaaab1),maxb*num_&
&ao,maxb,cbgra3(1,xyzzyaaab3),two_rnorm)
corb6(1:xyzzyaaad3)=multi_zdotu_s(xyzzyaaad3,xyzzyaaaw3,xyzzyaaax3,cor&
&bmask(xyzzyaaan3+xyzzyaaal3),cck(:,:,xyzzyaaab3,xyzzyaaab1),maxb*num_&
&ao,maxb,cbsderiv1(1,xyzzyaaab3),two_rnorm)
corb7(1:xyzzyaaad3)=multi_zdotu_s(xyzzyaaad3,xyzzyaaaw3,xyzzyaaax3,cor&
&bmask(xyzzyaaan3+xyzzyaaal3),cck(:,:,xyzzyaaab3,xyzzyaaab1),maxb*num_&
&ao,maxb,cbsderiv2(1,xyzzyaaab3),two_rnorm)
corb8(1:xyzzyaaad3)=multi_zdotu_s(xyzzyaaad3,xyzzyaaaw3,xyzzyaaax3,cor&
&bmask(xyzzyaaan3+xyzzyaaal3),cck(:,:,xyzzyaaab3,xyzzyaaab1),maxb*num_&
&ao,maxb,cbsderiv3(1,xyzzyaaab3),two_rnorm)
corb9(1:xyzzyaaad3)=multi_zdotu_s(xyzzyaaad3,xyzzyaaaw3,xyzzyaaax3,cor&
&bmask(xyzzyaaan3+xyzzyaaal3),cck(:,:,xyzzyaaab3,xyzzyaaab1),maxb*num_&
&ao,maxb,cbsderiv4(1,xyzzyaaab3),two_rnorm)
corb10(1:xyzzyaaad3)=multi_zdotu_s(xyzzyaaad3,xyzzyaaaw3,xyzzyaaax3,co&
&rbmask(xyzzyaaan3+xyzzyaaal3),cck(:,:,xyzzyaaab3,xyzzyaaab1),maxb*num&
&_ao,maxb,cbsderiv5(1,xyzzyaaab3),two_rnorm)
corb11(1:xyzzyaaad3)=multi_zdotu_s(xyzzyaaad3,xyzzyaaaw3,xyzzyaaax3,co&
&rbmask(xyzzyaaan3+xyzzyaaal3),cck(:,:,xyzzyaaab3,xyzzyaaab1),maxb*num&
&_ao,maxb,cbsderiv6(1,xyzzyaaab3),two_rnorm)
do xyzzyaaao3=1,xyzzyaaad3
xyzzyaaam3=xyzzyaaam3+1
xyzzyaaan3=xyzzyaaan3+1
if(.not.corbmask(xyzzyaaan3+xyzzyaaal3-1))cycle
if(use_gpcc)then
corb2(xyzzyaaao3)=corb2(xyzzyaaao3)+cusp_lap_c(xyzzyaaan3+xyzzyaaal3-1&
&)
corb3(xyzzyaaao3)=corb3(xyzzyaaao3)+cusp_grad_c(1,xyzzyaaan3+xyzzyaaal&
&3-1)
corb4(xyzzyaaao3)=corb4(xyzzyaaao3)+cusp_grad_c(2,xyzzyaaan3+xyzzyaaal&
&3-1)
corb5(xyzzyaaao3)=corb5(xyzzyaaao3)+cusp_grad_c(3,xyzzyaaan3+xyzzyaaal&
&3-1)
corb6(xyzzyaaao3)=corb6(xyzzyaaao3)+cusp_sderivs_c(1,xyzzyaaan3+xyzzya&
&aal3-1)
corb7(xyzzyaaao3)=corb7(xyzzyaaao3)+cusp_sderivs_c(2,xyzzyaaan3+xyzzya&
&aal3-1)
corb8(xyzzyaaao3)=corb8(xyzzyaaao3)+cusp_sderivs_c(3,xyzzyaaan3+xyzzya&
&aal3-1)
corb9(xyzzyaaao3)=corb9(xyzzyaaao3)+cusp_sderivs_c(4,xyzzyaaan3+xyzzya&
&aal3-1)
corb10(xyzzyaaao3)=corb10(xyzzyaaao3)+cusp_sderivs_c(5,xyzzyaaan3+xyzz&
&yaaal3-1)
corb11(xyzzyaaao3)=corb11(xyzzyaaao3)+cusp_sderivs_c(6,xyzzyaaan3+xyzz&
&yaaal3-1)
endif
orb2(xyzzyaaam3)=dble(corb2(xyzzyaaao3))
orb3(xyzzyaaam3)=dble(corb3(xyzzyaaao3))
orb4(xyzzyaaam3)=dble(corb4(xyzzyaaao3))
orb5(xyzzyaaam3)=dble(corb5(xyzzyaaao3))
orb6(xyzzyaaam3)=dble(corb6(xyzzyaaao3))
orb7(xyzzyaaam3)=dble(corb7(xyzzyaaao3))
orb8(xyzzyaaam3)=dble(corb8(xyzzyaaao3))
orb9(xyzzyaaam3)=dble(corb9(xyzzyaaao3))
orb10(xyzzyaaam3)=dble(corb10(xyzzyaaao3))
orb11(xyzzyaaam3)=dble(corb11(xyzzyaaao3))
if(xyzzyaaam3+1<=nuc_nele(jspin))then
xyzzyaaam3=xyzzyaaam3+1
orb2(xyzzyaaam3)=aimag(corb2(xyzzyaaao3))
orb3(xyzzyaaam3)=aimag(corb3(xyzzyaaao3))
orb4(xyzzyaaam3)=aimag(corb4(xyzzyaaao3))
orb5(xyzzyaaam3)=aimag(corb5(xyzzyaaao3))
orb6(xyzzyaaam3)=aimag(corb6(xyzzyaaao3))
orb7(xyzzyaaam3)=aimag(corb7(xyzzyaaao3))
orb8(xyzzyaaam3)=aimag(corb8(xyzzyaaao3))
orb9(xyzzyaaam3)=aimag(corb9(xyzzyaaao3))
orb10(xyzzyaaam3)=aimag(corb10(xyzzyaaao3))
orb11(xyzzyaaam3)=aimag(corb11(xyzzyaaao3))
endif
enddo
enddo
endif
call dcopy(xyzzyaaam3,orb2(1),1,orblap(xyzzyaaak3,1),1)
call dcopy(xyzzyaaam3,orb3(1),1,orbgrad(1,xyzzyaaak3,1),3)
call dcopy(xyzzyaaam3,orb4(1),1,orbgrad(2,xyzzyaaak3,1),3)
call dcopy(xyzzyaaam3,orb5(1),1,orbgrad(3,xyzzyaaak3,1),3)
call dcopy(xyzzyaaam3,orb6(1),1,orbsderivs(1,xyzzyaaak3,1),6)
call dcopy(xyzzyaaam3,orb7(1),1,orbsderivs(2,xyzzyaaak3,1),6)
call dcopy(xyzzyaaam3,orb8(1),1,orbsderivs(3,xyzzyaaak3,1),6)
call dcopy(xyzzyaaam3,orb9(1),1,orbsderivs(4,xyzzyaaak3,1),6)
call dcopy(xyzzyaaam3,orb10(1),1,orbsderivs(5,xyzzyaaak3,1),6)
call dcopy(xyzzyaaam3,orb11(1),1,orbsderivs(6,xyzzyaaak3,1),6)
if(excite)then
do xyzzyaaao3=1,gauss_ex_norb
if(.not.orbmask(gauss_gs_norb+xyzzyaaao3))cycle
xyzzyaaab3=virtual_k(xyzzyaaao3,jspin)
xyzzyaaad3=full2vrt(xyzzyaaao3,jspin)
if(xyzzyaaab3<=num_real_k)then
flap(xyzzyaaao3)=sum(rblap(:,xyzzyaaab3)*rck_ex(:,xyzzyaaad3,jspin))*r&
&norm
fgra1(xyzzyaaao3)=sum(rbgra1(:,xyzzyaaab3)*rck_ex(:,xyzzyaaad3,jspin))&
&*rnorm
fgra2(xyzzyaaao3)=sum(rbgra2(:,xyzzyaaab3)*rck_ex(:,xyzzyaaad3,jspin))&
&*rnorm
fgra3(xyzzyaaao3)=sum(rbgra3(:,xyzzyaaab3)*rck_ex(:,xyzzyaaad3,jspin))&
&*rnorm
else
flap(xyzzyaaao3)=sum(dble(cblap(:,xyzzyaaab3)*cck_ex(:,xyzzyaaad3,jspi&
&n)))*two_rnorm
fgra1(xyzzyaaao3)=sum(dble(cbgra1(:,xyzzyaaab3)*cck_ex(:,xyzzyaaad3,js&
&pin)))*two_rnorm
fgra2(xyzzyaaao3)=sum(dble(cbgra2(:,xyzzyaaab3)*cck_ex(:,xyzzyaaad3,js&
&pin)))*two_rnorm
fgra3(xyzzyaaao3)=sum(dble(cbgra3(:,xyzzyaaab3)*cck_ex(:,xyzzyaaad3,js&
&pin)))*two_rnorm
endif
enddo
if(use_gpcc)then
do xyzzyaaao3=1,gauss_ex_norb
xyzzyaaap3=gauss_gs_norb+xyzzyaaao3
if(.not.orbmask(xyzzyaaap3))cycle
flap(xyzzyaaao3)=flap(xyzzyaaao3)+dble(cusp_lap_c(ridx2zidx(xyzzyaaap3&
&)))
fgra1(xyzzyaaao3)=fgra1(xyzzyaaao3)+dble(cusp_grad_c(1,ridx2zidx(xyzzy&
&aaap3)))
fgra2(xyzzyaaao3)=fgra2(xyzzyaaao3)+dble(cusp_grad_c(2,ridx2zidx(xyzzy&
&aaap3)))
fgra3(xyzzyaaao3)=fgra3(xyzzyaaao3)+dble(cusp_grad_c(3,ridx2zidx(xyzzy&
&aaap3)))
enddo
endif
do xyzzyaaao3=1,gauss_ex_norb
xyzzyaaap3=gauss_gs_norb+xyzzyaaao3
if(.not.orbmask(xyzzyaaap3))cycle
orblap(xyzzyaaap3,1)=flap(xyzzyaaao3)
orbgrad(1,xyzzyaaap3,1)=fgra1(xyzzyaaao3)
orbgrad(2,xyzzyaaap3,1)=fgra2(xyzzyaaao3)
orbgrad(3,xyzzyaaap3,1)=fgra3(xyzzyaaao3)
enddo
endif
end subroutine xyzzyaaac1
subroutine xyzzyaaad1(rvec,jspin,norb,orbmask,norbc,corbmask,orbval,or&
&bgrad,orblap,orbsderivs)
implicit none
integer,intent(in) :: jspin,norb,norbc
real(dp),intent(in) :: rvec(3)
real(dp),intent(inout) :: orbval(norb,real1_complex2),orbgrad(3,norb,r&
&eal1_complex2),orblap(norb,real1_complex2),orbsderivs(6,nemax,real1_c&
&omplex2)
logical,intent(in) :: orbmask(norb),corbmask(norbc)
integer xyzzyaaaa4,xyzzyaaab4,xyzzyaaac4,xyzzyaaad4,xyzzyaaae4,xyzzyaa&
&af4,xyzzyaaag4,xyzzyaaah4,xyzzyaaai4,xyzzyaaaj4,xyzzyaaak4,xyzzyaaal4&
&,xyzzyaaam4,xyzzyaaan4,xyzzyaaao4,xyzzyaaap4,xyzzyaaaq4,xyzzyaaar4,xy&
&zzyaaas4,xyzzyaaat4,xyzzyaaau4,xyzzyaaav4,xyzzyaaaw4,xyzzyaaax4(num_a&
&o)
real(dp) xyzzyaaay4,xyzzyaaaz4,xyzzyaaba4,xyzzyaabb4,xyzzyaabc4,xyzzya&
&abd4,xyzzyaabe4,xyzzyaabf4,xyzzyaabg4,xyzzyaabh4,xyzzyaabi4,xyzzyaabj&
&4,xyzzyaabk4,xyzzyaabl4,xyzzyaabm4,xyzzyaabn4,xyzzyaabo4,xyzzyaabp4,x&
&yzzyaabq4,xyzzyaabr4,xyzzyaabs4,xyzzyaabt4,xyzzyaabu4,xyzzyaabv4,xyzz&
&yaabw4,xyzzyaabx4,xyzzyaaby4,xyzzyaabz4,xyzzyaaca4,xyzzyaacb4,xyzzyaa&
&cc4,xyzzyaacd4,xyzzyaace4,xyzzyaacf4(7),xyzzyaacg4(7),xyzzyaach4(21),&
&xyzzyaaci4(42),xyzzyaacj4(7),xyzzyaack4(7),xyzzyaacl4(21),xyzzyaacm4(&
&42),xyzzyaacn4,xyzzyaaco4,xyzzyaacp4,xyzzyaacq4,xyzzyaacr4,xyzzyaacs4&
&,xyzzyaact4,xyzzyaacu4,xyzzyaacv4,xyzzyaacw4,xyzzyaacx4,xyzzyaacy4,xy&
&zzyaacz4,xyzzyaada4,xyzzyaadb4,xyzzyaadc4
real(dp) xyzzyaadd4,xyzzyaade4,xyzzyaadf4,xyzzyaadg4,xyzzyaadh4,xyzzya&
&adi4,xyzzyaadj4,xyzzyaadk4,xyzzyaadl4,xyzzyaadm4,xyzzyaadn4,xyzzyaado&
&4,xyzzyaadp4,xyzzyaadq4,xyzzyaadr4,xyzzyaads4,xyzzyaadt4,xyzzyaadu4,x&
&yzzyaadv4,xyzzyaadw4,xyzzyaadx4,xyzzyaady4,xyzzyaadz4,xyzzyaaea4,xyzz&
&yaaeb4,xyzzyaaec4,xyzzyaaed4,xyzzyaaee4,xyzzyaaef4,xyzzyaaeg4,xyzzyaa&
&eh4,xyzzyaaei4,xyzzyaaej4,xyzzyaaek4,xyzzyaael4,xyzzyaaem4,xyzzyaaen4&
&,xyzzyaaeo4,xyzzyaaep4,xyzzyaaeq4,xyzzyaaer4,xyzzyaaes4,xyzzyaaet4,xy&
&zzyaaeu4,xyzzyaaev4,xyzzyaaew4,xyzzyaaex4,xyzzyaaey4,xyzzyaaez4,xyzzy&
&aafa4,xyzzyaafb4,xyzzyaafc4,xyzzyaafd4,xyzzyaafe4,xyzzyaaff4,xyzzyaaf&
&g4,xyzzyaafh4,xyzzyaafi4,xyzzyaafj4,xyzzyaafk4,xyzzyaafl4,xyzzyaafm4,&
&xyzzyaafn4,xyzzyaafo4,xyzzyaafp4,xyzzyaafq4,xyzzyaafr4,xyzzyaafs4,xyz&
&zyaaft4,xyzzyaafu4,xyzzyaafv4,xyzzyaafw4,xyzzyaafx4,xyzzyaafy4,xyzzya&
&afz4,xyzzyaaga4,xyzzyaagb4,xyzzyaagc4,xyzzyaagd4,xyzzyaage4,xyzzyaagf&
&4,xyzzyaagg4,xyzzyaagh4,xyzzyaagi4,xyzzyaagj4,xyzzyaagk4,xyzzyaagl4,x&
&yzzyaagm4,xyzzyaagn4,xyzzyaago4,xyzzyaagp4,xyzzyaagq4,xyzzyaagr4,xyzz&
&yaags4,xyzzyaagt4,xyzzyaagu4,xyzzyaagv4,xyzzyaagw4,xyzzyaagx4,xyzzyaa&
&gy4,xyzzyaagz4,xyzzyaaha4,xyzzyaahb4,xyzzyaahc4,xyzzyaahd4,xyzzyaahe4&
&,xyzzyaahf4,xyzzyaahg4,xyzzyaahh4,xyzzyaahi4,xyzzyaahj4,xyzzyaahk4,xy&
&zzyaahl4,xyzzyaahm4,xyzzyaahn4,xyzzyaaho4,xyzzyaahp4,xyzzyaahq4,xyzzy&
&aahr4,xyzzyaahs4,xyzzyaaht4,xyzzyaahu4,xyzzyaahv4,xyzzyaahw4
real(dp) xyzzyaahx4,xyzzyaahy4,xyzzyaahz4,xyzzyaaia4,xyzzyaaib4,xyzzya&
&aic4,xyzzyaaid4,xyzzyaaie4,xyzzyaaif4,xyzzyaaig4,xyzzyaaih4,xyzzyaaii&
&4,xyzzyaaij4,xyzzyaaik4,xyzzyaail4,xyzzyaaim4,xyzzyaain4,xyzzyaaio4,x&
&yzzyaaip4,xyzzyaaiq4,xyzzyaair4,xyzzyaais4,xyzzyaait4,xyzzyaaiu4,xyzz&
&yaaiv4,xyzzyaaiw4,xyzzyaaix4,xyzzyaaiy4,xyzzyaaiz4,xyzzyaaja4,xyzzyaa&
&jb4,xyzzyaajc4,xyzzyaajd4,xyzzyaaje4,xyzzyaajf4,xyzzyaajg4,xyzzyaajh4&
&,xyzzyaaji4,xyzzyaajj4,xyzzyaajk4,xyzzyaajl4,xyzzyaajm4,xyzzyaajn4,xy&
&zzyaajo4,xyzzyaajp4,xyzzyaajq4,xyzzyaajr4,xyzzyaajs4
complex(dp) xyzzyaajt4
logical xyzzyaaju4,xyzzyaajv4(num_shells)
xyzzyaaas4=0
rbf=0.d0
rblap=0.d0
rbgra1=0.d0
rbgra2=0.d0
rbgra3=0.d0
rbsderiv1=0.d0
rbsderiv2=0.d0
rbsderiv3=0.d0
rbsderiv4=0.d0
rbsderiv5=0.d0
rbsderiv6=0.d0
xyzzyaajv4=.false.
if(complex_states)then
cbf=czero
cblap=czero
cbgra1=czero
cbgra2=czero
cbgra3=czero
cbsderiv1=czero
cbsderiv2=czero
cbsderiv3=czero
cbsderiv4=czero
cbsderiv5=czero
cbsderiv6=czero
endif
do xyzzyaaaa4=1,num_cell
do xyzzyaaab4=1,num_real_k
phase(xyzzyaaab4)=coskdotg(xyzzyaaab4,xyzzyaaaa4)*coskdotg_shift(xyzzy&
&aaab4)
enddo
do xyzzyaaab4=num_real_k_plus_1,num_k
cphase(xyzzyaaab4)=expikdotg(xyzzyaaab4,xyzzyaaaa4)*expikdotg_shift(xy&
&zzyaaab4)
enddo
do xyzzyaaar4=1,num_centres_in_cell(xyzzyaaaa4)
xyzzyaaaz4=xpos_in_cell(xyzzyaaar4,xyzzyaaaa4)
xyzzyaaba4=ypos_in_cell(xyzzyaaar4,xyzzyaaaa4)
xyzzyaabb4=zpos_in_cell(xyzzyaaar4,xyzzyaaaa4)
xyzzyaaaz4=new_origin_to_rvec(1)-xyzzyaaaz4
xyzzyaaba4=new_origin_to_rvec(2)-xyzzyaaba4
xyzzyaabb4=new_origin_to_rvec(3)-xyzzyaabb4
xyzzyaabc4=xyzzyaaaz4*xyzzyaaaz4
xyzzyaabd4=xyzzyaaba4*xyzzyaaba4
xyzzyaabe4=xyzzyaabb4*xyzzyaabb4
xyzzyaaay4=xyzzyaabc4+xyzzyaabd4+xyzzyaabe4
xyzzyaaav4=num_shells_on_centre(xyzzyaaar4,xyzzyaaaa4)
do xyzzyaaac4=1,xyzzyaaav4
xyzzyaaas4=xyzzyaaas4+1
xyzzyaaaq4=shell_sequence_number(xyzzyaaas4)
xyzzyaaca4=min_exponent(xyzzyaaaq4)
xyzzyaabo4=xyzzyaaca4*xyzzyaaay4
if(xyzzyaabo4>screening_tolerance)cycle
xyzzyaaad4=shell_am(xyzzyaaaq4)
xyzzyaaae4=numao_in_shell(xyzzyaaaq4)
xyzzyaaaf4=xyzzyaaae4*3
xyzzyaaag4=xyzzyaaae4*6
do xyzzyaaaj4=1,xyzzyaaae4
xyzzyaacj4(xyzzyaaaj4)=0.d0
enddo
do xyzzyaaaj4=1,xyzzyaaae4
xyzzyaack4(xyzzyaaaj4)=0.d0
enddo
do xyzzyaaaj4=1,xyzzyaaaf4
xyzzyaacl4(xyzzyaaaj4)=0.d0
enddo
do xyzzyaaaj4=1,xyzzyaaag4
xyzzyaacm4(xyzzyaaaj4)=0.d0
enddo
xyzzyaaao4=primitive(xyzzyaaaq4)
xyzzyaaap4=primitive(xyzzyaaaq4+1)-1
xyzzyaaju4=.false.
do xyzzyaaan4=xyzzyaaao4,xyzzyaaap4
xyzzyaaca4=exponent(xyzzyaaan4)
xyzzyaabo4=xyzzyaaca4*xyzzyaaay4
if(xyzzyaabo4>30.d0)cycle
xyzzyaaju4=.true.
xyzzyaajv4(xyzzyaaaq4)=.true.
xyzzyaacb4=exp(-xyzzyaabo4)
xyzzyaabk4=-xyzzyaaca4-xyzzyaaca4
select case (xyzzyaaad4)
case(1)
xyzzyaacf4(1)=c_prim(xyzzyaaan4)*xyzzyaacb4
xyzzyaacc4=xyzzyaacf4(1)*xyzzyaabk4
xyzzyaach4(1)=xyzzyaaaz4*xyzzyaacc4
xyzzyaach4(2)=xyzzyaaba4*xyzzyaacc4
xyzzyaach4(3)=xyzzyaabb4*xyzzyaacc4
xyzzyaaci4(1)=(1.d0+xyzzyaabk4*xyzzyaabc4)*xyzzyaacc4
xyzzyaaci4(2)=(1.d0+xyzzyaabk4*xyzzyaabd4)*xyzzyaacc4
xyzzyaaci4(3)=(1.d0+xyzzyaabk4*xyzzyaabe4)*xyzzyaacc4
xyzzyaacg4(1)=xyzzyaaci4(1)+xyzzyaaci4(2)+xyzzyaaci4(3)
xyzzyaaci4(4)=xyzzyaabk4*xyzzyaaba4*xyzzyaach4(1)
xyzzyaaci4(5)=xyzzyaabk4*xyzzyaabb4*xyzzyaach4(1)
xyzzyaaci4(6)=xyzzyaabk4*xyzzyaabb4*xyzzyaach4(2)
case(2)
xyzzyaacc4=c_prim(xyzzyaaan4)*xyzzyaacb4
xyzzyaacd4=c_prim2(xyzzyaaan4)*xyzzyaacb4
xyzzyaacf4(1)=xyzzyaacc4
xyzzyaacf4(2)=xyzzyaacd4*xyzzyaaaz4
xyzzyaacf4(3)=xyzzyaacd4*xyzzyaaba4
xyzzyaacf4(4)=xyzzyaacd4*xyzzyaabb4
xyzzyaach4(1)=xyzzyaabk4*xyzzyaaaz4
xyzzyaach4(2)=xyzzyaabk4*xyzzyaaba4
xyzzyaach4(3)=xyzzyaabk4*xyzzyaabb4
xyzzyaach4(4)=1.d0+xyzzyaach4(1)*xyzzyaaaz4
xyzzyaach4(5)=xyzzyaach4(1)*xyzzyaaba4
xyzzyaach4(6)=xyzzyaach4(1)*xyzzyaabb4
xyzzyaach4(8)=1.d0+xyzzyaach4(2)*xyzzyaaba4
xyzzyaach4(9)=xyzzyaach4(2)*xyzzyaabb4
xyzzyaach4(7)=xyzzyaach4(5)
xyzzyaach4(10)=xyzzyaach4(6)
xyzzyaach4(11)=xyzzyaach4(9)
xyzzyaach4(12)=1.d0+xyzzyaach4(3)*xyzzyaabb4
xyzzyaaci4(1)=xyzzyaabk4*xyzzyaach4(4)
xyzzyaaci4(2)=xyzzyaabk4*xyzzyaach4(8)
xyzzyaaci4(3)=xyzzyaabk4*xyzzyaach4(12)
xyzzyaaci4(4)=xyzzyaach4(1)*xyzzyaach4(2)
xyzzyaaci4(5)=xyzzyaach4(1)*xyzzyaach4(3)
xyzzyaaci4(6)=xyzzyaach4(2)*xyzzyaach4(3)
xyzzyaaci4(7)=xyzzyaach4(1)*(xyzzyaach4(4)+2.d0)
xyzzyaaci4(10)=xyzzyaach4(2)*xyzzyaach4(4)
xyzzyaaci4(13)=xyzzyaaci4(10)
xyzzyaaci4(11)=xyzzyaach4(3)*xyzzyaach4(4)
xyzzyaaci4(19)=xyzzyaaci4(11)
xyzzyaaci4(8)=xyzzyaach4(1)*xyzzyaach4(8)
xyzzyaaci4(16)=xyzzyaaci4(8)
xyzzyaaci4(14)=xyzzyaach4(2)*(xyzzyaach4(8)+2.d0)
xyzzyaaci4(18)=xyzzyaach4(3)*xyzzyaach4(8)
xyzzyaaci4(20)=xyzzyaaci4(18)
xyzzyaaci4(9)=xyzzyaach4(1)*xyzzyaach4(12)
xyzzyaaci4(23)=xyzzyaaci4(9)
xyzzyaaci4(15)=xyzzyaach4(2)*xyzzyaach4(12)
xyzzyaaci4(24)=xyzzyaaci4(15)
xyzzyaaci4(21)=xyzzyaach4(3)*(xyzzyaach4(12)+2.d0)
xyzzyaaci4(12)=xyzzyaach4(1)*xyzzyaach4(9)
xyzzyaaci4(17)=xyzzyaaci4(12)
xyzzyaaci4(22)=xyzzyaaci4(12)
xyzzyaach4(1:3)=xyzzyaach4(1:3)*xyzzyaacc4
xyzzyaach4(4:12)=xyzzyaach4(4:12)*xyzzyaacd4
xyzzyaaci4(1:6)=xyzzyaaci4(1:6)*xyzzyaacc4
xyzzyaaci4(7:24)=xyzzyaaci4(7:24)*xyzzyaacd4
xyzzyaacg4(1)=xyzzyaaci4(1)+xyzzyaaci4(2)+xyzzyaaci4(3)
xyzzyaacg4(2)=xyzzyaaci4(7)+xyzzyaaci4(8)+xyzzyaaci4(9)
xyzzyaacg4(3)=xyzzyaaci4(13)+xyzzyaaci4(14)+xyzzyaaci4(15)
xyzzyaacg4(4)=xyzzyaaci4(19)+xyzzyaaci4(20)+xyzzyaaci4(21)
case(3)
xyzzyaacd4=c_prim(xyzzyaaan4)*xyzzyaacb4
xyzzyaacf4(1)=xyzzyaacd4*xyzzyaaaz4
xyzzyaacf4(2)=xyzzyaacd4*xyzzyaaba4
xyzzyaacf4(3)=xyzzyaacd4*xyzzyaabb4
xyzzyaabl4=xyzzyaabk4*xyzzyaaaz4
xyzzyaabm4=xyzzyaabk4*xyzzyaaba4
xyzzyaabn4=xyzzyaabk4*xyzzyaabb4
xyzzyaach4(1)=1.d0+xyzzyaabl4*xyzzyaaaz4
xyzzyaach4(2)=xyzzyaabl4*xyzzyaaba4
xyzzyaach4(3)=xyzzyaabl4*xyzzyaabb4
xyzzyaach4(5)=1.d0+xyzzyaabm4*xyzzyaaba4
xyzzyaach4(6)=xyzzyaabm4*xyzzyaabb4
xyzzyaach4(9)=1.d0+xyzzyaabn4*xyzzyaabb4
xyzzyaach4(4)=xyzzyaach4(2)
xyzzyaach4(7)=xyzzyaach4(3)
xyzzyaach4(8)=xyzzyaach4(6)
xyzzyaaci4(1)=xyzzyaabl4*(xyzzyaach4(1)+2.d0)
xyzzyaaci4(4)=xyzzyaabm4*xyzzyaach4(1)
xyzzyaaci4(7)=xyzzyaaci4(4)
xyzzyaaci4(5)=xyzzyaabn4*xyzzyaach4(1)
xyzzyaaci4(13)=xyzzyaaci4(5)
xyzzyaaci4(2)=xyzzyaabl4*xyzzyaach4(5)
xyzzyaaci4(10)=xyzzyaaci4(2)
xyzzyaaci4(8)=xyzzyaabm4*(xyzzyaach4(5)+2.d0)
xyzzyaaci4(12)=xyzzyaabn4*xyzzyaach4(5)
xyzzyaaci4(14)=xyzzyaaci4(12)
xyzzyaaci4(3)=xyzzyaabl4*xyzzyaach4(9)
xyzzyaaci4(17)=xyzzyaaci4(3)
xyzzyaaci4(9)=xyzzyaabm4*xyzzyaach4(9)
xyzzyaaci4(18)=xyzzyaaci4(9)
xyzzyaaci4(15)=xyzzyaabn4*(xyzzyaach4(9)+2.d0)
xyzzyaaci4(6)=xyzzyaabl4*xyzzyaach4(6)
xyzzyaaci4(11)=xyzzyaaci4(6)
xyzzyaaci4(16)=xyzzyaaci4(6)
xyzzyaach4(1:9)=xyzzyaach4(1:9)*xyzzyaacd4
xyzzyaaci4(1:18)=xyzzyaaci4(1:18)*xyzzyaacd4
xyzzyaacg4(1)=xyzzyaaci4(1)+xyzzyaaci4(2)+xyzzyaaci4(3)
xyzzyaacg4(2)=xyzzyaaci4(7)+xyzzyaaci4(8)+xyzzyaaci4(9)
xyzzyaacg4(3)=xyzzyaaci4(13)+xyzzyaaci4(14)+xyzzyaaci4(15)
case(4)
xyzzyaabf4=xyzzyaaaz4*xyzzyaaba4
xyzzyaabg4=xyzzyaaba4*xyzzyaabb4
xyzzyaabh4=xyzzyaaaz4*xyzzyaabb4
xyzzyaabj4=xyzzyaabc4-xyzzyaabd4
xyzzyaabi4=3.d0*xyzzyaabe4-xyzzyaaay4
xyzzyaacf4(1)=xyzzyaabi4
xyzzyaacf4(2)=xyzzyaabh4
xyzzyaacf4(3)=xyzzyaabg4
xyzzyaacf4(4)=xyzzyaabj4
xyzzyaacf4(5)=xyzzyaabf4
xyzzyaace4=c_prim(xyzzyaaan4)*xyzzyaacb4
xyzzyaacf4(1:5)=xyzzyaacf4(1:5)*xyzzyaace4
xyzzyaabz4=7.d0+xyzzyaabk4*xyzzyaaay4
xyzzyaabz4=xyzzyaabk4*xyzzyaabz4
xyzzyaacg4(1:5)=xyzzyaacf4(1:5)*xyzzyaabz4
xyzzyaabl4=xyzzyaabk4*xyzzyaaaz4
xyzzyaacn4=xyzzyaabl4*xyzzyaaba4
xyzzyaabm4=xyzzyaabk4*xyzzyaaba4
xyzzyaaco4=xyzzyaabl4*xyzzyaabb4
xyzzyaabn4=xyzzyaabk4*xyzzyaabb4
xyzzyaacp4=xyzzyaabm4*xyzzyaabb4
xyzzyaabo4=1.d0+xyzzyaabl4*xyzzyaaaz4
xyzzyaabv4=xyzzyaabo4+2.d0
xyzzyaabp4=1.d0+xyzzyaabm4*xyzzyaaba4
xyzzyaabw4=xyzzyaabp4+2.d0
xyzzyaabq4=1.d0+xyzzyaabn4*xyzzyaabb4
xyzzyaabx4=xyzzyaabq4+2.d0
xyzzyaabr4=xyzzyaabk4*xyzzyaabi4-2.d0
xyzzyaabs4=xyzzyaabk4*xyzzyaabj4
xyzzyaach4(1)=xyzzyaabr4*xyzzyaaaz4
xyzzyaach4(2)=xyzzyaabr4*xyzzyaaba4
xyzzyaach4(3)=(xyzzyaabr4+6.d0)*xyzzyaabb4
xyzzyaach4(4)=xyzzyaabo4*xyzzyaabb4
xyzzyaach4(5)=xyzzyaabl4*xyzzyaabg4
xyzzyaach4(6)=xyzzyaabq4*xyzzyaaaz4
xyzzyaach4(7)=xyzzyaach4(5)
xyzzyaach4(8)=xyzzyaabp4*xyzzyaabb4
xyzzyaach4(9)=xyzzyaabq4*xyzzyaaba4
xyzzyaach4(10)=(2.d0+xyzzyaabk4*xyzzyaabj4)*xyzzyaaaz4
xyzzyaach4(11)=(xyzzyaabs4-2.d0)*xyzzyaaba4
xyzzyaach4(12)=xyzzyaabs4*xyzzyaabb4
xyzzyaach4(13)=xyzzyaabo4*xyzzyaaba4
xyzzyaach4(14)=xyzzyaabp4*xyzzyaaaz4
xyzzyaach4(15)=xyzzyaach4(5)
xyzzyaach4(1:15)=xyzzyaach4(1:15)*xyzzyaace4
xyzzyaabu4=xyzzyaabc4+xyzzyaabd4-2.d0*xyzzyaabe4
xyzzyaaci4(1)=-xyzzyaabl4*xyzzyaabl4*xyzzyaabu4-xyzzyaabk4*(xyzzyaabu4&
&+4.d0*xyzzyaabc4)-2.d0
xyzzyaaci4(2)=-xyzzyaabm4*xyzzyaabm4*xyzzyaabu4-xyzzyaabk4*(xyzzyaabu4&
&+4.d0*xyzzyaabd4)-2.d0
xyzzyaaci4(3)=-xyzzyaabn4*xyzzyaabn4*xyzzyaabu4-xyzzyaabk4*(xyzzyaabu4&
&-8.d0*xyzzyaabe4)+4.d0
xyzzyaaby4=2.d0*(1.d0+xyzzyaaca4*xyzzyaabu4)
xyzzyaaci4(4)=xyzzyaacn4*(xyzzyaaby4-6.d0)
xyzzyaaci4(5)=xyzzyaaco4*xyzzyaaby4
xyzzyaaci4(6)=xyzzyaacp4*xyzzyaaby4
xyzzyaaci4(7)=xyzzyaaco4*xyzzyaabv4
xyzzyaaci4(8)=xyzzyaaco4*xyzzyaabp4
xyzzyaaci4(9)=xyzzyaaco4*xyzzyaabx4
xyzzyaaci4(10)=xyzzyaacp4*xyzzyaabo4
xyzzyaaci4(11)=(-xyzzyaabo4)*(-xyzzyaabq4)
xyzzyaaci4(12)=xyzzyaacn4*xyzzyaabq4
xyzzyaaci4(13)=xyzzyaaci4(10)
xyzzyaaci4(14)=xyzzyaacp4*xyzzyaabw4
xyzzyaaci4(15)=xyzzyaacp4*xyzzyaabx4
xyzzyaaci4(16)=xyzzyaaci4(8)
xyzzyaaci4(17)=xyzzyaacn4*xyzzyaabq4
xyzzyaaci4(18)=(-xyzzyaabp4)*(-xyzzyaabq4)
xyzzyaaci4(19)=2.d0+xyzzyaabk4*(xyzzyaabo4*xyzzyaabj4+4.d0*xyzzyaabc4)
xyzzyaaci4(20)=xyzzyaabk4*(xyzzyaabp4*xyzzyaabj4-4.d0*xyzzyaabd4)-2.d0
xyzzyaaci4(21)=xyzzyaabk4*xyzzyaabj4*xyzzyaabq4
xyzzyaaci4(22)=xyzzyaabk4*xyzzyaabk4*xyzzyaabf4*xyzzyaabj4
xyzzyaaci4(23)=-2.d0*xyzzyaaco4*(xyzzyaaca4*xyzzyaabj4-1.d0)
xyzzyaaci4(24)=-2.d0*xyzzyaacp4*(xyzzyaaca4*xyzzyaabj4+1.d0)
xyzzyaaci4(25)=xyzzyaacn4*xyzzyaabv4
xyzzyaaci4(26)=xyzzyaacn4*xyzzyaabw4
xyzzyaaci4(27)=xyzzyaaci4(12)
xyzzyaaci4(28)=(-xyzzyaabo4)*(-xyzzyaabp4)
xyzzyaaci4(29)=xyzzyaaci4(10)
xyzzyaaci4(30)=xyzzyaaci4(8)
xyzzyaaci4(1:30)=xyzzyaaci4(1:30)*xyzzyaace4
case(5)
xyzzyaace4=c_prim(xyzzyaaan4)*xyzzyaacb4
xyzzyaacq4=xyzzyaabc4*xyzzyaaaz4
xyzzyaacr4=xyzzyaabd4*xyzzyaaba4
xyzzyaacs4=xyzzyaabc4*xyzzyaabc4
xyzzyaact4=xyzzyaabd4*xyzzyaabd4
xyzzyaacu4=xyzzyaabe4*xyzzyaabe4
xyzzyaacv4=xyzzyaabc4*xyzzyaaba4
xyzzyaacw4=xyzzyaabc4*xyzzyaabb4
xyzzyaacx4=xyzzyaaaz4*xyzzyaabd4
xyzzyaacy4=xyzzyaabd4*xyzzyaabb4
xyzzyaacz4=xyzzyaabf4*xyzzyaabb4
xyzzyaaiz4=xyzzyaabc4*xyzzyaabd4
xyzzyaaja4=xyzzyaabc4*xyzzyaabe4
xyzzyaajb4=xyzzyaabd4*xyzzyaabe4
xyzzyaada4=xyzzyaaca4*xyzzyaabc4
xyzzyaadb4=xyzzyaaca4*xyzzyaabd4
xyzzyaadc4=xyzzyaaca4*xyzzyaabe4
xyzzyaajc4=xyzzyaaca4*xyzzyaaca4
xyzzyaajd4=xyzzyaaca4*xyzzyaace4
xyzzyaaje4=xyzzyaaaz4*xyzzyaace4
xyzzyaajf4=xyzzyaaba4*xyzzyaace4
xyzzyaajg4=xyzzyaabb4*xyzzyaace4
xyzzyaajh4=3.d0*xyzzyaabc4
xyzzyaaji4=3.d0*xyzzyaabd4
xyzzyaajj4=-2.d0*xyzzyaabe4
xyzzyaabo4=xyzzyaajh4+xyzzyaaji4+xyzzyaajj4
xyzzyaabp4=xyzzyaaca4*xyzzyaabo4
xyzzyaabq4=-3.d0+xyzzyaabp4
xyzzyaabr4=3.d0*xyzzyaadc4
xyzzyaabs4=-1.5d0+xyzzyaabr4
xyzzyaabt4=-12.d0*xyzzyaabe4
xyzzyaabu4=xyzzyaabt4+xyzzyaajh4+xyzzyaaji4
xyzzyaabv4=xyzzyaaca4*xyzzyaabu4
xyzzyaabw4=-3.d0+xyzzyaabv4
xyzzyaadd4=xyzzyaabf4*xyzzyaabw4*xyzzyaace4
xyzzyaade4=3.d0*xyzzyaadb4
xyzzyaajk4=6.d0*xyzzyaabe4
xyzzyaadf4=-12.d0*xyzzyaadc4
xyzzyaadg4=12.d0+xyzzyaabv4
xyzzyaadh4=-30.d0*xyzzyaada4
xyzzyaadi4=30.d0*xyzzyaadb4
xyzzyaadj4=90.d0*xyzzyaadb4
xyzzyaadk4=-45.d0*xyzzyaabd4
xyzzyaajl4=-6.d0*xyzzyaabc4
xyzzyaajm4=-6.d0*xyzzyaabd4
xyzzyaadl4=xyzzyaajl4+xyzzyaajm4+4.d0*xyzzyaabe4
xyzzyaadm4=-6.d0*xyzzyaadc4
xyzzyaadn4=3.d0+xyzzyaadm4
xyzzyaajn4=4.d0*xyzzyaacu4
xyzzyaajo4=15.d0*xyzzyaabc4
xyzzyaado4=xyzzyaajo4+xyzzyaaji4+xyzzyaajj4
xyzzyaadp4=xyzzyaaca4*xyzzyaado4
xyzzyaadq4=xyzzyaajc4*xyzzyaadl4*xyzzyaabc4
xyzzyaadr4=-3.d0+xyzzyaadp4+xyzzyaadq4
xyzzyaads4=xyzzyaadr4*xyzzyaajg4
xyzzyaajp4=15.d0*xyzzyaabd4
xyzzyaadt4=xyzzyaajp4+xyzzyaajh4+xyzzyaajj4
xyzzyaadu4=xyzzyaaca4*xyzzyaadt4
xyzzyaadv4=xyzzyaajc4*xyzzyaadl4*xyzzyaabd4
xyzzyaadw4=-3.d0+xyzzyaadu4+xyzzyaadv4
xyzzyaadx4=xyzzyaadw4*xyzzyaajg4
xyzzyaajq4=9.d0*xyzzyaabc4
xyzzyaahx4=9.d0*xyzzyaabd4
xyzzyaahy4=-14.d0*xyzzyaabe4
xyzzyaady4=xyzzyaajq4+xyzzyaahx4+xyzzyaahy4
xyzzyaadz4=xyzzyaaca4*xyzzyaady4
xyzzyaaea4=xyzzyaajc4*xyzzyaadl4*xyzzyaabe4
xyzzyaaeb4=6.d0+xyzzyaadz4+xyzzyaaea4
xyzzyaaec4=xyzzyaaeb4*xyzzyaajg4
xyzzyaahz4=24.d0*xyzzyaabe4
xyzzyaaed4=xyzzyaajl4+xyzzyaajm4+xyzzyaahz4
xyzzyaaee4=xyzzyaajc4*xyzzyaaed4*xyzzyaabc4
xyzzyaaia4=21.d0*xyzzyaabc4
xyzzyaaib4=-36.d0*xyzzyaabe4
xyzzyaaef4=xyzzyaahx4+xyzzyaaia4+xyzzyaaib4
xyzzyaaeg4=xyzzyaaca4*xyzzyaaef4
xyzzyaaeh4=-9.d0+xyzzyaaeg4+xyzzyaaee4
xyzzyaaei4=xyzzyaaeh4*xyzzyaaje4
xyzzyaaej4=xyzzyaabt4+xyzzyaajp4+xyzzyaajh4
xyzzyaaek4=xyzzyaaca4*xyzzyaaej4
xyzzyaael4=xyzzyaajc4*xyzzyaaed4*xyzzyaabd4
xyzzyaaem4=-3.d0+xyzzyaaek4+xyzzyaael4
xyzzyaaen4=xyzzyaaem4*xyzzyaaje4
xyzzyaaic4=-60.d0*xyzzyaabe4
xyzzyaaeo4=xyzzyaaic4+xyzzyaajh4+xyzzyaaji4
xyzzyaaep4=xyzzyaaca4*xyzzyaaeo4
xyzzyaaeq4=xyzzyaajc4*xyzzyaaed4*xyzzyaabe4
xyzzyaaer4=12.d0+xyzzyaaep4+xyzzyaaeq4
xyzzyaaes4=xyzzyaaer4*xyzzyaaje4
xyzzyaaet4=xyzzyaabt4+xyzzyaajo4+xyzzyaaji4
xyzzyaaeu4=xyzzyaaca4*xyzzyaaet4
xyzzyaaev4=-3.d0+xyzzyaaee4+xyzzyaaeu4
xyzzyaaew4=xyzzyaaev4*xyzzyaajf4
xyzzyaaex4=xyzzyaaca4*xyzzyaaed4
xyzzyaaey4=-18.d0+xyzzyaaex4
xyzzyaaez4=xyzzyaacz4*xyzzyaaey4*xyzzyaajd4
xyzzyaaid4=21.d0*xyzzyaabd4
xyzzyaafa4=xyzzyaajq4+xyzzyaaib4+xyzzyaaid4
xyzzyaafb4=xyzzyaaca4*xyzzyaafa4
xyzzyaafc4=-9.d0+xyzzyaael4+xyzzyaafb4
xyzzyaafd4=xyzzyaafc4*xyzzyaajf4
xyzzyaafe4=xyzzyaaer4*xyzzyaajf4
xyzzyaaie4=30.d0*xyzzyaabd4
xyzzyaaif4=-30.d0*xyzzyaabc4
xyzzyaaff4=-60.d0*xyzzyaadc4
xyzzyaajr4=60.d0*xyzzyaabc4
xyzzyaajs4=-60.d0*xyzzyaabd4
xyzzyaafg4=xyzzyaajr4+xyzzyaajs4
xyzzyaafh4=xyzzyaajc4*xyzzyaafg4*xyzzyaabe4
xyzzyaaig4=-150.d0*xyzzyaabc4
xyzzyaafi4=xyzzyaaie4+xyzzyaaig4
xyzzyaafj4=xyzzyaaca4*xyzzyaafi4
xyzzyaaih4=60.d0*xyzzyaacs4
xyzzyaafk4=-60.d0*xyzzyaaiz4
xyzzyaafl4=xyzzyaaih4+xyzzyaafk4
xyzzyaafm4=xyzzyaajc4*xyzzyaafl4
xyzzyaafn4=30.d0+xyzzyaafj4+xyzzyaafm4
xyzzyaafo4=xyzzyaafn4*xyzzyaajg4
xyzzyaaii4=150.d0*xyzzyaabd4
xyzzyaafp4=xyzzyaaif4+xyzzyaaii4
xyzzyaafq4=xyzzyaaca4*xyzzyaafp4
xyzzyaafr4=60.d0*xyzzyaaiz4
xyzzyaaij4=-60.d0*xyzzyaact4
xyzzyaafs4=xyzzyaafr4+xyzzyaaij4
xyzzyaaft4=xyzzyaajc4*xyzzyaafs4
xyzzyaafu4=-30.d0+xyzzyaafq4+xyzzyaaft4
xyzzyaafv4=xyzzyaafu4*xyzzyaajg4
xyzzyaafw4=90.d0+xyzzyaaff4
xyzzyaafx4=xyzzyaafw4*xyzzyaabd4
xyzzyaafy4=-90.d0-xyzzyaaff4
xyzzyaafz4=xyzzyaafy4*xyzzyaabc4
xyzzyaaga4=xyzzyaafx4+xyzzyaafz4
xyzzyaagb4=xyzzyaabb4*xyzzyaaga4*xyzzyaajd4
xyzzyaaik4=-60.d0*xyzzyaada4
xyzzyaail4=-60.d0*xyzzyaadb4
xyzzyaaim4=120.d0*xyzzyaada4
xyzzyaagc4=-180.d0+xyzzyaaim4
xyzzyaagd4=xyzzyaacz4*xyzzyaagc4*xyzzyaajd4
xyzzyaain4=120.d0*xyzzyaadb4
xyzzyaage4=-180.d0+xyzzyaain4
xyzzyaagf4=xyzzyaacz4*xyzzyaage4*xyzzyaajd4
xyzzyaaio4=120.d0*xyzzyaadc4
xyzzyaagg4=-180.d0+xyzzyaaio4
xyzzyaagh4=xyzzyaacz4*xyzzyaagg4*xyzzyaajd4
xyzzyaaip4=90.d0*xyzzyaabd4
xyzzyaagi4=-180.d0*xyzzyaaiz4
xyzzyaagj4=xyzzyaaih4+xyzzyaagi4
xyzzyaagk4=xyzzyaajc4*xyzzyaagj4
xyzzyaagl4=-180.d0*xyzzyaadb4
xyzzyaaiq4=-210.d0*xyzzyaabc4
xyzzyaair4=270.d0*xyzzyaabd4
xyzzyaagm4=xyzzyaaiq4+xyzzyaair4
xyzzyaagn4=xyzzyaaca4*xyzzyaagm4
xyzzyaago4=90.d0+xyzzyaagn4+xyzzyaagk4
xyzzyaagp4=xyzzyaago4*xyzzyaaje4
xyzzyaais4=450.d0*xyzzyaabd4
xyzzyaagq4=xyzzyaaif4+xyzzyaais4
xyzzyaagr4=xyzzyaaca4*xyzzyaagq4
xyzzyaait4=-180.d0*xyzzyaact4
xyzzyaags4=xyzzyaafr4+xyzzyaait4
xyzzyaagt4=xyzzyaajc4*xyzzyaags4
xyzzyaagu4=-90.d0+xyzzyaagr4+xyzzyaagt4
xyzzyaagv4=xyzzyaagu4*xyzzyaaje4
xyzzyaagw4=-180.d0*xyzzyaadc4
xyzzyaagx4=90.d0+xyzzyaagw4
xyzzyaagy4=xyzzyaagx4*xyzzyaabd4
xyzzyaagz4=-30.d0-xyzzyaaff4
xyzzyaaha4=xyzzyaagz4*xyzzyaabc4
xyzzyaahb4=xyzzyaagy4+xyzzyaaha4
xyzzyaahc4=xyzzyaaaz4*xyzzyaahb4*xyzzyaajd4
xyzzyaahd4=30.d0+xyzzyaaff4
xyzzyaaiu4=-90.d0*xyzzyaabc4
xyzzyaahe4=180.d0*xyzzyaaiz4
xyzzyaahf4=xyzzyaaij4+xyzzyaahe4
xyzzyaahg4=xyzzyaajc4*xyzzyaahf4
xyzzyaaiv4=-450.d0*xyzzyaabc4
xyzzyaahh4=xyzzyaaie4+xyzzyaaiv4
xyzzyaahi4=xyzzyaaca4*xyzzyaahh4
xyzzyaaiw4=180.d0*xyzzyaacs4
xyzzyaahj4=xyzzyaafk4+xyzzyaaiw4
xyzzyaahk4=xyzzyaajc4*xyzzyaahj4
xyzzyaahl4=90.d0+xyzzyaahi4+xyzzyaahk4
xyzzyaahm4=xyzzyaahl4*xyzzyaajf4
xyzzyaaix4=-270.d0*xyzzyaabc4
xyzzyaaiy4=210.d0*xyzzyaabd4
xyzzyaahn4=xyzzyaaix4+xyzzyaaiy4
xyzzyaaho4=xyzzyaaca4*xyzzyaahn4
xyzzyaahp4=-9.d1+xyzzyaaho4+xyzzyaahg4
xyzzyaahq4=xyzzyaahp4*xyzzyaajf4
xyzzyaahr4=xyzzyaahd4*xyzzyaabd4
xyzzyaahs4=180.d0*xyzzyaadc4
xyzzyaaht4=-90.d0+xyzzyaahs4
xyzzyaahu4=xyzzyaaht4*xyzzyaabc4
xyzzyaahv4=xyzzyaahr4+xyzzyaahu4
xyzzyaahw4=xyzzyaaba4*xyzzyaahv4*xyzzyaajd4
xyzzyaacf4(1)=xyzzyaabe4*xyzzyaabb4-1.5d0*(xyzzyaacw4+xyzzyaacy4)
xyzzyaacf4(2)=6.d0*xyzzyaaaz4*xyzzyaabe4-1.5d0*(xyzzyaacx4+xyzzyaacq4)
xyzzyaacf4(3)=6.d0*xyzzyaaba4*xyzzyaabe4-1.5d0*(xyzzyaacv4+xyzzyaacr4)
xyzzyaacf4(4)=15.d0*(xyzzyaacw4-xyzzyaacy4)
xyzzyaacf4(5)=30.d0*xyzzyaacz4
xyzzyaacf4(6)=-45.d0*xyzzyaacx4+15.d0*xyzzyaacq4
xyzzyaacf4(7)=45.d0*xyzzyaacv4-15.d0*xyzzyaacr4
xyzzyaacf4(1:7)=xyzzyaacf4(1:7)*xyzzyaace4
xyzzyaach4(1)=xyzzyaabh4*xyzzyaace4*xyzzyaabq4
xyzzyaach4(2)=xyzzyaabg4*xyzzyaace4*xyzzyaabq4
xyzzyaach4(3)=xyzzyaace4*(3.d0*xyzzyaabe4-2.d0*xyzzyaaca4*xyzzyaacu4+x&
&yzzyaabs4*(xyzzyaabc4+xyzzyaabd4))
xyzzyaach4(4)=xyzzyaace4*((-4.5d0+xyzzyaade4+xyzzyaadf4)*xyzzyaabc4-1.&
&5d0*xyzzyaabd4+3.d0*xyzzyaaca4*xyzzyaacs4+xyzzyaajk4)
xyzzyaach4(5)=xyzzyaadd4
xyzzyaach4(6)=xyzzyaabh4*xyzzyaadg4*xyzzyaace4
xyzzyaach4(7)=xyzzyaadd4
xyzzyaach4(8)=xyzzyaace4*(3.d0*xyzzyaaca4*xyzzyaact4+(-1.5d0+xyzzyaade&
&4)*xyzzyaabc4+(-4.5d0+xyzzyaadf4)*xyzzyaabd4+xyzzyaajk4)
xyzzyaach4(9)=xyzzyaabg4*xyzzyaadg4*xyzzyaace4
xyzzyaach4(10)=xyzzyaabh4*(30.d0+xyzzyaadh4+xyzzyaadi4)*xyzzyaace4
xyzzyaach4(11)=xyzzyaabg4*(-30.d0+xyzzyaadh4+xyzzyaadi4)*xyzzyaace4
xyzzyaach4(12)=(xyzzyaabc4*(15.d0-30.d0*xyzzyaadc4)+xyzzyaabd4*(-15.d0&
&+30.d0*xyzzyaadc4))*xyzzyaace4
xyzzyaach4(13)=xyzzyaabg4*(30.d0+xyzzyaaik4)*xyzzyaace4
xyzzyaach4(14)=xyzzyaabh4*(30.d0+xyzzyaail4)*xyzzyaace4
xyzzyaach4(15)=xyzzyaabf4*xyzzyaahd4*xyzzyaace4
xyzzyaach4(16)=xyzzyaace4*(xyzzyaadk4+(45.d0+xyzzyaadj4)*xyzzyaabc4-30&
&.d0*xyzzyaaca4*xyzzyaacs4)
xyzzyaach4(17)=xyzzyaabf4*(-90.d0+xyzzyaadh4+xyzzyaadj4)*xyzzyaace4
xyzzyaach4(18)=xyzzyaaca4*xyzzyaabh4*(xyzzyaaif4+xyzzyaaip4)*xyzzyaace&
&4
xyzzyaach4(19)=xyzzyaabf4*(90.d0+xyzzyaadi4-90.d0*xyzzyaada4)*xyzzyaac&
&e4
xyzzyaach4(20)=(30.d0*xyzzyaaca4*xyzzyaact4+xyzzyaadk4+xyzzyaabc4*(45.&
&d0-90.d0*xyzzyaadb4))*xyzzyaace4
xyzzyaach4(21)=xyzzyaabg4*(xyzzyaaiu4+xyzzyaaie4)*xyzzyaajd4
xyzzyaaci4(1)=xyzzyaads4
xyzzyaaci4(2)=xyzzyaadx4
xyzzyaaci4(3)=xyzzyaaec4
xyzzyaaci4(4)=(12.d0+xyzzyaaca4*xyzzyaadl4)*xyzzyaacz4*xyzzyaajd4
xyzzyaaci4(5)=xyzzyaace4*(xyzzyaaca4*xyzzyaadn4*xyzzyaacq4+xyzzyaaaz4*&
&(-3.d0+xyzzyaajc4*(xyzzyaajn4-6.d0*xyzzyaajb4)+xyzzyaaca4*xyzzyaaji4)&
&)
xyzzyaaci4(6)=xyzzyaace4*(xyzzyaaca4*xyzzyaadn4*xyzzyaacr4+xyzzyaaba4*&
&(-3.d0+xyzzyaajc4*(xyzzyaajn4-6.d0*xyzzyaaja4)+xyzzyaaca4*xyzzyaajh4)&
&)
xyzzyaaci4(7)=xyzzyaaei4
xyzzyaaci4(8)=xyzzyaaen4
xyzzyaaci4(9)=xyzzyaaes4
xyzzyaaci4(10)=xyzzyaaew4
xyzzyaaci4(11)=xyzzyaajg4*(12.d0+xyzzyaaee4+xyzzyaaca4*(xyzzyaabt4-15.&
&d0*xyzzyaabc4+xyzzyaaji4))
xyzzyaaci4(12)=xyzzyaaez4
xyzzyaaci4(13)=xyzzyaaew4
xyzzyaaci4(14)=xyzzyaafd4
xyzzyaaci4(15)=xyzzyaafe4
xyzzyaaci4(16)=xyzzyaaen4
xyzzyaaci4(17)=xyzzyaaez4
xyzzyaaci4(18)=xyzzyaajg4*(12.d0+xyzzyaael4+xyzzyaaca4*(xyzzyaabt4-15.&
&d0*xyzzyaabd4+xyzzyaajh4))
xyzzyaaci4(19)=xyzzyaafo4
xyzzyaaci4(20)=xyzzyaafv4
xyzzyaaci4(21)=xyzzyaagb4
xyzzyaaci4(22)=60.d0*xyzzyaacz4*xyzzyaajc4*(xyzzyaabc4-xyzzyaabd4)*xyz&
&zyaace4
xyzzyaaci4(23)=(30.d0+xyzzyaaca4*(xyzzyaaif4+xyzzyaaie4+xyzzyaaic4)+xy&
&zzyaafh4)*xyzzyaaje4
xyzzyaaci4(24)=(-30.d0+xyzzyaafh4+xyzzyaaca4*(xyzzyaaif4+xyzzyaaie4+60&
&.d0*xyzzyaabe4))*xyzzyaajf4
xyzzyaaci4(25)=xyzzyaagd4
xyzzyaaci4(26)=xyzzyaagf4
xyzzyaaci4(27)=xyzzyaagh4
xyzzyaaci4(28)=(30.d0+xyzzyaaik4+xyzzyaail4+120.d0*xyzzyaajc4*xyzzyaai&
&z4)*xyzzyaajg4
xyzzyaaci4(29)=(30.d0+xyzzyaaik4+xyzzyaaff4+120.d0*xyzzyaajc4*xyzzyaaj&
&a4)*xyzzyaajf4
xyzzyaaci4(30)=(30.d0+xyzzyaail4+xyzzyaaff4+120.d0*xyzzyaajc4*xyzzyaaj&
&b4)*xyzzyaaje4
xyzzyaaci4(31)=xyzzyaagp4
xyzzyaaci4(32)=xyzzyaagv4
xyzzyaaci4(33)=xyzzyaahc4
xyzzyaaci4(34)=(-90.d0+xyzzyaagk4+xyzzyaaca4*(xyzzyaaip4+90.d0*xyzzyaa&
&bc4))*xyzzyaajf4
xyzzyaaci4(35)=(xyzzyaaip4+(-90.d0+xyzzyaagl4)*xyzzyaabc4+60.d0*xyzzya&
&aca4*xyzzyaacs4)*xyzzyaabb4*xyzzyaajd4
xyzzyaaci4(36)=(180.d0+xyzzyaagl4+60.d0*xyzzyaada4)*xyzzyaacz4*xyzzyaa&
&jd4
xyzzyaaci4(37)=xyzzyaahm4
xyzzyaaci4(38)=xyzzyaahq4
xyzzyaaci4(39)=xyzzyaahw4
xyzzyaaci4(40)=(90.d0+xyzzyaahg4+xyzzyaaca4*(xyzzyaaiu4-90.d0*xyzzyaab&
&d4))*xyzzyaaje4
xyzzyaaci4(41)=(xyzzyaail4+180.d0*(xyzzyaada4-1.d0))*xyzzyaacz4*xyzzya&
&ajd4
xyzzyaaci4(42)=(-60.d0*xyzzyaaca4*xyzzyaact4+xyzzyaaip4+xyzzyaabc4*(-9&
&0.d0+180.d0*xyzzyaadb4))*xyzzyaabb4*xyzzyaajd4
end select
do xyzzyaaaj4=1,xyzzyaaae4
xyzzyaacj4(xyzzyaaaj4)=xyzzyaacj4(xyzzyaaaj4)+xyzzyaacf4(xyzzyaaaj4)
enddo
do xyzzyaaaj4=1,xyzzyaaae4
xyzzyaack4(xyzzyaaaj4)=xyzzyaack4(xyzzyaaaj4)+xyzzyaacg4(xyzzyaaaj4)
enddo
do xyzzyaaaj4=1,xyzzyaaaf4
xyzzyaacl4(xyzzyaaaj4)=xyzzyaacl4(xyzzyaaaj4)+xyzzyaach4(xyzzyaaaj4)
enddo
do xyzzyaaaj4=1,xyzzyaaag4
xyzzyaacm4(xyzzyaaaj4)=xyzzyaacm4(xyzzyaaaj4)+xyzzyaaci4(xyzzyaaaj4)
enddo
enddo
if(xyzzyaaju4)then
xyzzyaaat4=first_ao(xyzzyaaaq4)
call gmult(rbf(xyzzyaaat4,1),num_ao,num_real_k,xyzzyaacj4,phase,xyzzya&
&aae4)
call gmult(rblap(xyzzyaaat4,1),num_ao,num_real_k,xyzzyaack4,phase,xyzz&
&yaaae4)
call g3mult(rbgra1(xyzzyaaat4,1),rbgra2(xyzzyaaat4,1),rbgra3(xyzzyaaat&
&4,1),num_ao,num_real_k,xyzzyaacl4,phase,xyzzyaaae4)
call g6mult(rbsderiv1(xyzzyaaat4,1),rbsderiv2(xyzzyaaat4,1),rbsderiv3(&
&xyzzyaaat4,1),rbsderiv4(xyzzyaaat4,1),rbsderiv5(xyzzyaaat4,1),rbsderi&
&v6(xyzzyaaat4,1),num_ao,num_real_k,xyzzyaacm4,phase,xyzzyaaae4)
xyzzyaaau4=xyzzyaaat4+xyzzyaaae4-1
do xyzzyaaab4=num_real_k_plus_1,num_k
xyzzyaajt4=cphase(xyzzyaaab4)
cbf(xyzzyaaat4:xyzzyaaau4,xyzzyaaab4)=cbf(xyzzyaaat4:xyzzyaaau4,xyzzya&
&aab4)+xyzzyaacj4(1:xyzzyaaae4)*xyzzyaajt4
cblap(xyzzyaaat4:xyzzyaaau4,xyzzyaaab4)=cblap(xyzzyaaat4:xyzzyaaau4,xy&
&zzyaaab4)+cmplx(xyzzyaack4(1:xyzzyaaae4),0.d0,kind=dp)*xyzzyaajt4
cbgra1(xyzzyaaat4:xyzzyaaau4,xyzzyaaab4)=cbgra1(xyzzyaaat4:xyzzyaaau4,&
&xyzzyaaab4)+cmplx(xyzzyaacl4(1:xyzzyaaaf4:3),0.d0,kind=dp)*xyzzyaajt4
cbgra2(xyzzyaaat4:xyzzyaaau4,xyzzyaaab4)=cbgra2(xyzzyaaat4:xyzzyaaau4,&
&xyzzyaaab4)+cmplx(xyzzyaacl4(2:xyzzyaaaf4:3),0.d0,kind=dp)*xyzzyaajt4
cbgra3(xyzzyaaat4:xyzzyaaau4,xyzzyaaab4)=cbgra3(xyzzyaaat4:xyzzyaaau4,&
&xyzzyaaab4)+cmplx(xyzzyaacl4(3:xyzzyaaaf4:3),0.d0,kind=dp)*xyzzyaajt4
cbsderiv1(xyzzyaaat4:xyzzyaaau4,xyzzyaaab4)=cbsderiv1(xyzzyaaat4:xyzzy&
&aaau4,xyzzyaaab4)+cmplx(xyzzyaacm4(1:xyzzyaaag4:6),0.d0,kind=dp)*xyzz&
&yaajt4
cbsderiv2(xyzzyaaat4:xyzzyaaau4,xyzzyaaab4)=cbsderiv2(xyzzyaaat4:xyzzy&
&aaau4,xyzzyaaab4)+cmplx(xyzzyaacm4(2:xyzzyaaag4:6),0.d0,kind=dp)*xyzz&
&yaajt4
cbsderiv3(xyzzyaaat4:xyzzyaaau4,xyzzyaaab4)=cbsderiv3(xyzzyaaat4:xyzzy&
&aaau4,xyzzyaaab4)+cmplx(xyzzyaacm4(3:xyzzyaaag4:6),0.d0,kind=dp)*xyzz&
&yaajt4
cbsderiv4(xyzzyaaat4:xyzzyaaau4,xyzzyaaab4)=cbsderiv4(xyzzyaaat4:xyzzy&
&aaau4,xyzzyaaab4)+cmplx(xyzzyaacm4(4:xyzzyaaag4:6),0.d0,kind=dp)*xyzz&
&yaajt4
cbsderiv5(xyzzyaaat4:xyzzyaaau4,xyzzyaaab4)=cbsderiv5(xyzzyaaat4:xyzzy&
&aaau4,xyzzyaaab4)+cmplx(xyzzyaacm4(5:xyzzyaaag4:6),0.d0,kind=dp)*xyzz&
&yaajt4
cbsderiv6(xyzzyaaat4:xyzzyaaau4,xyzzyaaab4)=cbsderiv6(xyzzyaaat4:xyzzy&
&aaau4,xyzzyaaab4)+cmplx(xyzzyaacm4(6:xyzzyaaag4:6),0.d0,kind=dp)*xyzz&
&yaajt4
enddo
endif
enddo
enddo
enddo
xyzzyaaaw4=0
do xyzzyaaaq4=1,num_shells
if(.not.xyzzyaajv4(xyzzyaaaq4))cycle
xyzzyaaat4=first_ao(xyzzyaaaq4)-1
do xyzzyaaaj4=1,numao_in_shell(xyzzyaaaq4)
xyzzyaaaw4=xyzzyaaaw4+1
xyzzyaaax4(xyzzyaaaw4)=xyzzyaaat4+xyzzyaaaj4
enddo
enddo
if(use_gpcc)call cusp_wfdet_cmplx(rvec,jspin,.true.,.true.,cusp_val_c,&
&cusp_grad_c,cusp_lap_c,cusp_sderivs_c)
xyzzyaaah4=0
xyzzyaaai4=0
xyzzyaaal4=gauss_offset(jspin)
xyzzyaaam4=gauss_offsetc(jspin)
do xyzzyaaab4=1,num_real_k
xyzzyaaav4=nband(xyzzyaaab4,xyzzyaaaa1)
orb1(xyzzyaaah4+1:xyzzyaaah4+xyzzyaaav4)=multi_ddot_s(xyzzyaaav4,xyzzy&
&aaaw4,xyzzyaaax4,corbmask(xyzzyaaai4+xyzzyaaam4),rck(:,:,xyzzyaaab4,x&
&yzzyaaab1),maxb*num_ao,maxb,rbf(1,xyzzyaaab4),rnorm)
orb2(xyzzyaaah4+1:xyzzyaaah4+xyzzyaaav4)=multi_ddot_s(xyzzyaaav4,xyzzy&
&aaaw4,xyzzyaaax4,corbmask(xyzzyaaai4+xyzzyaaam4),rck(:,:,xyzzyaaab4,x&
&yzzyaaab1),maxb*num_ao,maxb,rblap(1,xyzzyaaab4),rnorm)
orb3(xyzzyaaah4+1:xyzzyaaah4+xyzzyaaav4)=multi_ddot_s(xyzzyaaav4,xyzzy&
&aaaw4,xyzzyaaax4,corbmask(xyzzyaaai4+xyzzyaaam4),rck(:,:,xyzzyaaab4,x&
&yzzyaaab1),maxb*num_ao,maxb,rbgra1(1,xyzzyaaab4),rnorm)
orb4(xyzzyaaah4+1:xyzzyaaah4+xyzzyaaav4)=multi_ddot_s(xyzzyaaav4,xyzzy&
&aaaw4,xyzzyaaax4,corbmask(xyzzyaaai4+xyzzyaaam4),rck(:,:,xyzzyaaab4,x&
&yzzyaaab1),maxb*num_ao,maxb,rbgra2(1,xyzzyaaab4),rnorm)
orb5(xyzzyaaah4+1:xyzzyaaah4+xyzzyaaav4)=multi_ddot_s(xyzzyaaav4,xyzzy&
&aaaw4,xyzzyaaax4,corbmask(xyzzyaaai4+xyzzyaaam4),rck(:,:,xyzzyaaab4,x&
&yzzyaaab1),maxb*num_ao,maxb,rbgra3(1,xyzzyaaab4),rnorm)
orb6(xyzzyaaah4+1:xyzzyaaah4+xyzzyaaav4)=multi_ddot_s(xyzzyaaav4,xyzzy&
&aaaw4,xyzzyaaax4,corbmask(xyzzyaaai4+xyzzyaaam4),rck(:,:,xyzzyaaab4,x&
&yzzyaaab1),maxb*num_ao,maxb,rbsderiv1(1,xyzzyaaab4),rnorm)
orb7(xyzzyaaah4+1:xyzzyaaah4+xyzzyaaav4)=multi_ddot_s(xyzzyaaav4,xyzzy&
&aaaw4,xyzzyaaax4,corbmask(xyzzyaaai4+xyzzyaaam4),rck(:,:,xyzzyaaab4,x&
&yzzyaaab1),maxb*num_ao,maxb,rbsderiv2(1,xyzzyaaab4),rnorm)
orb8(xyzzyaaah4+1:xyzzyaaah4+xyzzyaaav4)=multi_ddot_s(xyzzyaaav4,xyzzy&
&aaaw4,xyzzyaaax4,corbmask(xyzzyaaai4+xyzzyaaam4),rck(:,:,xyzzyaaab4,x&
&yzzyaaab1),maxb*num_ao,maxb,rbsderiv3(1,xyzzyaaab4),rnorm)
orb9(xyzzyaaah4+1:xyzzyaaah4+xyzzyaaav4)=multi_ddot_s(xyzzyaaav4,xyzzy&
&aaaw4,xyzzyaaax4,corbmask(xyzzyaaai4+xyzzyaaam4),rck(:,:,xyzzyaaab4,x&
&yzzyaaab1),maxb*num_ao,maxb,rbsderiv4(1,xyzzyaaab4),rnorm)
orb10(xyzzyaaah4+1:xyzzyaaah4+xyzzyaaav4)=multi_ddot_s(xyzzyaaav4,xyzz&
&yaaaw4,xyzzyaaax4,corbmask(xyzzyaaai4+xyzzyaaam4),rck(:,:,xyzzyaaab4,&
&xyzzyaaab1),maxb*num_ao,maxb,rbsderiv5(1,xyzzyaaab4),rnorm)
orb11(xyzzyaaah4+1:xyzzyaaah4+xyzzyaaav4)=multi_ddot_s(xyzzyaaav4,xyzz&
&yaaaw4,xyzzyaaax4,corbmask(xyzzyaaai4+xyzzyaaam4),rck(:,:,xyzzyaaab4,&
&xyzzyaaab1),maxb*num_ao,maxb,rbsderiv6(1,xyzzyaaab4),rnorm)
xyzzyaaah4=xyzzyaaah4+xyzzyaaav4
xyzzyaaai4=xyzzyaaai4+xyzzyaaav4
enddo
if(use_gpcc)then
do xyzzyaaaj4=1,xyzzyaaah4
if(.not.corbmask(xyzzyaaaj4+xyzzyaaam4-1))cycle
orb1(xyzzyaaaj4)=orb1(xyzzyaaaj4)+dble(cusp_val_c(xyzzyaaaj4+xyzzyaaam&
&4-1))
orb2(xyzzyaaaj4)=orb2(xyzzyaaaj4)+dble(cusp_lap_c(xyzzyaaaj4+xyzzyaaam&
&4-1))
orb3(xyzzyaaaj4)=orb3(xyzzyaaaj4)+dble(cusp_grad_c(1,xyzzyaaaj4+xyzzya&
&aam4-1))
orb4(xyzzyaaaj4)=orb4(xyzzyaaaj4)+dble(cusp_grad_c(2,xyzzyaaaj4+xyzzya&
&aam4-1))
orb5(xyzzyaaaj4)=orb5(xyzzyaaaj4)+dble(cusp_grad_c(3,xyzzyaaaj4+xyzzya&
&aam4-1))
orb6(xyzzyaaaj4)=orb6(xyzzyaaaj4)+dble(cusp_sderivs_c(1,xyzzyaaaj4+xyz&
&zyaaam4-1))
orb7(xyzzyaaaj4)=orb7(xyzzyaaaj4)+dble(cusp_sderivs_c(2,xyzzyaaaj4+xyz&
&zyaaam4-1))
orb8(xyzzyaaaj4)=orb8(xyzzyaaaj4)+dble(cusp_sderivs_c(3,xyzzyaaaj4+xyz&
&zyaaam4-1))
orb9(xyzzyaaaj4)=orb9(xyzzyaaaj4)+dble(cusp_sderivs_c(4,xyzzyaaaj4+xyz&
&zyaaam4-1))
orb10(xyzzyaaaj4)=orb10(xyzzyaaaj4)+dble(cusp_sderivs_c(5,xyzzyaaaj4+x&
&yzzyaaam4-1))
orb11(xyzzyaaaj4)=orb11(xyzzyaaaj4)+dble(cusp_sderivs_c(6,xyzzyaaaj4+x&
&yzzyaaam4-1))
enddo
endif
if(complex_states)then
do xyzzyaaab4=num_real_k_plus_1,num_k
xyzzyaaav4=nband(xyzzyaaab4,xyzzyaaaa1)
corb1(1:xyzzyaaav4)=multi_zdotu_s(xyzzyaaav4,xyzzyaaaw4,xyzzyaaax4,cor&
&bmask(xyzzyaaai4+xyzzyaaam4),cck(:,:,xyzzyaaab4,xyzzyaaab1),maxb*num_&
&ao,maxb,cbf(1,xyzzyaaab4),two_rnorm)
corb2(1:xyzzyaaav4)=multi_zdotu_s(xyzzyaaav4,xyzzyaaaw4,xyzzyaaax4,cor&
&bmask(xyzzyaaai4+xyzzyaaam4),cck(:,:,xyzzyaaab4,xyzzyaaab1),maxb*num_&
&ao,maxb,cblap(1,xyzzyaaab4),two_rnorm)
corb3(1:xyzzyaaav4)=multi_zdotu_s(xyzzyaaav4,xyzzyaaaw4,xyzzyaaax4,cor&
&bmask(xyzzyaaai4+xyzzyaaam4),cck(:,:,xyzzyaaab4,xyzzyaaab1),maxb*num_&
&ao,maxb,cbgra1(1,xyzzyaaab4),two_rnorm)
corb4(1:xyzzyaaav4)=multi_zdotu_s(xyzzyaaav4,xyzzyaaaw4,xyzzyaaax4,cor&
&bmask(xyzzyaaai4+xyzzyaaam4),cck(:,:,xyzzyaaab4,xyzzyaaab1),maxb*num_&
&ao,maxb,cbgra2(1,xyzzyaaab4),two_rnorm)
corb5(1:xyzzyaaav4)=multi_zdotu_s(xyzzyaaav4,xyzzyaaaw4,xyzzyaaax4,cor&
&bmask(xyzzyaaai4+xyzzyaaam4),cck(:,:,xyzzyaaab4,xyzzyaaab1),maxb*num_&
&ao,maxb,cbgra3(1,xyzzyaaab4),two_rnorm)
corb6(1:xyzzyaaav4)=multi_zdotu_s(xyzzyaaav4,xyzzyaaaw4,xyzzyaaax4,cor&
&bmask(xyzzyaaai4+xyzzyaaam4),cck(:,:,xyzzyaaab4,xyzzyaaab1),maxb*num_&
&ao,maxb,cbsderiv1(1,xyzzyaaab4),two_rnorm)
corb7(1:xyzzyaaav4)=multi_zdotu_s(xyzzyaaav4,xyzzyaaaw4,xyzzyaaax4,cor&
&bmask(xyzzyaaai4+xyzzyaaam4),cck(:,:,xyzzyaaab4,xyzzyaaab1),maxb*num_&
&ao,maxb,cbsderiv2(1,xyzzyaaab4),two_rnorm)
corb8(1:xyzzyaaav4)=multi_zdotu_s(xyzzyaaav4,xyzzyaaaw4,xyzzyaaax4,cor&
&bmask(xyzzyaaai4+xyzzyaaam4),cck(:,:,xyzzyaaab4,xyzzyaaab1),maxb*num_&
&ao,maxb,cbsderiv3(1,xyzzyaaab4),two_rnorm)
corb9(1:xyzzyaaav4)=multi_zdotu_s(xyzzyaaav4,xyzzyaaaw4,xyzzyaaax4,cor&
&bmask(xyzzyaaai4+xyzzyaaam4),cck(:,:,xyzzyaaab4,xyzzyaaab1),maxb*num_&
&ao,maxb,cbsderiv4(1,xyzzyaaab4),two_rnorm)
corb10(1:xyzzyaaav4)=multi_zdotu_s(xyzzyaaav4,xyzzyaaaw4,xyzzyaaax4,co&
&rbmask(xyzzyaaai4+xyzzyaaam4),cck(:,:,xyzzyaaab4,xyzzyaaab1),maxb*num&
&_ao,maxb,cbsderiv5(1,xyzzyaaab4),two_rnorm)
corb11(1:xyzzyaaav4)=multi_zdotu_s(xyzzyaaav4,xyzzyaaaw4,xyzzyaaax4,co&
&rbmask(xyzzyaaai4+xyzzyaaam4),cck(:,:,xyzzyaaab4,xyzzyaaab1),maxb*num&
&_ao,maxb,cbsderiv6(1,xyzzyaaab4),two_rnorm)
do xyzzyaaaj4=1,xyzzyaaav4
xyzzyaaah4=xyzzyaaah4+1
xyzzyaaai4=xyzzyaaai4+1
if(.not.corbmask(xyzzyaaai4+xyzzyaaam4-1))cycle
if(use_gpcc)then
corb1(xyzzyaaaj4)=corb1(xyzzyaaaj4)+cusp_val_c(xyzzyaaai4+xyzzyaaam4-1&
&)
corb2(xyzzyaaaj4)=corb2(xyzzyaaaj4)+cusp_lap_c(xyzzyaaai4+xyzzyaaam4-1&
&)
corb3(xyzzyaaaj4)=corb3(xyzzyaaaj4)+cusp_grad_c(1,xyzzyaaai4+xyzzyaaam&
&4-1)
corb4(xyzzyaaaj4)=corb4(xyzzyaaaj4)+cusp_grad_c(2,xyzzyaaai4+xyzzyaaam&
&4-1)
corb5(xyzzyaaaj4)=corb5(xyzzyaaaj4)+cusp_grad_c(3,xyzzyaaai4+xyzzyaaam&
&4-1)
corb6(xyzzyaaaj4)=corb6(xyzzyaaaj4)+cusp_sderivs_c(1,xyzzyaaai4+xyzzya&
&aam4-1)
corb7(xyzzyaaaj4)=corb7(xyzzyaaaj4)+cusp_sderivs_c(2,xyzzyaaai4+xyzzya&
&aam4-1)
corb8(xyzzyaaaj4)=corb8(xyzzyaaaj4)+cusp_sderivs_c(3,xyzzyaaai4+xyzzya&
&aam4-1)
corb9(xyzzyaaaj4)=corb9(xyzzyaaaj4)+cusp_sderivs_c(4,xyzzyaaai4+xyzzya&
&aam4-1)
corb10(xyzzyaaaj4)=corb10(xyzzyaaaj4)+cusp_sderivs_c(5,xyzzyaaai4+xyzz&
&yaaam4-1)
corb11(xyzzyaaaj4)=corb11(xyzzyaaaj4)+cusp_sderivs_c(6,xyzzyaaai4+xyzz&
&yaaam4-1)
endif
orb1(xyzzyaaah4)=dble(corb1(xyzzyaaaj4))
orb2(xyzzyaaah4)=dble(corb2(xyzzyaaaj4))
orb3(xyzzyaaah4)=dble(corb3(xyzzyaaaj4))
orb4(xyzzyaaah4)=dble(corb4(xyzzyaaaj4))
orb5(xyzzyaaah4)=dble(corb5(xyzzyaaaj4))
orb6(xyzzyaaah4)=dble(corb6(xyzzyaaaj4))
orb7(xyzzyaaah4)=dble(corb7(xyzzyaaaj4))
orb8(xyzzyaaah4)=dble(corb8(xyzzyaaaj4))
orb9(xyzzyaaah4)=dble(corb9(xyzzyaaaj4))
orb10(xyzzyaaah4)=dble(corb10(xyzzyaaaj4))
orb11(xyzzyaaah4)=dble(corb11(xyzzyaaaj4))
if(xyzzyaaah4+1<=nuc_nele(jspin))then
xyzzyaaah4=xyzzyaaah4+1
orb1(xyzzyaaah4)=aimag(corb1(xyzzyaaaj4))
orb2(xyzzyaaah4)=aimag(corb2(xyzzyaaaj4))
orb3(xyzzyaaah4)=aimag(corb3(xyzzyaaaj4))
orb4(xyzzyaaah4)=aimag(corb4(xyzzyaaaj4))
orb5(xyzzyaaah4)=aimag(corb5(xyzzyaaaj4))
orb6(xyzzyaaah4)=aimag(corb6(xyzzyaaaj4))
orb7(xyzzyaaah4)=aimag(corb7(xyzzyaaaj4))
orb8(xyzzyaaah4)=aimag(corb8(xyzzyaaaj4))
orb9(xyzzyaaah4)=aimag(corb9(xyzzyaaaj4))
orb10(xyzzyaaah4)=aimag(corb10(xyzzyaaaj4))
orb11(xyzzyaaah4)=aimag(corb11(xyzzyaaaj4))
endif
enddo
enddo
endif
call dcopy(xyzzyaaah4,orb1(1),1,orbval(xyzzyaaal4,1),1)
call dcopy(xyzzyaaah4,orb2(1),1,orblap(xyzzyaaal4,1),1)
call dcopy(xyzzyaaah4,orb3(1),1,orbgrad(1,xyzzyaaal4,1),3)
call dcopy(xyzzyaaah4,orb4(1),1,orbgrad(2,xyzzyaaal4,1),3)
call dcopy(xyzzyaaah4,orb5(1),1,orbgrad(3,xyzzyaaal4,1),3)
call dcopy(xyzzyaaah4,orb6(1),1,orbsderivs(1,xyzzyaaal4,1),6)
call dcopy(xyzzyaaah4,orb7(1),1,orbsderivs(2,xyzzyaaal4,1),6)
call dcopy(xyzzyaaah4,orb8(1),1,orbsderivs(3,xyzzyaaal4,1),6)
call dcopy(xyzzyaaah4,orb9(1),1,orbsderivs(4,xyzzyaaal4,1),6)
call dcopy(xyzzyaaah4,orb10(1),1,orbsderivs(5,xyzzyaaal4,1),6)
call dcopy(xyzzyaaah4,orb11(1),1,orbsderivs(6,xyzzyaaal4,1),6)
if(excite)then
do xyzzyaaaj4=1,gauss_ex_norb
if(.not.orbmask(gauss_gs_norb+xyzzyaaaj4))cycle
xyzzyaaab4=virtual_k(xyzzyaaaj4,jspin)
xyzzyaaav4=full2vrt(xyzzyaaaj4,jspin)
if(xyzzyaaab4<=num_real_k)then
psi(xyzzyaaaj4)=sum(rbf(:,xyzzyaaab4)*rck_ex(:,xyzzyaaav4,jspin))*rnor&
&m
flap(xyzzyaaaj4)=sum(rblap(:,xyzzyaaab4)*rck_ex(:,xyzzyaaav4,jspin))*r&
&norm
fgra1(xyzzyaaaj4)=sum(rbgra1(:,xyzzyaaab4)*rck_ex(:,xyzzyaaav4,jspin))&
&*rnorm
fgra2(xyzzyaaaj4)=sum(rbgra2(:,xyzzyaaab4)*rck_ex(:,xyzzyaaav4,jspin))&
&*rnorm
fgra3(xyzzyaaaj4)=sum(rbgra3(:,xyzzyaaab4)*rck_ex(:,xyzzyaaav4,jspin))&
&*rnorm
else
psi(xyzzyaaaj4)=sum(dble(cbf(:,xyzzyaaab4)*cck_ex(:,xyzzyaaav4,jspin))&
&)*two_rnorm
flap(xyzzyaaaj4)=sum(dble(cblap(:,xyzzyaaab4)*cck_ex(:,xyzzyaaav4,jspi&
&n)))*two_rnorm
fgra1(xyzzyaaaj4)=sum(dble(cbgra1(:,xyzzyaaab4)*cck_ex(:,xyzzyaaav4,js&
&pin)))*two_rnorm
fgra2(xyzzyaaaj4)=sum(dble(cbgra2(:,xyzzyaaab4)*cck_ex(:,xyzzyaaav4,js&
&pin)))*two_rnorm
fgra3(xyzzyaaaj4)=sum(dble(cbgra3(:,xyzzyaaab4)*cck_ex(:,xyzzyaaav4,js&
&pin)))*two_rnorm
endif
enddo
if(use_gpcc)then
do xyzzyaaaj4=1,gauss_ex_norb
xyzzyaaak4=gauss_gs_norb+xyzzyaaaj4
if(.not.orbmask(xyzzyaaak4))cycle
psi(xyzzyaaaj4)=psi(xyzzyaaaj4)+dble(cusp_val_c(ridx2zidx(xyzzyaaak4))&
&)
flap(xyzzyaaaj4)=flap(xyzzyaaaj4)+dble(cusp_lap_c(ridx2zidx(xyzzyaaak4&
&)))
fgra1(xyzzyaaaj4)=fgra1(xyzzyaaaj4)+dble(cusp_grad_c(1,ridx2zidx(xyzzy&
&aaak4)))
fgra2(xyzzyaaaj4)=fgra2(xyzzyaaaj4)+dble(cusp_grad_c(2,ridx2zidx(xyzzy&
&aaak4)))
fgra3(xyzzyaaaj4)=fgra3(xyzzyaaaj4)+dble(cusp_grad_c(3,ridx2zidx(xyzzy&
&aaak4)))
enddo
endif
do xyzzyaaaj4=1,gauss_ex_norb
xyzzyaaak4=gauss_gs_norb+xyzzyaaaj4
if(.not.orbmask(xyzzyaaak4))cycle
orbval(xyzzyaaak4,1)=psi(xyzzyaaaj4)
orblap(xyzzyaaak4,1)=flap(xyzzyaaaj4)
orbgrad(1,xyzzyaaak4,1)=fgra1(xyzzyaaaj4)
orbgrad(2,xyzzyaaak4,1)=fgra2(xyzzyaaaj4)
orbgrad(3,xyzzyaaak4,1)=fgra3(xyzzyaaaj4)
enddo
endif
end subroutine xyzzyaaad1
end module slaarnaax
